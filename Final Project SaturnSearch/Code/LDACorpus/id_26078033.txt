Gene regulation in biological systems behaves like a molecular computer whereby the gene’s output can be modelled as on-off states of Boolean (digital) logic [–]. However, programming gene regulation is far from trivial and requires considerable time and effort during functional testing and tuning of the synthetic genetic circuits under development. Apart from the scarcity of reliable and well-characterised biological parts, digital performance in biological systems is further impacted by the cellular and genetic context-dependent effects of the biological parts which comprise the circuit [–]. Recent studies have shown that genetic crosstalk between the engineered circuits and endogenous networks of the host cell can lead to cellular context-dependent effects [, ]. For this reason, molecular parts and devices that are orthogonal to the cell native machineries with roles in either genetic transcription or protein translation have been created to enable predictable engineering of genetic circuits [–]. Demonstrations of layered genetic circuits in a single cell, such as the execution of a 4-input AND gate in bacteria  and biological half adders and half subtractors in mammalian cells  have revealed that orthogonal logic gates can be interlinked to perform digital operations of higher complexity and diversified outputs. While the capability to program cells with memory and decision-making functions [–] presents many opportunities in biotechnological applications, a lack of formal understanding associated with genetic context-dependent effects has limited progress in engineering biology. In this respect, two studies have shown that the 5′ untranslated region (5′-UTR) of mRNA can affect the temporal control of multigene operons or inverter-based genetic circuits, and RNA processing using clustered regularly interspaced short palindromic repeats (CRISPRs) or ribozymes can serve as effective genetic insulators to buffer such context-dependent effects [, ]. In this paper, we have sought to elucidate the limitations of engineering biology from an architectural point of view, with the aim of creating a set of engineering solutions for overcoming failure modes during the development of complex, synthetic genetic circuits. Design of biological half adder In this study we were interested in developing biological half adders in prokaryotic systems — particularly in microbes which exhibit much faster cell division and shorter cycle time — so that they can be broadly applied in different biotechnological applications. In contrast to the mammalian cell-based half adder, which is developed mainly for therapeutic and biosensing applications, a prokaryotic half adder can be used to enhance molecular process control and decision making, for example, in drug and biofuel production, biosensing, bioremediation  and probiotic engineering for the treatment of metabolic disorders , cancer  and infectious diseases [, ]. In digital processing, half adders form the key building blocks for shift registers, binary counters and serial parallel data converters. Likewise in biological systems, a combination of half adders can be connected in various arrangements to regulate gene expression with diverse, digital-like performance. In doing so, biological systems can be made to interface with novel biomolecular devices, allowing the repurposing of cellular phenotype, as well as providing new platforms to probe and elucidate biological functions [–]. Simplified schematics of the biological half adder, comprising independent modules of the AND, OR and NOT gates layered in series and in parallel.  Logic output of biological half adder.  In the presence of two inputs, the AND gate is activated to produce GFP and lambda repressors, which further inactivates the OR gate to suppress RFP expression.  In the presence of either inputs singly, only the OR gate is activated to trigger RFP expression was chosen as the designated chassis as it represents a model organism that can be easily manipulated; its inherent cellular processes are also well characterised. Figure  shows the design of our biological half adder in a single prokaryotic cell. The half adder consists of three independent biologically derived AND, OR and NOT logic gates and a fourth AND logic function that is not a physical device, but a result of programmable decision making as a result of interconnecting logic functions (Fig. ). The σ-dependent HrpRS regulation motif of the  T3SS secretion system was refactored for the design of the AND gate, as demonstrated in an earlier study . The advantage is that the HrpRS AND gate offers a dual layer of orthogonal control in the  host. This means that (a) the majority of transcription events in  will occur via σ-dependent transcription, and (b) HrpRS transcription factors are absent in wild type . Transcription occurs when enhancer-binding proteins HrpS and HrpR, which are regulated by arabinose (input A) and rhamnose (input B) induction, respectively, are coexpressed and bound to the upstream activator sites of the pHrpL promoter. This binding event then triggers an ATPase-dependent conformational change within the promoter through a molecular interplay with the σ-RNAP holoenyzme, thereby allowing RNA synthesis and elongation after the transcription start site. The OR gate generates mRNA transcript of the RFP gene upon induction with either arabinose or rhamnose. The NOT gate in the half adder design is a hybrid promoter consisting of λCl repressor binding sites downstream of the transcriptional start site (TSS) of the OR logic gate. Unlike traditional NOT gates, which are designed to have transcriptional repressors competing for consensus RNAP binding sites, our NOT gate design functions as an orthogonal, molecular blocker to the RNA elongation process. On induction with arabinose and rhamnose, the transcription factors AraC and RhaS, both of which are constitutively expressed in a single transcript by promoter pCON, associate with their corresponding inducers to activate expression of the enhancer-binding proteins HrpS and HrpR. This results in the activation of the AND logic and the concurrent synthesis of GFP reporter and lambda repressor (λCl) by the pHrpL promoter. Consequently, genetic events of the OR gate, which run in parallel with the HrpRS AND gate, are then turned off due to obstructive repression by λCl molecules. In all, the half adder demonstrates both AND (SUM Output) and XOR (CARRY Output) logic operations; the latter operation is a processed outcome achieved by sequential and parallel layering of AND, OR and NOT logic (Fig. ). By comparison, induction with either inducer singly will trigger only genetic operation of the OR gate, resulting in the synthesis of RFP reporter, but not GFP and λCl molecules (Fig. ). Finally, we also demonstrate the development of a single cell prokaryotic, half subtractor via slight modifications to the half adder circuit. Characterisation of input devices The choice of input signals presents the first possible complication in terms of parts modularity. For this reason, genetic circuits of higher complexity with multiple inputs often utilise promoter systems which are activated by inducers of vastly dissimilar chemical nature, namely IPTG, tetracycline, arabinose, 3OC12HSL and C4HSL. Previous studies have shown that a subset of quorum sensing promoters can be activated by homoserine lactone inducers of similar carbon chain length [, ]. Likewise, the wild-type pBAD promoter is affected by lactose analogues, requiring further mutagenesis to avoid crosstalk inhibition . Instances of cross-phosphorylation have also been observed in two component signal transduction systems between otherwise distinct pathways . Thus, it is important for inducible input devices to be carefully characterised for their steady state transfer function and pairing compatibility before further assembly into higher ordered logic devices. While previous studies with pRHAB promoter involved genetic circuits that include both RhaR and RhaS transcription factors [–], in this paper we demonstrate that the rhamnose inducible promoter pRHAB requires only RhaS for full activation and displays tight regulation even when RhaS is overexpressed. Additional file : Figures S2C and S3C show the steady state transfer functions of input device A, pBAD (Additional file : Figure S2A) and input device B, pRHAB (Additional file : Figure S3A) expressing RFP under strong ribosome binding sites (RBSs) by their corresponding inducers, respectively. To examine the possibility of genetic cross-communication, we constructed genetic circuits that couple GFP production to pBAD activation and RFP production to pRHAB activation. The results show that varying the concentration of arabinose did not activate pRHAB promoter activity (Additional file : Figure S4A). A similar trend was observed in pBAD promoter with rhamnose (Additional file : Figure S4B). Interestingly, the simultaneous introduction of both sugars modified the transfer function of each promoter slightly, which may be a result of differential cell growth, sugar import rate or antagonistic effect of one sugar to another. This effect, however, is insignificant as definite ON and OFF switch behaviours are apparent — thereby confirming the pairing compatibility of pBAD and pRHAB promoters. Design and characterisation of AND logic gate Designs of highly modularised, prokaryotic AND logic devices have hitherto involved the use of multiple plasmids [, , , , ]. In this work, we assembled the AND logic gate in a single plasmid. This procedure has enabled us to localise the AND logic gate in a single vector, and facilitated the downstream troubleshooting and tuning of layered genetic circuits. Design and characterisation of the biological AND gate.  Design and logic output of Hrp-based AND gate. The AND gate comprises HrpS and HrpR transcription factors that are unregulated under the control of pBAD and pRHAB promoters, respectively. In the presence of both inputs HrpRS jointly bind and induce conformational change in the pHrpL promoter, thereby enabling DNA transcription and the expression of GFP reporter.  Steady state profile of the AND gate for various concentrations of arabinose (input A) and rhamnose (input B).  Digital performance of AND gate at steady state.  Characterisation of the Hrp-based AND gate in both high and low copy plasmids. The input devices generating HrpRS transcription factors and pHrL-GFP reporter module are placed in plasmids of different copy numbers to study the effect of plasmid copy on precision control and tuning of Hrp-based AND gate. Error bars represent the standard deviation of three independent experiments To develop the AND logic component of the half adder, we systematically designed and assembled refactored modules of the HrpRS transcription machinery into a low copy plasmid (Additional file : Figure S2A). The module which expressed GFP from the pHrpL promoter was assembled upstream of the pBAD-HrpS and pRHAB-HrpR modules to attenuate genetic context-dependent effects that might arise from transcriptional overrun of the stronger pBAD and pRHAB input expression modules as a result of inefficient transcription termination. While designing the GFP producing module in a bidirectional permutation is usually a better solution, this option was not tested in our study, as the downstream pBAD promoter is a weak constitutive promoter in the reverse complement direction. Thus, placing the pHrpL-GFP module before pBAD in either the reverse or reverse complement arrangement may result in antisense-GFP interference or the occurrence of a leaky AND gate. The steady state profile of the functional AND gate was characterised by titrating with a varying concentration of arabinose (input A) and rhamnose (input B) as shown in Fig. . Results of the engineered AND gate correlated well with our steady state computational model (Additional file : Figure S11), which was applied to match biological modules making up the AND gate. Likewise, the ‘on’ and ‘off’ digital performance of the AND gate at steady state was qualitatively and quantitatively assessed by introducing inputs well above switch points under four different logic conditions (Fig. ). The results show that the AND gate was only activated in the presence of both inputs with >800au (relative fluorescence unit) expression increase, as compared to the condition where only a single input is present (or no inputs). To assess the effect of plasmid copy number on the performance of the AND gate, modules were constructed which generate the HrpRS transcription activators (pBAD-HrpS-pRHAB-HrpR). This produces a GFP output (pHrpL-GFP) into separate low and high copy plasmids (co-transforming the plasmids into  cells).The relative GFP output of each system was measured (Fig. ). The results show that the AND gate system with the GFP-producing module in the high copy plasmid and the HrpRS transcription activators in the low copy plasmid produced a >4-fold greater GFP output than AND gate systems with GFP-producing module in low copy plasmid and HrpRS (as compared to transcription activators in either low or high copy plasmids). The result indicates that a higher concentration of HrpRS transcription activators, above the saturation limit of the pHrpL promoter, do not produce a greater GFP output. It is likely that the transcriptional output of the HrpRS AND gate is limited by the strength of the weak pHrpL promoter. Hence, the conclusion is that when pHrpL-GFP module was expressed in high copy plasmids, the intracellular availability of pHrpL promoters was increased — resulting in the amplification of GFP output. Design and characterisation of OR logic gate Design and characterisation of biological OR gates.  The genetic blueprint and logic output of three OR gate designs. Designs I and II are tandem promoters in opposite arrangement, while design III expresses RFP reporter in two distinct transcripts. Only design I and III are functional OR gates that generate RFP in the presence of either inputs.  Steady state profile of OR gate I for various concentrations of arabinose (input A) and rhamnose (input B).  Digital performance of OR gates at steady state. Error bars represent the standard deviation of three independent experiments Genetic OR gates can be achieved by designing tandem promoter genetic circuits or by expressing target genes in two discrete expression cassettes. Nonetheless, tandem promoter OR gate circuits may fail when repression of the downstream promoter prevents the proper functioning of the upstream promoter . To develop the OR logic gate of the half adder, three prototype designs were constructed; two designs comprised pBAD and pRHAB promoters in different tandem arrangements upstream of an RFP reporter gene with strong RBS, and a third design produced RFP in two distinct expression cassettes (Fig. ). The three OR gate designs were then introduced with input A and B above their switch points and assessed for the respective RFP outputs (Fig. ). The results show that designs I and III are functional OR gates with >2,500 au higher RFP expression when either or both inputs are present. In our computational model, the total amount of RFP expression was approximated by the sum of RFP amounts produced from individual pBAD and pRHAB promoters. Although the model predicts well from low to medium range induction levels, our assumption was not valid at very high induction levels, in which lesser RFP expression was observed than predicted. It is possible that at very high induction levels, the transcription and translation machinery in cells are fully saturated, thereby imposing metabolic burden on the cells and limiting protein production . The OR gate design II, which was composed of the pRHAB promoter upstream of the pBAD promoter and RFP reporter, was activated only in the presence of rhamnose, but not arabinose. Our results agree with the previous finding that no expression was detected when the pBAD promoter was fused downstream of the tetracycline-inducible pTET promoter and upstream of a YFP reporter . We conclude that this observation is likely an effect of the AraC transcription factor, which can function as both repressor and activator. In the absence of arabinose, AraC, when overexpressed, remains bound to operator sites that induce DNA looping of the pBAD promoter, thereby obstructing the elongation of mRNA by initiated RNA polymerase. As will be shown in the next section, in order to layer OR gate design I into other logic devices, the construct was characterised for its steady state profile by titrating with varying concentrations of arabinose and rhamnose (Fig. ). Results of the engineered OR gate generally correlated well with our steady state computational model (Additional file : Figure S12), which was applied to match biological modules making up the OR gate. Genetic context effect of σ54-dependent pHrpL promoter To enable sufficient expression of the λCl repressor by an AND gate system, the gene encoding for λCl repressor was assembled downstream of a σ54-dependent pHrpL promoter on a high copy plasmid. Fortuitously, we discovered that a pHrpL promoter located downstream of another pHrpL expression cassette can be turned on even in the absence of its cognate HrpRS transcription factors (Additional file : Figure S5C). The converse is not true for an upstream pHrpL promoter (Additional file : Figure S5B). Negative controls with just the GFP reporter or RBS-λCl gene upstream of the pHrpL-GFP module confirmed that the pHrpL promoter alone is not leaky and that a cryptic promoter is absent in the λCl gene (Additional file : Figure S5A and S5D). To buffer against this genetic context-dependent effect of the pHrpL promoters, pHrpL-GFP and pHrpL-λCl modules were assembled on separate plasmids. This successfully prevented the genetic interference of both pHrpL expression modules with each other (Additional file : Figure S5E and S5F). Additional file : Figure S5G shows a quantitative assessment of pHrpL promoter activation due to the presence of another upstream pHrpL promoter and the use of plasmids as genetic insulators. Design and characterisation of NOT and NIMPLY logic gates As part of the development of XOR logic operations of the half adder, repressor binding sites are required downstream of the OR gate promoters. To examine the minimal number of λCl repressor binding sites required for effective repression, a single λCl operator site and dual λCl operator sites of perfect dyad symmetry were fused downstream of the pBAD promoter, before the RFP gene . The repressibility of both circuits was tested by generating λCl repressors from an HrpRS AND gate in a separate plasmid. Negligible repression was observed when only one λCl repressor operator site was present. In the presence of two operator sites of perfect dyad symmetry, RFP expression from the pBAD promoter was greatly attenuated — even when the λCl repressor was not synthesised. We postulate that the observed reduction of RFP expression might be caused by the presence of secondary hairpin structures immediately downstream of the TSS acting as  transcription terminators or locking the RBS in conformations that prevented translation initiation (Additional file : Figure S6A). In order to examine this further, random mutagenesis on the natural sequence of the λCl repressor operator sites was performed with screening for mutants with significant difference in RFP expression levels, in the absence and presence of the λCl repressor. Accordingly, an evolved candidate (Cl2B) with 4 mutations in the inverted sequence of the λCl repressor binding (Additional file : Figure S6B) was obtained. Sequence comparison with the original λCl repressor binding sites (Cl2A) with the evolved candidate revealed that the directed evolution process had eliminated the effect of secondary hairpin structures from 7 to 3. Next, the efficiency of λCl-mediated transcription termination in the context of a genetic NIMPLY gate was studied. This was achieved by placing repressor binding sites directly downstream of tandem pBAD-pRHAB promoters and generating λCl repressors from a separate pBAD expression cassette. Design and characterisation of the biological NIMPLY gate.  Genetic blueprint and logic output of NIMPLY gate. The NIMPLY gate is designed by incorporating synthetic lambda repressor binding sites downstream of OR gate promoters and regulating the expression of lambda repressors through the pBAD promoter. RFP is expressed only in the presence of input B, rhamnose.  Characterisation of NIMPLY gate with different ribosome binding sites. At steady state NIMPLY gate which utilizes a weaker ribosome binding site (RbsB) directly upstream of the RFP reporter (denoted by crosses, stars and circles) exhibits better control and reduced expression leak, as compared to the NIMPLY gate design that contains a stronger ribosome binding site (denoted by diamonds, squares, and triangles). Expression leakiness in circuits with strong and weak ribosome binding sites after 4 hours are denoted by green and orange arrowheads, respectively. Constructs that were singly induced with input B, induced with both inputs A and B, and uninduced are represented by R, A + R and NC as shown.  Characterisation of NIMPLY gates with two (blue circles) and four (orange squares) lambda repressor binding sites. The black line represents empirically derived transfer function for the construct with dual lambda repressor binding sites, as described by the equation provided. Constructs were induced with a fixed amount of rhamnose (input B) and titrated with various concentrations of arabinose (input A). An increased number of repressor binding sites disrupted the NIMPLY gate, possibly due to pronounced effect of 5′ mRNA secondary structures. Error bars represent standard deviation of three independent experiments Two NIMPLY logic circuits were developed which generated RFP transcripts with strong and weak RBSs. Both NIMPLY logic circuits were then tested in the presence and absence of input A (arabinose) over time with input B (rhamnose), both above the switch point (Fig. ). Temporal analysis of the NIMPLY logic circuits showed that there was no significant delay in layering a NOT gate downstream of an OR gate (Fig. ). However, an apparent delay in the total amount of mature RFP was observed when a weaker RBS was used. The results also showed that while NIMPLY logic can be achieved from both circuits, the system with the strong RBS exhibited a higher order of expression and leakiness compared to that which translated RFP from the weaker RBS. This leads to the conclusion that the choice of a particular RBS can be used as a signal moderation technique in order to achieve a balance between precision tuning and output gain in layered logic gates. In an attempt to alleviate expression leakiness from the NIMPLY gate with the strong RBS, an additional pair of λCl repressor binding sites with imperfect dyad symmetry were introduced downstream of pBAD-pRHAB-Cl2B, and before the RBS-RFP module. However, the presence of 4 λCl binding sites completely inhibited RFP expression, resulting in the failure of the NIMPLY gate (Fig. ). It is likely that this failure could be an effect of pronounced 5′ UTR secondary structures formed due to the repeated use of identical λCl repressor binding sites. Design and characterisation of XOR logic gate Design and characterisation of biological XOR gates.  The logic output of XOR gate.  Genetic blueprint of four biological XOR gate designs. The XOR gate comprises serially layered AND, NOT and OR gates. HrpRS transcription factors are carried in a low copy plasmid, while pHrpL-λCl and distinct modules of OR gates with lambda repressor binding sites expressing RFP reporter are carried in high copy plasmids. Design I comprises tandem promoters with repressor binding sites downstream of pRHAB promoter and an RFP reporter engineered with the ASV protein degradation tag. Designs II and III comprise tandem promoters with repressor binding sites downstream of each promoter and RFP with and without the ASV degradation tag, respectively. Design IV is modified from design II with RFP expressed in two disparate transcripts.  Digital performance of various designs of biological XOR gates at steady state.  The steady state profile of XOR gate IV for various concentrations of arabinose (input A) and rhamnose (input B). Error bars represent the standard deviation of four independent experiments In order to develop the XOR component of the half adder, we assimilated and tested a combination of AND, OR and NOT logic gates in four different genetic circuits. In all the designs HrpRS transcription activators were expressed from low copy plasmids to drive the synthesis of λCl repressors from the pHrpL promoter in high copy plasmids (Fig. ). OR and NOT biological modules were assembled in the same high copy plasmid downstream of the pHrpL-λCl module. In design I, an OR gate comprising a tandem arrangement of pBAD, pRHAB and λCl repressor binding sites was used to express -tagged, short-lived RFP (RFP) — one of the most well-characterised protein degradation systems in  . In design II we created hybrid promoters of pBAD and pRHAB by incorporating λCl binding sites downstream of both promoters before connecting them in tandem to elicit hypothetical OR logic similar to design I. Design III was modified from design II to express long-lived RFP. To overcome possible complications from 5′UTR secondary structures — due to the presence of multiple λCl binding sites within the same mRNA transcript — design IV, which comprised synthetic hybrid promoters of pBAD-Cl2B and pRHAB-Cl2B expressing RFP in two discrete expression cassettes, was also developed. Accordingly, only design IV was able to achieve well-balanced outputs which accurately described XOR logic operations (Fig. ). While design I demonstrated the strong suppression of RFP output in the presence of both inputs (arabinose and rhamnose), when characterised as a NIMPLY gate (as described earlier), the same design failed to function in the context of a XOR gate in which a weaker pHrpL promoter was used to drive the synthesis λCl repressors instead of the strong pBAD promoter. Interestingly, the results imply that when employing transcription repressors as molecular blockers to mRNA elongation, a higher concentration of λCl molecules is needed to completely suppress transcription as λCl binding sites are engineered further away from the transcription start site. This observation may be an effect of RNAP gaining momentum as it runs down template DNA to perform transcription, inadvertently enabling RNAP to continue its course of action as a result of the inadequacy of ‘molecular brakes’. While designs II and III, which were developed with λCl binding sites downstream of both pBAD and pRHAB promoters, exhibited a slight semblance of XOR logic operations, the presence of multiple, repeated sequences of λCl binding sites in the transcript generated from the pBAD promoter greatly reduced the RFP output from input A. Using untagged RFP gene in design III led to a slight increase in overall RFP output but did not alleviate the signal balancing issue. The result implies that the 5′UTR structural effect is more dominant than RFP half-life in determining the success of the layered XOR gate. In order to apply the XOR gate in the implementation of the half adder, design IV was characterised for its steady state profile by titrating with varying concentrations of arabinose and rhamnose as shown in Fig. . It is noteworthy that the XOR gate developed in this work possesses higher single cell computational capability compared to that achieved by Tamsir and colleagues using a network of inter-communicating cells , hence circumventing problems associated with cell-cell communication. Design and characterisation of single cell half adder and half subtractor Design and characterisation of the biological half adder.  Genetic blueprint of the half adder.  Digital performance of the half adder at steady state.  Flow cytometry analysis of the half adder. The Y axis coordinate represents population count, while FITC-A and PE-CF594-A represent channels that detect GFP and RFP fluorescence, respectively. Population shifts to the right represent ON behaviour. Error bars represent the standard deviation of four independent experiments The half adder computes dual inputs with both AND and XOR logic operations to generate CARRY and SUM outputs, respectively. Building on bio-logical devices that were modularised and rigorously characterised earlier, we co-transformed constructs which produce GFP (CARRY) from an HrpRS AND gate in a low copy plasmid, RFP (SUM) from hybrid promoters pBAD-Cl2B and pRHAB-Cl2B and λCl repressors from a pHrpL promoter in a high copy plasmid into  (Fig. ). To study the digital performance of the single cell half adder, we characterised the system at both the population and single cell levels by microplate fluorescent assay (Fig. ) and flow cytometry (Fig. , Additional file : Figure S7) for four different logic conditions. The results show that the engineered cells exhibited robust and digital-like performance with minor expression leak (<20 %) in XOR output when both inputs were present. While previous characterisation with standalone XOR gates displayed near perfect XOR outputs, parallel implementation of both AND and XOR logic gates in a half adder led to probable competition for HrpRS transcription activators by pHrpL promoters in both low and high copy plasmids, which is suggestive of expression shunting in competitive transcription dynamics . In other words, the availability of HrpRS activators is divided between the pHrpL-GFP module in low copy plasmids and pHrpL-λCl module in high copy plasmids, thus causing both AND and XOR gates to perform below par compared to when they are operating individually. To affirm the hypothesis, we examined the AND output of a standalone AND gate with the AND output of the half adder using microplate fluorescent assay. The results showed that the GFP output of the isolated AND gate was approximately 7 times stronger than that of the half adder’s AND gate, thus confirming our hypothesis (Additional file : Figure S8). It is noteworthy that the reduced expression of GFP did not affect the overall performance of the half adder, as effective half adder logic operations were still achieved. In the current single cell half adder, the engineered cells exhibited relatively healthy growth with the same order of viable cells (about 10 cfu/ml) in both induced and uninduced cell cultures (Additional file : Figure S9). Nevertheless, as genetic complexity and heterologous expression increased, a concomitant increase in the metabolic burden in the  cell was also observed. Design and characterisation of the biological half subtractor.  Genetic blueprint of the half subtractor.  Digital performance of half subtractor at steady state.  Flow cytometry analysis of the half adder. Y axis coordinate represents population count, while FITC-A and PE-CF594-A represent channels that detect GFP and RFP fluorescence, respectively. Population shifts to the right represent ON behaviour. Error bars represent the standard deviation of four independent experiments To demonstrate the modularity of our approach, we also developed a single cell half subtractor by performing slight modifications to the genetic circuits that formed the basis of the half adder. Specifically, GFP, which exemplifies BORROW output, was produced from the hybrid promoter pBAD-Cl2B in the low copy plasmid instead of the pHrpL promoter (Fig. ). As above, the construct which generated the BORROW output (GFP) and that which generated the DIFFERENCE output (RFP) were co-transformed into  cells. Characterisation was undertaken at both the population and single cell levels by microplate fluorescent assay (Fig. ) and flow cytometry (Fig. ) under four different logic conditions. The results showed that the engineered cells functioned as effective biological half subtractors, producing GFP only in the presence of input A and RFP in the presence of input A or B, but not when both inputs were present. Failure modes and engineering solutions for the design and building of layered genetic circuits in a single (bacterial) cell Genetic crosstalk: Input switch devices crosstalk with one another. ▪ Check pairwise compatibility by placing GFP and RFP under the regulation of each input switch device ▪ Perform mutagenesis on promoter or DNA-binding protein to identify orthogonal pairs. Stoichiometric mismatch: Amount of AND gate’s transcription activators are disproportionately matched, resulting in ‘leaky’ AND gate. ▪ Characterise the expression profile of input genetic switches with different RBSs and input the resultant transfer function equations into a steady state AND gate computational model. Match AND gate sub-modules to obtain stoichiometric balance using this forward engineering approach. DNA supercoiling: σ54 AND gate promoter is turned on by the DNA supercoil effects of upstream σ54 promoter. ▪ Insulate σ54 promoters using different plasmid vectors. Stoichiometric mismatch: Outputs from input device I and II are disproportionately matched, resulting in skewed OR gate. ▪ Characterise the expression profile of input genetic switches with different RBSs and input the resultant transfer function equations into a steady state OR gate computational model. Match OR gate sub-modules to obtain stoichiometric balance using this forward engineering approach. Transcription interference: Tandem promoter OR gate design fails due to downstream DNA sequence acting as a repressor to upstream promoter. ▪ Characterise different permutation of tandem promoter OR gate to identify the optimal genetic architecture. ▪ Separate OR gate promoters into distinct expression cassettes. Layering OR-NOT into NIMPLY gate Insufficient repression: Placing single repressor binding site downstream of inducible promoter cannot fully repress gene expression. ▪ Increase repression efficiency by introducing additional repressor binding sites to the NOT gate. Note that the introduction of extra repressor binding sites may also lead to extensive 5′UTR effects. ▪ Attenuate expression ‘leakiness’ by using weaker RBS for the NOT gate Translation interference: Placing repressor binding sites downstream of inducible promoter creates extensive 5′UTR structural effects. ▪ Perform mutagenesis to relieve RNA hairpin structures at selected sites. ▪ Use RNA processing tools to remove undesired 5′UTR sequences. Layering AND-OR-NOT into XOR gate Insufficient repression: Insufficient transcription repressors are generated by upstream genetic circuit to stop transcription elongation, level mismatch. ▪ Reduce repressors required in NOT gate by designing repressor binding sites such that they are immediately downstream of transcription start site. ▪ Increase production of repressor in the AND gate by expressing transcription repressors in high copy plasmid. Translation interference: Placing repressor binding sites downstream of OR gate tandem promoter creates extensive 5′UTR structural effects. ▪ Separate OR gate promoters into distinct expression cassettes. ▪ Use RNA processing tools to remove undesired 5′UTR sequences. Logic gates are the basis of all electronic digital devices, from mobile phones to microprocessors to computers. They are therefore the basis of the processing of information and control systems. Similarly, the development of biologically based logic gates and logical devices has major potential in terms of information processing and control. The design and testing of a half adder, which is the subject of this paper, is seen as a significant step in the development of biological logical devices, comprising multiple gates that work stably and in unison. Immediate areas of application are in advanced biosensors. In the longer term, there is the potential to develop biologically based devices for information processing and control, for example, in the application of human-imposed intra-cellular control. The underlying strategy of the paper includes applying systematic design through the application of engineering principles . Using a forward engineering approach that is supported by modelling and rigorous characterisation, independent modules that enable programmable digital operations in prokaryotic cells, including simple genetic switches, and AND, OR and NOT logic operations were systematically assembled and characterised. AND, OR and NOT logic gates were then layered in both parallel and serial arrangements to generate a repertoire of cellular Boolean operations that include NIMPLY, XOR, half adder and half subtractor logic operations. Using a bottom-up approach for constructing biological systems of increasing complexity, we assessed genetic architectures that led to genetic context-dependent effects. On this basis, the significance of each design on the overall digital performance of programmable logic gates in engineered cells was studied, leading to the compilation of a comprehensive set of guidelines for troubleshooting synthetic genetic circuits (Table ). This work together with recent studies conducted elsewhere highlight the importance of modularity and characterisation during the systematic layering of multiple biological devices [, , ]. Overall, the presence of secondary structures in the 5′-UTR of mRNA affects genetic expression most. We discovered that the presence of seven consecutive hairpins immediately downstream of the promoter transcription start site would severely impede gene expression. Although an OR gate design made up of tandem promoters can be subjected to the undesirable effects of the 5′-UTR secondary structure, we showed that the effect is not pronounced in the digital performance of the OR logic when the promoters and DNA operator sites involved are of markedly different DNA sequences. The OR gate design that comprises a separate gene expression cassette also reliably demonstrates digital operation. However, the involvement of larger DNA modules and repetitive use of transcription terminators that are rich in secondary hairpin structures may impede system assembly in terms of construction efficiency and accuracy. Where identical DNA sequences are incorporated in a single mRNA transcript, as shown in designs II and III of the XOR gate, the effect of 5′-UTR secondary structure preventing gene expression is significantly more pronounced. Thus, it is proposed that XOR gate logic in layered genetic circuits should be designed with two discrete expression cassettes instead of employing a tandem promoter circuit design. It would also be interesting to test if RNA processing tools can be employed in multiplex mode to insulate the myriad of biological devices from RNA genetic context-dependent effects in layered genetic circuits concurrently. Perhaps of particular interest, we discovered that σ54 promoters can exhibit genetic context-dependent effects if two σ54 promoters are placed close to each other. Previously, σ54-dependent NtrC-binding promoters have been reported. These promoters permit transcription in vitro in the absence of enhancer-binding proteins and ATP under conditions that promote DNA melting. These include DNA supercoiling, temperature rise and lower ionic strength, or the implemention of characteristic point mutations on the σ54 protein [, ]. In this paper, we show that an upstream σ54 pHrpL promoter could also activate a downstream pHrpL promoter in vivo if the two promoters are in close proximity — possibly as a result of plasmid DNA supercoiling. This undesired switched-on activity can be avoided by designing pHrpL expression modules in different plasmids, that is, using plasmids as genetic buffers to insulate such genetic context-dependent effects. While recombinases have been intelligently crafted into Boolean logic gates with DNA-encoded memory functions, it is important to note that biosensors connected in AND, OR and XOR operations with recombinase-based logic gates may not be able to distinguish inputs from different environments and provide the desired response. For example, a probiotic that is genetically programmed in AND logic to sense two inputs such as hypoxia and low pH may be activated for hypoxia and low pH signals in two different locations, as compared to sensing both signals in situ. The same may be applicable for other logic operations with recombinase-based logic gates. Thus, layered genetic circuits that are capable of sensing and providing location-sensitive Boolean logic operations are still useful in programming cellular behaviour. Of particular interest is a combination of layered genetic circuits with the synthesis of recombinases as an intermediary output. This may provide a novel and better platform for programmable cellular behaviour in terms of both accuracy and memory. With a few notable exceptions [, , ], most studies of synthetic biological systems are centred on the development of rational engineering approaches, reporting successful and advantageous aspects of the engineered systems, with a lesser focus on reporting failure modes and compiling the engineering solutions applied to troubleshoot system failures. As synthetic biology moves forward with greater focus on scaling the complexity of engineered genetic circuits, studies which thoroughly evaluate failure modes and engineering solutions will serve as important references for future design and development of synthetic biological systems. Strains, plasmids and growth conditions strain Top10 (Invitrogen) was used for all the cloning and characterisation experiments. The genes and oligonucleotides used in this study were synthesised by either Geneart (Life Technologies, Grand Island, NY) or Sigma Aldrich (St. Louis, MO). All the enzymes used in this study, including OneTaq and Phusion polymerase, T4 ligase, EcoRI, XbaI, SpeI, PstI and DpnI, were obtained from New England Biolabs. Chloramphenicol (35 μg ml) and ampicillin (100 μg ml) were added to culture media for experiments involving pSB1C3 and pSB4A5 plasmid vectors, where appropriate. In all the characterisation experiments, cells were inoculated from freshly transformed plates and grown in 2 ml LB (Miller, BD Bioscience, San Jose, CA) with appropriate antibiotic in 50-ml Falcon tubes overnight at 37 °C with 225 rpm shaking unless otherwise stated. Overnight cultures were then diluted to OD about 0.002 in 5 ml LB antibiotic and further grown to a final OD of 0.5 ± 0.05 under the same culture conditions (37 °C and 225 rpm shaking). Harvested cells were kept on ice until induction. All inducers used in this study were purchased from Sigma Aldrich with final concentration ranging from 0 to 28 mM. All genes from  (, ,  and ) were cloned from genomic DNA of strain MG1655 (ATCC 700926). ,  and  were cloned from an earlier study , while  (Bba_J23101), double terminator (Bba_B0015), GFPmut3b (Bba_E0040), RFP (Bba_E1010) and  (Bba_C0051) were cloned from the Biobrick registry. PCR was performed using Phusion DNA polymerase in a dual cycle PCR programme at annealing temperatures of 53 °C and 60 °C for the first 7 and subsequent 20 cycles, respectively. Biological parts were spliced by overlap extension PCR and ligated to vectors pSB4A5 (low copy, pSC101 replication origin) and pSB1C3 (high copy, pMB1 replication origin) using XbaI and PstI restriction sites. Composite systems with two or more biological modules were sequentially assembled as previously described . Parts mutation of λCl repressor binding sites To obtain sequence variants of λCl repressor binding sites, PCR was performed on a pHrpL-λCl-pBAD-Cl2A template with mutagenesis primers 5′-ttcgccggattat and 5′-gctatatNNNNNNNNccggtgatatatggagaaacagta (restriction sites underlined) using Phusion DNA polymerase. The resultant amplificons (about 1.4 kb) were then ligated upstream to the pSB1C3 vector containing an RFP reporter and transformed to competent cells carrying HrpRS AND gate modules in pSB4A5. Single colonies of uniform size were inoculated into a 96-well microplate loaded with 200 ul LBAC (LB with chloramphenicol and ampicillin) and grown in a microplate incubator set at 37 °C with 750 rpm shaking for 6 hours. Accordingly, cultures in each well were triplicated and diluted 10× into 200 ul LBAC with 3.5 mM arabinose and 28 mM rhamnose, 3.5 mM arabinose, and no arabinose under the same growth conditions. Evolved mutants were identified by observable differences in RFP expression and inhibition after 6 hours of induction using a Fluostar OPTIMA microplate reader (BMG Labtechnologies). Validation and characterisation of isolated candidate parts was independently performed in 175 ul LBAC in 1.5-ml microcentrifuge tubes after 4 hours induction at 37 °C and 1,000 rpm shaking under four different logic conditions. Modelling of AND, OR and NIMPLY logic gates To enable model-driven design synthetic biological systems, we examine the effect of ribosome binding sites (RBSs) on the steady state transfer function of input switch devices. By analysing reference data  that had previously characterised the input–output relationship of genetic switches in the form of Eq. , we observed that parameters that are most sensitive to changes in RBS are parameters A and B. Hence, by knowing the relative output of switch devices with weaker RBSs by either prediction from reliable software or by single experimental measurement of a device’s output at input maximal, the parameters A and B can be scaled proportionally to obtain  parameters that accurately predict the transfer function of other devices with weaker RBSs (Additional file : Figure S1A). We validated our approach with previously published data sets (Additional file : Table S1) and showed that the transfer function of input devices pLuxR (Additional file : Figure S1A) and pBAD (Additional file : Figure S1B) with different RBSs can be reliably estimated without additional experimentation. MATLAB modelling scripts are available in Additional file . The transfer functions of input switch devices used in this work with strong RBSs were empirically fitted into the Hill-like equation (Eq. ), while those of input switch devices with weak RBSs were predicted using the validated method as discussed above. Additional file : Table S3 shows the empirical transfer function parameters of the various input switch devices. AND and OR gate profiles were then modelled and predicted using these parameters and equations as shown in Additional file : Eqs. 7 and 10. Additional file : Figures S11, S12 and S13 show the predicted normalised output of the HrpRS AND gate and various OR gate combinations. The NIMPLY gate was empirically modelled using Additional file : Eq. 2 and parameters from Additional file : Table S2. Additional file : Figure S10 shows the predicted output of the NIMPLY gate. Characterisation and orthogonality testing of input switch devices 12915_2015_146_Article_Equ1.gif To characterise input switch devices, reinoculated cultures at OD about 0.5 were transferred to black, flat-bottom 96-well plates (Greiner Bio-One, catalogue number 655090) in aliquots of 150 μl for induction with rhamnose or arabinose in serial twofold dilution with highest inducer concentration at about 28 mM (that is, 0.00 M, 8.38E-07 M, 1.68E-06 M, 3.35E-06 M, 6.70E-06 M, 1.34E-05 M, 2.68E-05 M, 5.36E-05 M, 1.07E-04 M, 2.14E-04 M, 4.29E-04 M, 8.58E-04 M, 1.72E-03 M, 3.43E-03 M, 6.86E-03 M 1.37E-02 M, 2.75E-02 M). The plates were then sealed with gas-permeable foils and incubated at 37 °C with 750 rpm shaking for 3 hours. Fluorescence and optical density data were collected using a Fluostar Optima microplate reader (BMG Labtech) and zeroed with blank LB media with antibiotic to remove background fluorescence and OD. All results were normalised with OD-estimated cell density (validated with viable cell counts) and provided in arbitrary units. In the orthogonal testing of input switch devices, the above procedures were repeated with constructs that contain pRHAB-RFP-pBAD-GFP, with a fixed concentration of 0.02 % arabinose or rhamnose added as appropriate. The experimental results were fitted using an empirical mathematical model  (the Hill equation): Equation  models reporter output () as a function of input concentration of inducer ([X]). The four parameters () were estimated to obtain the best fit curve by performing a nonlinear curve fitting using the experimental results. This curve fitting was performed using the nonlinear least square fitting functions in the MATLAB Curve Fitting Toolbox (The Mathworks, Natick, MA, USA). Characterisation of AND, OR, NIMPLY, XOR, half adder and half subtractor To characterise the steady state profile of AND and OR logic devices, reinoculated cultures at OD about 0.5 were transferred to black, flat-bottom 96-well plates (Greiner Bio-One, catalogue number 655090) in aliquots of 150 μl for induction with varying concentrations of rhamnose and arabinose ranging from 8.38E-07 M to 2.74E-02 M. The plates were sealed with gas-permeable foils and incubated at 37 °C with 750 rpm shaking for 3 hours. Fluorescence and optical density data were collected using a Fluostar Optima microplate reader (BMG Labtech) and zeroed with blank LB media. To characterise the steady state profile of NIMPLY, XOR, half adder and half subtractor logic devices, the above procedures were repeated with slight modifications to reduce evaporation losses in constructs with weaker RBS-RFP modules. Briefly, reinoculated cultures were dispensed in 175 μl aliquots into 1.5-ml capped tubes and induced with varying concentrations of rhamnose and arabinose, as described above. The aliquots were incubated on a thermomixer platform (Eppendorf) set at 37 °C with 1,000 rpm shaking for 4 hours. 150-μl aliquots from each tube were transferred to black, flat-bottom 96-well plates and assayed for fluorescence and optical density with Synergy HT or H1m microplate readers (Biotek Instruments Inc.). To assess the digital performance of all logic devices, cell cultures were separately induced with water, 28 mM rhamnose and/or 7 mM arabinose in four different logic conditions. The induced cultures were incubated in the respective conditions as described above and assayed for fluorescence. All results were normalised with OD-estimated cell density and provided in arbitrary units. Fluorescence imaging of AND and OR gates For the acquisition of fluorescent images in AND and OR logic devices, reinoculated cultures were transferred to 50-ml tubes in aliquots of 5 ml and separately induced with water, 28 mM rhamnose and/or 7 mM arabinose in four different logic conditions overnight. After 15 hours, cell pellets were harvested and transferred to 1.5-ml tubes for fluorescent imaging with suitable filters. Images were acquired with a high mega-pixel mobile phone camera. Reinoculated cultures were dispensed in 175-μl aliquots into 1.5-ml capped tubes and separately induced with water, 28 mM rhamnose and/or 7 mM arabinose in four different logic conditions. The aliquots were grown on a thermomixer platform (Eppendorf, Germany) set at 37 °C with 1,000 rpm shaking for 4 hours. Before assay, 5 μl culture from each sample were diluted 200x in 0.22 μm filtered DI water (pH 7). All expression data were collected using a BD LSRFortessa X-20 flow cytometer (BD Biosciences, San Jose, CA) with a 488 nm argon excitation laser, and 530 nm ± 30 (FITC) and 610 nm ± 20 (PE-CF594) emission filters. The data were gated using both forward (550 v, threshold 1,500 v) and side scatter (310 v) with the neutral density filter removed. At least 10,000 events were recorded per sample. FITC and PE-CF594 channels were set at 466 v and 852 v, respectively. Data analysis was performed with FlowJo (TreeStar Inc., Ashland, OR)..