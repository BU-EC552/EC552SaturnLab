The development of appropriate design frameworks for the construction of synthetic feedback controllers is an important open problem in Synthetic Biology that has recently begun to attract significant attention from the Control Engineering research community [–]. A key requirement for any such framework is that it is consistent with the nature of biological information processing, in order that any resulting designs can be readily implemented via biomolecular circuitry. This represents a significant challenge, since (mainly for historical reasons) many of the implicit assumptions underlying control theory are based on consideration of dynamical properties that arise in the context of physical, rather than biological, systems. For example, the assumption that the dynamics of both the system to be controlled and the feedback controller can be well approximated by linear models is widely made in many branches of feedback control theory. This assumption is often valid for many physical systems (from motors to aircraft to power networks) because these systems have been purposefully designed by engineers to provide predominantly linear response dynamics, since this significantly simplifies their analysis and control. This contrasts strongly with the situation in many biological contexts, where evolution often results in systems that display strongly nonlinear dynamics. A prime example of such nonlinear dynamics is represented by the phenomenon of ultrasensitivity, in which the gain of the system (ratio of output signal to input signal) changes from very low, to very high, and then back to very low as the magnitude of the input signal increases. The resulting sigmoidal shape of the system’s response () is a widely observed characteristic of many different biological systems [, ], and can be achieved via a variety of different molecular mechanisms, including dimerization of transcription factors , use of scaffolding proteins in MAPK systems , and branching in bacterial phosphorylation/de-phosphorylation cycles . In addition to their nonlinear dynamics, all processes in nature are noisy. The functional roles of noise are many and diverse [, ]: on the one hand, noise can be an undesired property of the process, due to entropy-increasing effects that limit the fidelity and robustness of signaling pathways and, then, it is crucial to control and attenuate it; on the other hand, noise can be a surprising beneficial effect by increasing functional heterogeneity and thus diversity (accelerating, for instance, the pace of evolution) and, then, it becomes important to exploit and amplify it. In the last two decades the effects of feedback (ubiquitous in biology) on noise have been well investigated: two seminal works suggested negative feedback as a mechanism for attenuating the effect of noise [, ]. Further theoretical and experimental research has revealed a more intricate relation between negative feedback and noise, indicating that noise can be attenuated or amplified depending on the feedback strength [–]. Interestingly, signalling systems implementing phosphorylation-dephosphorylation cycles in concert with negative feedback loops have been shown to exhibit adaptive characteristics, i.e. an initial response to a persistent external stimulus eventually returns to its pre-stimulus level [–]. This adaptive capability (referred to as “disturbance rejection” in control theory) is a key requirement for many feedback control systems, since it allows the system to robustly maintain specified levels of performance despite the inevitable presence of environmental fluctuations and disturbances. In the following, we show that a control model that combines ultrasensitive responses with negative feedback, resulting in a control model we call ultrasensitive negative feedback (), provides a plausible explanation for the adaptive responses observed in one of the most widely studied biomolecular feedback systems—the yeast osmoregulatory response network [–]. Indeed, the yeast osmoregulation system implements the archetypical mitogen-activated protein kinase (MAPK) pathway, as well as a two-component signaling system, both of which control downstream gene expression. Both the two-component and MAPK cascades have been shown theoretically and experimentally to embed ultrasensitive dynamics [, , –], while gene expression dynamics are usually implemented as a Hill function (e.g. see ). Moreover, the presence of ultrasensitivity has also been suggested for the Fps1 glycerol channels determining the glycerol export rate [, ]. Thus, the presence of ultrasensitivity in the yeast osmoregulation system is broadly accepted. Therefore, these findings point to the possibility of  based mechanisms that allow yeast to achieve adaptive responses. Subsequent analysis of such controller models reveals strong links with a particular class of nonlinear feedback controllers, known as Sliding Mode controllers, whose performance and robustness properties are well known to engineers [–]. Based on these insights, we develop design guidelines that could be exploited by Synthetic Biologists to inform the design of synthetic feedback control circuits for a wide variety of potential applications. 10.1371/journal.pone.0161605.g001 Steady-state input-output characteristics. Relationships for linear, Michaelian and ultrasensitive systems. Osmoregulation as a feedback control system The osmoregulation system can be naturally abstracted as a feedback control system comprised of two separate mechanisms that act to adjust glycerol production in order to keep the cell’s turgor pressure and volume constant in the face of environmental changes (): 1) the regulation of the membrane protein Fps1 determining the glycerol export rate (the Fps1 channel, blue box of ); 2) the activation of the high osmolarity glycerol (HOG) mitogen-activated protein kinase (MAPK) signalling and the corresponding Hog1-dependent mechanisms that promote glycerol production (the series of the Hog1 activation system and the Hog1 mediated branch, red boxes of ). Our model therefore consists of three main compartments: 1) a biophysical module describing how the cell volume and the turgor pressure are affected by varying extra–cellular osmolarity; 2) a control system comprised of two parallel mechanisms that determines the glycerol levels; 3) a glycerol module that determines the intra- and extra-cellular glycerol concentration and the corresponding biophysical properties of the system. The mathematical representations employed for each of these modules are described in the following sections. 10.1371/journal.pone.0161605.g002 Representations of the yeast osmosensing system. (A) Schematic depiction of the osmosensing response. After an osmotic stress, the external osmotic pressure increases and water diffuses out of the cell, causing the turgor pressure and volume to decrease. Two parallel control paths are activated to regain volume and turgor pressure by adjusting the glycerol production: the activation of the Hog1 protein and all the corresponding mechanisms that promote glycerol production; the Fps1 channel, which regulates the outflow of glycerol and is immediately closed after the shock. (B) Engineering block diagram representation of a control model for the osmoregulation system. The biophysical model is based on the work presented in . The system is modelled by considering the dependencies between cell volume , the turgor pressure , the intra–cellular osmotic pressure  and the extra–cellular osmotic pressure . At any given time , (), () and () determine the flow of water across the cell membrane, which is proportional to (() − () − ()). Assuming that the cell volume is only affected by the inflow and outflow of water, then the change in volume can be expressed as

with  denoting a hydraulic water permeability constant. At equilibrium (equil.), i.e. constant volume and no net flow of water over the membrane,  reduces to The only osmolyte considered explicitly in the model is glycerol (); hence, ions and other small molecules that change upon osmotic shock  are not considered. This assumption is motivated by experimental results from , where the authors found that glycerol counter-balances approximately 80% of applied NaCl in . Therefore, the intra-cellular osmotic pressure, according to van’t Hoff’s law, is expressed as

with  being the concentration of the sum of osmolytes (assumed constant) other than glycerol present in the cell, and  being the non-osmotic volume of the cell, subsuming non-polar cellular components, such as membranes. According to , the intra–cellular osmotic pressure increases with the glycerol concentration, which can be used to control the turgor pressure of the cell. The extra-cellular osmotic pressure is only modified by the input signal, (), for example the applied salt stress, and is then independent of changes in other variables. Hence

where  is the extra-cellular osmotic pressure at equilibrium (at  = 0,  = (0) = (0) − (0)). The turgor pressure is linearly dependent on the volume according to , in the following manner:

Here, (0) is the initial volume, (0) is the initial turgor pressure, and  is the volumetric elastic modulus. By expressing the volume at which  = 0 with the notation ,  can be rewritten as There are two branches of control in the model: the first represents the closure of Fps1 glycerol transporter channels as a reaction to osmotic shock, causing accumulation of glycerol and an increase in the intra-cellular osmotic pressure  ; the second the activation of the Hog1 protein and the corresponding Hog1-dependent mechanisms that promote glycerol production (such as the transcriptional activation of genes that encode enzymes involved in glycerol production and potential protein-protein interactions initiated by Hog1 in the cytoplasm or nucleus that lead to glycerol accumulation) [, , ]. The input signal, the error (), arriving at the two control branches, defined by

is the difference between the initial and current turgor pressure. The output of the Fps1 branch, (), which corresponds to the response of the transporter channels, is given by

where  = 1 − exp,  = (0)exp,  is a constant and  is the exponent of the Hill function that determines the dynamics of the Fps1 controller. The function  returns real values in the interval [0, ], where 0 corresponds to completely closed and where  is the glycerol permeability coefficient in a completely open Fps1 channel. Note that we use the sign and absolute value of the error to allow the controller to work in a symmetrical way for positive and negative values of the error. To describe the dynamics of the Hog1 activation we use the following first order linear system, as done in :

Here  and  are constants, and  represents the activation of Hog1. We constrain  and  to assume similar values, to achieve linear dynamics between the error and the Hog1 activity as proposed by  based on which components of the system display adaptive dynamics. To model the Hog1 mediated feedback control branch, using an  controller, we implement a Hill-type function so that the output of this controller is given by

where  is the gain of the controller,  = 1 − exp,  = exp and  and  are constants. Note that the Hog1 mediated controller only works for positive values of the input and is switched off for negative values. Eqs () and () allow the controllers to evolve from proportional ( =  = 1) to ultrasensitive dynamics (,  > 1). Indeed, for  =  = 1, the parameters  = 1 − exp and  = 1 − exp become 0,  = (0)exp = (0) and  = exp = 1, and thus we end up with the following proportional () controllers: Finally, we consider the case where the Hog1 pathway implements an integrator as proposed in , where the authors hypothesised that, to achieve perfect adaptation, the system implements an integral feedback via a non-transcriptional pathway that requires the Hog1 activity. Then, the output of this channel is described by the following equation:

where  is the gain of the channel and  is the time window of the integral. In the case of infinite integration time ( = ∞), the controller implements an ideal integrator ().  takes into account the complete history of the process and produces an output value proportional to the integral of the error (over a potentially infinite integration period). If  is finite, the controller implements a finite integrator (), which is able to store only a limited history of the error. The exchange of internal and external glycerol, , over the Fps1 channel is modelled using Fick’s first law of diffusion as

with  being the extra-cellular volume,  being the intra-cellular glycerol and  being the glycerol in the extra-cellular compartment. The extra-cellular glycerol, depending only on the diffusion over the Fps1 channel, is described by

Intra-cellular glycerol production, which is used to control the turgor pressure of the cell by changing the intra-cellular osmotic pressure (see ), is expressed by combining the output of the two controllers described above: Our model contains 20 parameters as reported in . However, four of these are dependent parameters which do not need to be constrained. Optimization of the parameters for different control schemes against experimental datasets For each control scheme we use global optimization algorithms to optimize the model parameters to fit the available experimental data presented in , in particular the volume and the Hog1 responses to step shocks of 0.2, 0.4 and 0.6 M of NaCl.  reports the optimal model parameters obtained for each combination of dataset and control scheme. Optimisation problems were formulated by the square sum of the errors between the simulated responses (volume and Hog1) produced by the model to different osmotic stresses and the experimental data as follows:

where  is the set of model parameters, () and () are the experimental volume and Hog1 measurements, respectively, at time  for the -th experiment (step shock with different amplitude) and  and  are the volume and Hog1 responses of the model, respectively, at time  for the -th experiment. Note that in our model we do not consider any growth mechanism; therefore, when the volume is completely recovered, i.e. () > 1, the data points are assumed equal to 1 for our computations, as in . For each control scheme, we optimize the control parameters and the main biophysical parameters (which are , defining the volume at which the turgor pressure is zero, and , the water permeability coefficient). All the other parameters, which showed little effect when varied, are fixed as reported in . For the optimization, we use a hybrid Genetic Algorithm (GA) , that combines the most well-known type of evolutionary algorithm with a local gradient-based algorithm [, ] to ensure the computation of globally optimal solutions. Indeed, most optimization problems encountered in biology involve non-convex search spaces and thus any local optimization algorithm, which uses gradient information of the cost function to find the search direction for determining the optimum, may only provide a local, rather than a global solution, depending on where in the search space the optimization starts. GA, in contrast, uses a heuristic search technique that mimics the process of natural selection and then requires only the calculation of the cost function. Therefore, due its stochastic nature, GA can be expected to have a much better chance of converging to a global optimum than a local optimization algorithm, and a hybrid GA makes the solution more robust. For the computation, we use the function  from the MATLAB Global Optimization Toolbox  and  from the MATLAB Optimization Toolbox , as the local algorithm. We repeat the hybrid GA algorithm five times and select the parameter set that gives the optimal value of the cost function . Availability of models and computer code MATLAB code containing the files for generating the results presented in the main text and Supporting Information is provided as an additional . A model based on  control explains experimental data on yeast osmoregulation We focus on yeast osmoregulation as a model system to investigate the possible mechanisms for adaptive response dynamics. Several experimental studies have provided detailed data on the dynamics of the yeast osmoshock response, and have elucidated the molecular pathways involved [, , ]. In brief, yeast perceives a change in external osmolyte conditions (e.g. salt shock) as a drop in cell volume and turgor pressure, sensed through its membrane bound osmosensor, SLN1 (see ). SLN1 is part of a two-component signalling cascade that leads to activation of a mitogen-activated protein kinase (MAPK) cascade, which leads to the phosphorylation of the transcription factor Hog1 . Phosphorylated Hog1 translocates to the nucleus and activates the expression of genes encoding enzymes involved in glycerol production. In addition, a drop in turgor pressure leads to the closing of the membrane bound glycerol channel Fps1. The resulting accumulation of glycerol inside the cell reinstates the turgor pressure and cell volume, and thus underpins the observed adaptive dynamics in cell volume. We model the described osmoregulatory network as a feedback control system, where the SLN1 receptor is seen as computing the difference (i.e. error) between the current and an ideal turgor pressure (where the latter corresponds to the steady state cell volume), while the Fps1 channel and the Hog1 pathway leading to glycerol activation are seen as feedback controllers that process the error and feed their response back to the system (see  and ). The system to be controlled is considered to involve the cellular glycerol levels and their effect on turgor pressure and volume (see ). This model architecture allows us to investigate the effect of implementing different types of response dynamics for the two feedback controllers on the model’s ability to match the available experimental data on responses to osmotic shocks. Within the yeast osmoregulation system, the presence of ultrasensitivity has been either demonstrated or suggested in several parts of the system, e.g. the SLN1 two-component system preceding the MAPK cascade , the MAPK cascade terminating at Hog1 , the Fps1 glycerol channels [, ] and the mechanisms mediated by Hog1 that promote glycerol accumulation, such as the transcriptional activation of genes encoding enzymes involved in glycerol production and potential protein-protein interactions initiated by Hog1 in the cytoplasm or nucleus that lead to glycerol accumulation [, ]. To capture these observations, we develop a model that implements an  controller for both the Fps1 and Hog1 mediated feedback systems, named - (, Eqs () and ()). Optimising the parameters of this model within biologically feasible ranges produces an excellent fit to datasets on yeast responses to stepwise osmotic shocks of various sizes ( and ). For the purposes of comparison, two canonical linear controllers, proportional negative feedback () and integral negative feedback (), are also implemented in the model and optimised against the same datasets (see  and  for the main properties of these controllers using a generic control scheme).  reports all the possible control schemes here exploited for explaining the experimental data. The  controller is commonly used in control engineering and simply amplifies the error by a certain linear gain factor. Thus,  control in itself is not expected to result in adaptive response dynamics, unless the process it controls (in this case, the biophysical model of glycerol accumulation and its effect on volume) implement an , required for achieving adaptation as shown through analytical results from control theory [–]. In particular, to see if  control alone can explain the observed data, we develop a model (named -), which assumes that both the Hog1 and Fps1 mediated feedback controllers implement a  control (, Eqs () and ()). By optimizing the model parameters so as to get the best possible fit to the experimental data (see ), we find that this model provides a very poor fit, as shown in . In particular, the large steady-state errors produced by this model, and the lack of adaptation, clearly indicate that the controlled process itself does not contain an integrator. Stated biologically, the dynamics of glycerol accumulation itself and its connection to turgor pressure and volume cannot, on their own, explain the observed data. Then, we investigate the performance of a model implementing an  controller. Based on the hypothesis that the observed adaptive dynamics must require an  controller, a previous study placed this type of controller on the Hog1 mediated feedback route . This conclusion was based on the fact that the elements in a control system placed before an  controller must show adaptive dynamics, whilst those placed after such a controller will not. In the case of the yeast osmoregulation system, glycerol levels in the yeast osmoregulation do not adapt, while Hog1 levels do, and thus leading to the proposal that the integral controller resides in the Hog1 mediated feedback path . Therefore, we develop a model (named -) implementing a  controller for the Fps1 channel and an  controller for the Hog1 mediated branch. We find that the - can achieve a good fit to all experimental data, when optimized (see ). However, not all responses to different osmoshock strengths are equally well captured with such a model. We find that achieving a better fit to high levels of osmoshock reduced the fit to low levels and . In particular, a good fit to low (high) levels of osmoshock requires the integral control gain to be optimized to high (low) values (see ). Increasing the gain of the integrator to achieve a faster response and improve the fitting to the experimental data for low levels of osmoshock (such as the stress input of 0.2 M of NaCl), however, results in a worse fitting to data for higher levels of osmoshock and overshoot in the volume response, which is not observed experimentally (see panel A in ). When we consider an integral controller with a more biologically plausible finite integration window,  (i.e. shorter memory, termed ), the difference between simulated and experimental data for such a model (named -) becomes greater than that achieved by - and, in particular, the fit to adaptation levels is much worse (see ). We also develop a model implementing  controller for the Fps1 feedback channel and an  or  controller for the Hog1 mediated feedback branch, named - and -, respectively (see  and  Figs). In all cases, however, the - model is seen to exhibit a significantly better match to the available experimental data.  reports the  values calculated using , showing the corresponding model scores: a lower value of  indicates a better fit to the data, and - gets the lowest value. However, the loss function does not take into account the different number of parameters for each model without thereby penalizing models with a larger number of parameters (as -). Therefore, we also compute other standard scores as Akaike information criterion (AIC) , Bayesian information criterion (BIC)  and Akaike’s final prediction-error criterion (FPE) . In general BIC tends to penalize complex models more heavily, on the other hand AIC and FPE tend to choose models which are too complex as the number of data goes to infinity. For all the scores (whose values are reported in ), the - model achieves the lowest values, further confirming that it is the model that is best capable of reproducing the multiple experimental datasets. Note that our model, in line with all previous models [–], is based on the assumption of deterministic dynamics. Indeed, experimental studies have indicated that the noise levels in the system are low due to the abundance of Hog1 [, –], and then a deterministic model is well-suited for describing the osmoregulation system dynamics. However, we also investigate the effects of noise on controller performance for the - model, by adding normally distributed noise to the outputs of the two controllers (see ): the results are in line with those obtained without noise (see ), the responses for the different inputs are robust to the effects of noise as the deviation between the simulated and experimental data is limited, and we can state that the deterministic solution of the - model represents the mean of stochastic simulations. 10.1371/journal.pone.0161605.g003 Best fit to osmoshocks for the - model. Best fit to the experimental dataset for the cell volume (A) and the Hog1 (B) responses to three step osmoshocks of different magnitude; the experimental data for 0.2, 0.4, and 0.6 M of NaCl are indicated by black circles, red diamonds, and blue squares, respectively. The corresponding coloured solid lines represent the optimised model responses. 10.1371/journal.pone.0161605.t001 Different control schemes exploited for reproducing experimentally observed responses of yeast to different levels of osmoshock. Proportional negative feedback () Proportional negative feedback () Proportional negative feedback () Proportional negative feedback () Finite integral negative feedback () Ultrasensitive negative feedback () Ultrasensitive negative feedback () Finite integral negative feedback () Ultrasensitive negative feedback () Ultrasensitive negative feedback () control provides a metabolically efficient means of achieving adaptation To better understand the basis of the different degrees to which the ,  and  control schemes are able to fit the data, we analyze the temporal outputs of different models (). As expected, each control scheme responds to the osmoshock by decreasing the Fps1 controller activity (corresponding to a closing of the Fps1 channel) and increasing the glycerol production mediated by the Hog1 controller (). As glycerol accumulates and volume recovers, the error starts to decrease () resulting in a decrease in the glycerol production mediated by the Hog1 controller () and the re-opening of the Fps1 channel (). This eventually leads to the system reaching a new dynamical steady state. We find that a crucial aspect of each control scheme’s ability to capture the adaptation dynamics is the interplay between error-mediated changes in the glycerol production and export (i.e. Hog1 vs. Fps1 controller dynamics). When both the controllers incorporate linear dynamics (e.g. for the - and - models, where the Fps1 channel implements  and the Hog1 mediated branch implements  or  as proposed in , respectively), the Fps1 channel opens before the volume is completely recovered (, blue and green lines), triggering the leakage of glycerol out of the cell prematurely. Thus, higher Hog1 mediated glycerol production is required to increase the glycerol level and recover the cell volume. When both controllers implement , however, the strongly nonlinear controllers respond rapidly to the stress by immediately increasing the glycerol production (, red line) and the Fps1 channel remains partially closed until the error becomes less than a certain threshold. 10.1371/journal.pone.0161605.g004 Temporal dynamics of the controllers for the different models. The output of the Fps1 channel (A), the glycerol production (B), the glycerol concentration (C), and the error (D) are shown for the different control schemes (-, -, - as indicated in the legend), assuming an osmotic stress of 0.4 M of NaCl. controllers implement a quasi sliding mode control scheme To better understand the ability of ultrasensitive negative feedback to produce adaptive dynamics, and to develop some general guidelines for the design of synthetic controllers based on this approach, we analyse the performance of such a controller using a generic closed-loop feedback control model (see ). In this simplified system, the controller is employed to maintain a given process at a particular set-point when it is subject to a step disturbance (). The input of the controller is the error signal, , defined as the difference between the desired output,  (called the reference signal), and the actual output of the system, . Based on the error signal, the controller manipulates the input to the process, , to reduce the effect of the disturbance, , on the output  and therefore obtain the desired response. We also analyze the performance of individual , ,  using the generic closed-loop feedback control model and derive analytical expressions for the controller output (see  and ). Inline with control theory, we show that for the  controller, achieving an error value close to zero requires a very large gain resulting in very high output signals from the controller even for a very small disturbance (see panel A in ). For the  controller, the output of the process is equal to the reference signal at steady state given any step disturbance, i.e. the error is zero at steady state and the system achieves perfect adaptation (see panel B in ). However, the time to reach the steady state varies with controller parameters, and making the integration time window finite () can destroy the ability of the integral controller to recover the original steady state value (see panels C–E in )). An ultrasensitive controller (), where the error is processed through a system with ultrasensitive (sigmoidal dose-response) dynamics, before being fed into the process, can be modelled using a simple Hill-type function, so that the input from the controller back to the process can be represented by

Note that we use the sign and absolute value of the error to allow the controller to work in a symmetrical way for positive and negative values of the error. For such a controller, an analytical expression for the system output cannot be derived. However, it is possible to show that the  controller can achieve a steady state error value very close to zero. Indeed the steady state error can be visulaized by plotting both sides of Eq (A25) in  as shown in : the intersections of the straight line ( −  − ) with , for different values of  and , by varying  (), correspond to the steady-states of the system. For the purposes of comparison,  also shows the corresponding steady-states obtained with a proportional controller—these are given by the intersection of the straight lines ( −  − ) (dashed black line) and 
 (dash-dot green line). Note that for any value of , given a small value of  and without increasing the gain , the ultrasensitive controller can achieve a steady-state error value very close to zero, therefore, high values of  and  are not needed. In contrast, achieving similarly low levels of error with a proportional controller (dashed green line) would require increasing the gain towards infinity (a requirement that is never practically feasible). Moreover,  provides a more tunable system, where both the maximal response and the point of high sensitivity can be adjusted by changing independent parameters (). We now show how the ultrasensitive controller defined by  implements an approximation of a well-known class of controllers, based on sliding mode control (SMC), a nonlinear technique for robust control system design [–]. Note first that as  goes to zero,  assumes the following formula (see also ):

This kind of switching controller takes only two values,  and −, and has a discontinuity on the straight line  = 0. The equation of the line,  =  =  −  = 0, is known in sliding mode control theory as the sliding manifold, where  is the sliding variable. The typical dynamics in sliding mode control consist of a , during which trajectories starting away from the sliding manifold  = 0 move towards it and reach it in finite time, followed by a , during which the dynamics will be confined to the manifold  = 0. By setting opportunely the gain  (for details see ), the control signal , defined by , will therefore bring the error to zero in finite time and then maintain the condition  = 0 for all future time. shows the performance of the closed loop system with a sliding mode controller described by  for different values of . We assume that the system output is initially equal to the desired constant output,  = (0) =  =  = 1 ( = 0 in inequality (A33) in ). Then the control gain is only designed to compensate for the bounded disturbance , which is assumed to be a step disturbance applied at time  = 1 with amplitude  = 0.2. So setting  >  (see relation (A33) in ) (the parameter  = 1) is sufficient to reduce completely the effect of the disturbance  on the output  and to obtain the desired response (red dashed-dotted plot in ). By contrast, if  < , the system is not able to attenuate the effects of the disturbance (blue plot in ). shows the performance when the output ((0) =  = 0) is not initially equal to the desired value ( = 1) and a step disturbance is applied at time  = 1 with amplitude  = −0.2. Then the control gain of the sliding mode controller is designed not only to compensate for the disturbance, but also to force the system to move toward the sliding manifold ( =  = 0) (in this case  > 1 in inequality (A33) in ). As shown in , if inequality (A33) in  is satisfied, then the system is able to move towards the sliding manifold  =  = 0 and maintain it for all future time. show that the output response exhibits a zigzag motion of small amplitude and high frequency in the sliding mode, a phenomenon known as . For an ideal SMC, the switching frequency goes to infinity and the amplitude of the zigzag motion goes to zero—note, however, that such an infinitely fast switching frequency is not achievable in biological reality. In addition, theoretical issues like the existence and uniqueness of solutions and validity of the Lyapunov analysis (see ) have to be considered due to the discontinuous nonlinearity sgn() in the ideal SMC (see ). In engineering practice, therefore, these issues are usually avoided by using continuous/smooth approximations of the discontinuous SMC. Interestingly, the  controller considered here is an example of such a smooth control function, which can be used to approximate the nonlinearity sgn(). In this case, there is no ideal sliding mode in the closed-loop system of , since the sliding variable cannot be driven to zero in a finite time. However, for small values of , the closed-loop response of the system with an  controller is close to that achieved by an ideal SMC (). Moreover,  can be approximated by the following saturation nonlinearity with high slope

where  is the slope for the linear regime.  shows the sigmoidal input-output relationship for the  controller with  = 0.01,  = 2 and  = 1, together with its saturation function approximation and the discontinuous nonlinearity sgn(). More generally, the  controller can be approximated by a piecewise linear function  and, when  becomes small, the piecewise linear function is well-approximated by the corresponding saturation function (see Eqs (A37)–(A39) in ). shows the output response of the closed-loop system for the  controller with  = 2 and different values of , together with the response obtained using its approximated saturation function (defined by Eq (A39) in ) for the same set of  values, and the response given by the ideal SMC. As shown in the figure, only the ideal SMC is able to completely eliminate the effect of the disturbance. However, the results for the  and its approximated controller are very similar and the effect of the disturbance on the output becomes negligible by decreasing the  value of the  (i.e increasing the slope  = 1/(2) of the saturation function). Indeed, as shown in , the saturation control function of  will force the trajectory of the closed-loop system to reach in finite time the set || < 1/, called the , and remain inside it thereafter. Therefore, the ideal discontinuous SMC is replaced by a smooth/continuous controller, such that the error is not confined to the manifold  = 0, but lies inside the boundary layer || < 1/. In the case of the  controller, a good estimate of the boundary layer is given by Since the boundary layer specifies the maximum value of the error signal, relation  can be used as design guidelines to relate controller parameters (that need to be chosen by the designer) to closed-loop performance. In the limit  → 0 ( → ∞), the dynamics of the  controller approach those of the ideal SMC. Thus, the  controller of  is an example of a , for which a large set of supporting theoretical results and computer-aided design tools exist in the engineering literature . 10.1371/journal.pone.0161605.g005 Performance of the generic closed-loop feedback system. (A) Block diagram representation of the generic control system model. (B) Steady state error for the generic closed-loop system, while varying the parameter  of the process, with the process parameter , reference signal  and step disturbance amplitude  held constant ( =  = 1,  = 0.2). Intersections of the magenta line with the black dashed straight lines give steady state error values for the  controller ( = 0.01,  = 2 and  = 1). Intersections of the green lines with the black dashed straight lines give steady state error values for the  controller (dashed-dotted line for  = 1; dotted line for  = 50). (C) Steady state error for the closed-loop system, while varying the amplitude  of the step disturbance, , with different values of  (red and magenta lines for  = 1; orange line for  = 2) and  (red line for  = 0.1; magenta and orange lines for  = 0.01) for the  controller ( is fixed at 2). 10.1371/journal.pone.0161605.g006 Performance of the generic closed-loop feedback system using , , and its approximation by the piecewise function . (A-C) Response dynamics obtained using: (A-B) , a sliding mode controller (() = sgn()) for different values of the gain  and (0) = ; (C) , its approximation by the piecewise function  and the ideal , with  = 0.25,  = 2 and different values of . The parameters ,  and the constant reference signal  are set equal to 1. The system output is initially equal to the desired constant reference value (0) =  =  (A and C), whereas (0) =  = 0 (B). A step disturbance, , with amplitude  = 0.2 (A and C),  = −0.2 (B), is applied at time  = 1. (D) Input-output (-) relationships for the  controller (solid magenta plot), its approximation by the saturation function sat( ⋅ ) with  = /(4) (dashed blue plot), and the ideal SMC (i.e. the discontinuous nonlinearity sgn()—dashed-dotted green plot). When  = 2, then the saturation function sat(/(2)) is equal to the piecewise function  that approximates  (see Eqs (A38)–(A39) in ). As Synthetic Biologists strive to design and build ever more complex systems, it is imperative to make progress in linking feedback control theory with the mechanistic realities underlying cellular information processing. Ultrasensitivity and negative feedback are ubiquitous features of biomolecular circuitry—when combined they offer the potential for achieving precise, fast and robust control over biomolecular dynamics—and there is increasing evidence that such ultrasensitive negative feedback is a core control strategy employed by natural biological control systems. Indeed, ultrasensitivity is observed to emerge via many different mechanisms including covalent modification, dimerization and branching architectures [, , ]. The yeast osmoregulation system implements the archetypical MAPK pathway, as well as a two-component signalling system, both of which control downstream gene expression, and have been shown theoretically and experimentally to embed ultrasensitive dynamics [, , –], while gene expression dynamics are usually implemented as a Hill function (e.g. see ). Moreover, the presence of ultrasensitivity has also been suggested for the Fps1 glycerol channels [, ]. Given such prevelance of ultrasensitivity in the osmosensing system, the findings presented here suggest that  could be an appropriate paradigm for understanding cellular adaptive response dynamics. In the  chemotaxis system, which also displays adaptive responses, ultrasensitivity is observed at the level of receptors and in the interaction of the signalling proteins with the motility apparatus [, ]. It is thus also possible that ultrasensitivity is implemented within the chemotaxis signalling pathways  and might have underpinned an evolutionary step in generating adaptive response dynamics [, ]. Moreover, we show that the  controller can approximate a sliding mode controller, whose strong robustness and performance properties are well understood amongst control theorists [–]. It has so far not been appreciated that ultrasensitivity, when combined with negative feedback, can implement a quasi sliding mode controller in order to generate adaptive responses. Here, we explore this connection in detail and derive a direct relationship between the key property of the quasi sliding-mode controller (the boundary layer specifying the maximum values of the error signal), and the biologically inspired parameters of the  controller ( and ) (see relation ). Then, if the yeast osmoregulation system employs an  controller, our study shows that adaptation precision would depend on the parameters  and . Thus, we could experimentally evaluate the presence/absence of an  controller by measuring changes in adaptation precision with regard to changes in parameters  and  describing the sensitivity and threshold of the ultrasensitive response. Biologically, the values of these parameters would depend on the kinetic rates and structure of the biochemical reactions implementing ultrasensitivity in the yeast osmoregulation system, as discussed above. In particular, it has been shown both theoretically and experimentally that the level of sensitivity (i.e. parameter ) and the level of signal threshold (i.e. parameter ) in MAPK signalling systems can be controlled by the concentration and kinetic properties of kinases and phosphatases , and the level of scaffolding proteins [, ]. Similarly, it is shown that two-component signalling cascades are able to implement ultrasensitivity, in a manner where both sensitivity and threshold level can be tuned by the concentration of the proteins involved [, , ]. Thus, experimentally altering the structure and protein concentrations of the MAPK and two-component signalling cascades in the yeast osmoregulation system would be expected to lead to alterations in the adaptation precision of the cell volume and Hog1 levels following an osmoshock if the system implements an  controller. In synthetic biology, where the aim is  engineering of system dynamics, then the  controller provides a simple way for implementing adaptive response dynamics. The engineering of an  controller can make use of several mechanisms for implementing ultrasensitivity, including those observed from dimerization of transcription factors , use of scaffolding proteins in MAPK systems , and branching in bacterial phosphorylation systems . In the case of the ubiquitous phosphorylation-dephosphorylation cycles, several biochemical implementations have already been identified theoretically as implementing adaptive response dynamics [, –]. Therefore, by recognizing the important role of ultrasensitivity and negative feedback control in generating adaptive response dynamics in biological systems, and making connections between these biological realities and a branch of nonlinear control theory known as sliding mode control, we are able to generate analytical insights and quantitative design guidelines that provide a useful foundation for progressing the design and construction of robust synthetic feedback control systems. A zipped folder containing the MATLAB code for generating the results presented in the main text and Supporting Information. Click here for additional data file. Performance analysis of , ,  and  controllers using a generic closed-loop feedback system. Click here for additional data file. Best fit to osmoshocks for the - model. Best fit to the experimental dataset for the cell volume (A) and the Hog1 (B) responses to three step osmoshocks of different magnitude; the experimental data for 0.2, 0.4, and 0.6 M of NaCl are indicated by black circles, red diamonds, and blue squares, respectively. The corresponding coloured solid lines represent the optimised model responses. Click here for additional data file. Best fit to osmoshocks for the - model. Best fit to the experimental dataset for the cell volume (A) and the Hog1 (B) responses to three step osmoshocks of different magnitude; the experimental data for 0.2, 0.4, and 0.6 M of NaCl are indicated by black circles, red diamonds, and blue squares, respectively. The corresponding coloured solid lines represent the optimised model responses. Click here for additional data file. Performance evaluation for the - controller by varying the value of the optimized integral control gain, . (A) Volume and Hog1 responses to increasing the optimized value of . (B) Volume and Hog1 responses to decreasing the optimized value of . In each panel the upper plots show the volume responses; the lower plots show the Hog1 responses to step osmoshocks of 0.2 (first column), 0.4 (second column) and 0.6 M (third column) of NaCl. In each plot the red circles represent the experimental data. Click here for additional data file. Best fit to osmoshocks for the - model. (A-F) Best fit to the experimental dataset, the cell volume (A, C, E) and the Hog1 (B, D, F) responses to three step osmoshocks of different magnitude, with different values of the integration time window,  ( = 5 min (A, B);  = 10 min (C, D);  = 20 min (E, F)). The experimental data for 0.2, 0.4 and 0.6 M of NaCl are indicated by black circles, red diamonds, and blue squares, respectively. The correspondingly colored solid lines represent the optimized model responses. Click here for additional data file. Best fit to osmoshocks for the - model. Best fit to the experimental dataset for the cell volume (A) and the Hog1 (B) responses to three step osmoshocks of different magnitude; the experimental data for 0.2, 0.4, and 0.6 M of NaCl are indicated by black circles, red diamonds, and blue squares, respectively. The corresponding coloured solid lines represent the optimised model responses. Click here for additional data file. Best fit to osmoshocks for the - model. (A-F) Best fit to the experimental dataset, the cell volume (A, C, E) and the Hog1 (B, D, F) responses to three step osmoshocks of different magnitude, with different values of the integration time window,  ( = 5 min (A, B);  = 10 min (C, D);  = 20 min (E, F)). The experimental data for 0.2, 0.4 and 0.6 M of NaCl are indicated by black circles, red diamonds, and blue squares, respectively. The correspondingly colored solid lines represent the optimized model responses. Click here for additional data file. Responses to different step osmoshocks by adding normally distributed noise to the controller outputs for the - model. (A) Volume and (B) Hog1 responses to three step osmoshocks of different magnitude. Black plots: simulated responses to a step osmoshock of 0.2 M of NaCl (grey circles—experimental data); red plots: simulated responses to a step of 0.4 M of NaCl (grey diamonds—experimental data); blue plots: simulated responses to a step of 0.6 M of NaCl (grey squares—experimental data). 1000 independent simulations are performed. Click here for additional data file. Performance of the generic closed-loop feedback system for ,  and  controllers. Response dynamics obtained using: (A)  for different values of the gain ; (B)  for different values of the gain ; (C-E)  with the time window  =  and different values of the gain  (C);  = 5 and different values of  (D);  = 1 and different values of  (E). The system output is initially equal to the desired constant reference value (0) =  =  = 1. A step disturbance, , with amplitude  = 0.2 is applied at time  = 1. Click here for additional data file. Model parameters for the osmoregulation system. Click here for additional data file. Optimization of the model parameters for the different control schemes against multiple experimental datasets. Click here for additional data file..