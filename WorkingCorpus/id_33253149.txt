Many synthetic gene circuits fall into the category of information-processing systems that convert molecular inputs to molecular outputs according to a specific relationship , often called a “program”. A typical design-build-test cycle of a synthetic gene circuit requires that an input/output (I/O) relationship be characterized in order to confirm circuit function. Direct characterization is possible when both the input(s) and the output(s) can be measured simultaneously in single cells. Using fluorescent reporters, it is possible to obtain the collection of single-cell data points of the type [; ], including for natural regulatory pathways, either by direct observation using staining, or by creating synthetic analogs of natural circuits furnished with fluorescent reporters [–]. It has emerged that the output forms a distribution at a single cell level for each input [–], resulting in a two-dimensional probability distribution for the entire I/O relationship, rather than a curve, due to cell-to-cell variation in parameter values. Nevertheless, after averaging, these noisy data sets usually collapse to Hill functions or to multimodal, two-value functions . Characterization of a circuit that is stably integrated in a cell genome or on replicating fixed-copy episomal vectors is usually straightforward, provided that the inputs and the outputs can be measured. Thus, till now most of characterized input/output behaviors were obtained in bacteria or yeast, where genome manipulation is relatively facile. However, obtaining such “ground truth” information in mammalian cells has lagged behind, because it is still very labor-intensive to establish stably integrated multi-gene circuits. Further, properly executed characterization requires multiple accompanying control circuits to serve as baseline, thus requiring that not one but multiple stable cell lines be developed. Even though technologies such as transposon  and viral delivery , targeted integration via Zinc finger nucleases (ZFNs) , transcription activator-like effector nucleases (TALENs)  or clustered regularly interspaced short palindromic repeats (CRISPR)/Cas9  are available today, they are still time consuming even in simple cases and become more challenging with the increase in circuit size. Integration locus-specific effects further complicate the characterization. Transient transfection of gene circuits is a widespread alternative to stably-integrated circuit characterization in mammalian cells [–]. Multiple plasmids, each carrying a single gene, can be co-delivered, leading to correlated gene copy numbers in individual cells. The expression of gene products in dividing cell cultures typically reaches quasi-steady-state two to three days post transfection, and decreases on days four to six due to plasmid dilution . The advantage of the transient transfection is that the genome integration-specific effects can be ignored; likewise, secondary effects that often result from having a few genes close to each other on the genome do not play a role because each gene is encoded on a separate plasmid. On the other hand, transient transfections are extremely noisy due to large copy number variation (1–150 transcriptionally-active gene copies per cell ), which makes direct interpretation of the resulting datasets impossible. Accordingly, the standard analysis applied to transient transfection data is at the cell population level, with average values of inputs and outputs reported for entire cell populations (see, Schreiber et al.  as a representative case). This works sufficiently well for logic gene circuits that are often characterized at the extremes of their input values. Progress towards deriving continuous input/output relationship using transient transfection data has been made in the past [,–]. However, these methods were designed to extract monomodal input/output curves and are thus unsuitable for bi- or multimodal circuits. Moreover, there has been very little computational or experimental validation of these results, in particular, how they compare to stably-integrated systems, and to what the different input/output curves correspond. We sought to develop a data analysis strategy that would determine input/output relationships from transient transfection data and be applicable to all steady-state networks, including those with bi-modal or bi-stable behavior. We also sought to understand what exactly constitutes a comparable "stable integration" scenario for the information extracted from raw transient transfection data. Accordingly, we first investigate the gene copy number distributions in cell populations that are easily identifiable in flow cytometry-like datasets. We address the question numerically and find a number of important reproducible trends that make it possible to draw reliable and interpretable conclusions from data obtained in transient transfections, and map them back to their stable-integration counterparts. In order to validate the method, we perform  experiments by simulating flow cytometry data expected in a transient transfection using dynamic circuit models. At the same time, we use the exact same models and parameter values to simulate the input/output relationship for the case of stable genomic integration. With this approach, we are able to evaluate whether our workflow, when applied to transient transfection data, results in an input/output behavior that is similar to the input/output behavior one would expect for a stable integration. As benchmarks, we focus on three-node gene network motifs that have been extensively studied earlier . We find excellent correspondence between the results of our processing pipeline and the ground truth of the stable integration. Importantly, we are able to capture multi-value, bi-modal responses. Therefore, the method described here can be used to analyze transient transfection data and draw conclusions about the underlying input/output mapping in complex gene circuits, without the need to construct stable cell lines. Statistical framework for transient transfection In what follows, we define a gene circuit as a set of  genes

and their corresponding gene products

in which a subset of components

is defined as  and a subset of components

is defined as . Further, consider a cell that harbors a gene circuit, either in a stably-integrated or transiently-delivered fashion, such that a gene  is present in  copies in that cell, and the entire set of copy numbers is a vector Hereafter, we consider only interactions between circuit components that have been intentionally engineered (.., chromatin-related effects do not interfere with circuit function in the stable case), and assume that the biochemical parameters describing individual interactions do not change between stably integrated and transiently-delivered components. Even though individual cells in a population of stable clones may behave differently, .., through stochastic effects , we expect the aggregate statistics of different clones containing identical circuit copy number to be similar to the aggregate statistics of cells transiently transfected with the same circuit copy number. Therefore, when considering stable clones, we imply an idealized "averaged" clone in which the integrated circuit is governed by the same parameters as the transiently transfected circuit. It then follows that if we apply the same input  to a population of cells that all harbor the circuit with the copy number vector , and allow the cells to arrive at a steady state in the stable case and to the quasi-steady state in the transient case (see  “ time-courses”), then the outputs  will form the same statistical distribution, which can be mono- or multimodal , in both cases. Reporting the distribution of  for various inputs  would conclude the characterization of a stably-integrated circuit, because all cells harbor the exact same vector , which can be engineered or experimentally determined  after clonal isolation. In the transient transfection experiment, while the values of  and  could be collected for individual cells, the underlying values of  are unknown because the process of transient delivery is extremely noisy. The only way to derive useful data from transient transfections is to deduce, at least for a subset of cells, their  values, and group together data from cells with similar values of . If this can be accomplished, the input and output values measured in these cells will be similar to the values one would have obtained with a circuit stably integrated at  copies. Below, we develop a statistical description of a transient co-transfection process, which leads us to identify cells residing in binned modes of input and output distributions as cells for which the copy number vector  can be estimated. We start with the statistical description of a multi-plasmid co-transfection of  constitutively expressed and mutually independent genes ,,…,, generating (fluorescent) protein products ,,…,. Note that there is no input in this system, so every protein product can be called an “output”. Available data  suggest that experimentally-observed distributions of a protein level expressed from a constitutive promoter are lognormal. The mean of the distribution is proportional to the gene copy number  with the promoter-dependent global proportionality coefficient  being independent of ; the standard deviation  of the log-transformed protein level distribution may, in principle, depend on a copy number, but we assume it to be constant in the following equations. Let us define a random variable  as the log-transformed protein output of the gene . is distributed normally and its mean/mode , and standard deviation, , relate as follows to the mean of the underlying pre-transformed distribution

and therefore The conditional probability density function () of  given a gene copy number  and parameter  is then described by For a vector of gene copy numbers  = [,,…,], a conditional multivariate  of the log-transformed protein expression values  = [,,…,], provided that each gene generates its own protein output independently of each other, is described by a multivariate normal distribution without covariances (for simplicity, we assume  to be the same for all genes and use a symbol  in what follows): To describe the distribution of gene copy numbers in a transient transfection, we introduce an independent parameter  that we call “multiplicity of transfection”. Indeed, there is no experimental data that concerns the probability distribution of genes in a co-transfection, and it likely depends on the exact transfection protocol. Therefore, we make a baseline assumption about the  of the gene copy number vector  as a multivariate normal distribution without covariance that depends on the multiplicity of transfection. The standard deviation of each gene copy number distribution scales linearly with multiplicity, with the scaling factor . To account for gene combinations that deviate from an equimolar ratio, a parameter  describes the relative abundance of a gene. In this case, one gene is assigned as the "reference" with  = 1. Lastly,  itself can be distributed non-uniformly according to its (). Distributions such as Poisson , Gamma , lognormal  or even a combination of them , have been used to describe the process of DNA or viral vector delivery to cells. For transient lipofection of DNA, lognormal distributions approximate experimental data well, and therefore One of the genes and its protein product is assigned the role of, respectively, a reference gene and a reference protein (sometimes called “transfection marker”); let us assume it is , with gene product  and its log-transformed counterpart . Thus, by definition  = 1. To derive the conditional marginal (|), which is the probability to find the value  of the log-transformed protein  expression in a cell in which the log-transformed reference protein expression equals , we first drop irrelevant variables from  to evaluate joint probability distribution of log-transformed protein levels  given the underlying gene copy numbers : In turn the gene copy numbers are conditionally dependent on the multiplicity parameter : The global joint probability distribution () of  and  over all values of  is obtained by integrating over all values of : It is customary, as already done earlier , to bin cells that share the same , the log-transformed value of , because this is the only readout independent of the other components, as it is a self-contained gene expressed from a constitutive promoter. We follow this approach here: cells binned according to their  value will exhibit certain log-transformed distributions of the other proteins ,…,. Knowing the joint  (), one can derive the conditional probability of  given  (that is, the  of  among cells that express  log-transformed copies of the reference protein), as follows: The mode of this distribution, .., the most probable value of  given the reference , can be found by solving the equation Let us denote this most probable value as . The value of  can be determined experimentally as a mode of  distribution after binning the cells according to their  value. The equation may have more than one solution, corresponding to multimodal probability density function from . This bring us to the most relevant question of this section: What is the distribution of the gene copy number  for the cells that reside in the mode(s) of , and what is the most probable value of ? To answer this question, we evaluate the conditional probability (|) according to Bayes’ theorem: In order to find the most probable copy number  we solve the equation (or equations, when  takes more than one value) Knowing the most probable gene copy numbers in the cells residing in the modes of log-transformed protein distributions allows us to correlate the data to what might be obtained in cells with stably integrated constructs harboring similar gene copy numbers. Numerical analysis of transient co-transfection of constitutively expressed genes An analytical solution of  does not exist, and we solve it using numerical simulations. To this end, we performed  simulations of a transient co-transfection containing multiple ( = 5) independent genetic constructs (Methods). The change in protein expression over time, , of each gene  can be described by an ordinary differential equation (ODE) with kinetic parameter , gene copy number  and degradation rate In the steady state, i.e. , the steady-state level of  is proportional to  with the global coefficient of proportionality  and identical to : Iterating multiple times to simulate multiple single cells  (1≤≤, where  is the total number of simulated "cells"), we draw the multiplicity  from a lognormal distribution () with parameters that roughly fit experimental data (see below) and initialize gene copy number vectors

according to  with pre-set parameters (Methods). To create log-normal protein distributions given  according to , for each  in , local proportionality factor  is drawn from a log-normal distribution:

with fixed  values (Methods, ); the values of  are fixed for a given simulation run and systematically varied between 0.00 and 0.32 in different runs. A value

is the level of protein  in cell  (). The generated  dataset () is similar to a flow cytometry dataset what one would obtain in a transient co-transfection experiment of constitutively-driven genes. In order to confirm that the parameters, and in particular the values of  are realistic, we transiently co-transfected five plasmids, each expressing constitutively different fluorescent protein (: SBFP2, : Cerulean, : Citrine, : mCherry and : iRFP; Methods) (). We find that the standard deviation of the log-transformed protein expression distribution in cells pre-binned on similar values of the reference protein, which we denote *,

depends on , and indeed ranges between 0.1–0.3 (). Higher values of *are observed as very low  values, and they plateau towards 0.1 for larger . Accordingly, the range of  values used in the simulations, and given that <*, constitutes a realistic range for the gene expression variability due to "intrinsic noise". Next, we simulate transient co-transfections using two different gene ratios; (i) equimolar and (ii) a ratio of 1.0:1.3:0.8:0.5:0.4, the latter following some fine-tuning in a parallel experimental project (manuscript under preparation), to generate a joint  (Figs , , , ). We use these datasets to solve Eqs  and  numerically, that is, determine the  and . To do so, we bin cells that share a log-transformed reference protein value , evaluate the conditional (|) and, first, determine numerically the value of . Second, we retrospectively look up the values of  in cells whose  and  expression levels lie in the vicinity of a vector . The empirical distribution of  (Figs ,  and ) is  from , and the mode of the gene copy number distribution, , or , is determined numerically (Figs ,  and , Methods). According to  there is a simple, linear relation between  and the gene copy number , linking them via the global coefficient of proportionality . The global coefficient of proportionality can be determined experimentally using .., a calibrated Western blot to measure the absolute amount of protein and calibrated qPCR to measure absolute mean internalized gene copy numbers. For the transfection reference protein, we introduce the variable  that corresponds to the gene copy number that one would "naïvely" anticipate to be the most probable value leading to a particular , given : For the other log-transformed outputs  the naïvely anticipated copy number in cells that express certain level of the reference protein , is defined by a similar relationship: Given that the value of  and  are the only “knowable” parameters, it is of interest to ask how the actual copy numbers relate to these anticipated values. Using our simulated datasets, we compute the ratio between numerically found  and the anticipated copy number  from  () as a function of . We find that the deviation from the anticipated value is a decreasing monotonous function of  with the following properties: (1) The deviation is always positive for values of <ln ; (2) the deviation is essentially zero when  = ln , and (3) it is negative for >ln . Further, the absolute magnitude of the deviation increases with increasing  ( and  Figs). However, for all noise levels, the deviation is zero at the global mean of the  distribution, , and We further analyzed the ratio of the modes of gene copy number distributions  to  in cells that reside in the close vicinity of the log-transformed expression vector . The ratio stays constant for almost the entire range of  values (Figs ,  and ). Since the naïve estimate and the numerical mode of the absolute gene copy number coincide at the global mean of the , both the relative and the absolute abundance of the gene copy numbers can be deduced with high certainty in cells that express  around its global mean. This is true regardless of the chosen distribution of  and . Simulations that employ Poisson, Gamma or lognormal distributions show a strikingly similar effect (). Appropriate experimental techniques allow measuring both the protein copy number  and the gene copy  number in the cells residing at the global mean of , making it possible to determine the value of  experimentally and therefore extrapolate directly to the ground truth expected in the stable cell line with the similar gene copy number. 10.1371/journal.pcbi.1008389.g001 simulation of multiple gene co-transfections. simulations shown for two cases with parameter settings  = 0.08,  = 0.04 and  = 10: equimolar (:::: = 1.0: 1.0: 1.0: 1.0: 1.0; top row) and "nominal" (:::: = 1.0: 1.3: 0.8: 0.5: 0.4; bottom row) ratio of gene mix.  Density plots show the amount of expressed proteins  versus . Solid black lines indicate the edges of an example bin for the transfection reference protein .  The plots show the distribution of gene copy numbers in cells whose  values fall into the bin shown in panel A. Copy number distributions corresponding to different genes  are shown using different colors (legend on the very right of the figure). In the equimolar case, gene copy number distributions overlap, while in the "nominal" case they are separated.  The modes of the copy number distributions are plotted versus the median signal of the transfection reference protein  in all bins (colored lines). The dash-dotted line marks the mean () of the global  distribution.  For each bin of the transfection reference protein , the modes of the gene copy number distributions from each gene  are determined numerically. The ratio of the numerically-determined mode of the copy number distribution  and the anticipated copy number  are computed and plotted versus the corresponding  values in individual bins. The global mean of  is shown with a dash-dotted line.  Ratios of gene copy number modes  relative to the gene copy number mode of the transfection reference protein , as a function of the  median value in the bins. Numerical analysis of transient co-transfection of non-trivial gene circuits Next, we consider the case when the same genes, apart from the transfection reference protein gene , encode a set of genes interacting in a circuit. Depending on the circuit, log-transformed distribution  of protein  in cells pre-binned on the value of  may exhibit mono-, bi- or multimodality. We may consider the joint probability distribution of the vector of independent constitutive genes and their gene products, ∙, as a baseline state of any circuit. When the genes are interconnected (not including the reference gene  and its log-transformed product ), this baseline distribution is transformed because the values of  are no longer independent. However, the values of  remain the same, because they represent the exact same underlying process of DNA delivery, and only the  values change relative to the independent, constitutive values. We hypothesize that despite the fact that the values of  are no longer independent of  for ≠,  vectors corresponding to the (possible multiple) multivariate modes of |, would not deviate far from the  vectors obtained in the case of independent co-transfection. We further hypothesize that this deviation will decrease as the noise in the system increases to biologically-plausible levels. reinforced incoherent feed forward motif RIFFM To test these hypotheses, we simulated two three-node gene circuit architectures (currently being investigated experimentally in a related project, see  for the experimental results of the fan-out circuit); a simple monomodal  circuit (; ) and a non-trivial , also known as  [,,,] (). The input to the circuit is a transcriptional activator PIT2 , whose level is tuned by Doxycycline via an bi-directional TRE promoter that also drives a fluorescent protein mCherry as a proxy for input expression. The first PIT2 target promoter (P1) drives the .  derived transcriptional repressor Knirps () and translationally-linked fluorescent protein Cerulean, constituting the first circuit output. The second PIT2 target promoter (P2) drives the transcriptional repressor LacI fused to a KRAB domain and translationally linked to a fluorescent protein Citrine, representing the second circuit output. In  circuit,  is able to repress P2 while LacI is able to repress P1; in , the mutual repression is eliminated via mutations. We built mechanistic kinetic models of the circuits  and  ( "Simple Fan-Out Model" and  "Detailed Models") and simulated the flow cytometry dataset for multiple transiently transfected cells  (1≤≤, where  is the total number of simulated "cells"). As above, every gene is encoded on a separate plasmid. We also compared this to a single-plasmid setup with all five genes are located on a single DNA backbone, but saw only a marginal difference in outcomes (). The multiplicity of transfection and the gene copy numbers are simulated as above (); the gene copy numbers become the initial conditions for running a simulation. Differently from that case of constitutive co-transfection, we directly simulate circuit dynamics governed by kinetic parameters ; to simulate the effects of intrinsic gene expression noise, the parameters that govern protein translation rates are sampled independently from a lognormal distributions with nominal parameter values  and preset "noise" levels ranging, as above, from 0.00 to 0.32: For every cell , the drawn parameter values  are used in a dynamic simulation ran to a steady state, with the simulated steady state input and output protein levels corresponding to the readouts from that cell. First, we simulate mono- and bi-modal gene circuits for a single Doxycycline/input level. Similar to the data analysis above, we bin the cells according to  value. In the bin, we first focus on the input protein  and identify its mode. Importantly, in the general case the distribution of | can be bi-modal, leading to two numerically-found values  and . In this case, we consider separately the cells residing close to the expression vectors  and . Next, for every circuit output we consider the distributions  and . These distributions can also be multimodal; in what follows we assume they are bi-modal. We denote the modes of the output distribution corresponding to the high mode of the input  and , and use similar notation for the output modes corresponding to the low mode of the input, if the latter is present. Lastly, we consider all cells in the vicinity of the expression vector  and  and evaluate the copy number distribution of every circuit gene as well as the reference gene. These are monomodal distributions, with the modes denoted respectively as  and  (see  for schematic description of the process). These numerically evaluated values are then compared to the naively anticipated values calculated according to the . Note that in these simulations, the transfection reference gene expression is modelled explicitly as a transcription/translation/degradation cascade with corresponding kinetic parameters; the value of  for  is calculated according to Eqs  and . The analysis of the simulated data reveals the following: for the monomodal FO circuit, the behavior of the copy number modes of the input and the output genes is quantitatively identical to what is observed in the simulation of multiple constitutive gene co-transfection (). The bi-modal circuit () shows its bi-modal behavior at the lower intensities of the transfection reference protein  (10–10). In this range, distributions of gene copy numbers for the high and low modes of output expression are slightly diverging (Figs ). They are, however, almost fully overlapping, and their modes differ only by a few percent respectively upwards or downwards relative to the monomodal case, despite large difference in the corresponding protein modes. We quantify the divergence in gene copy number modes between high and low protein output modes by introducing a metric

with  being the mode of the transfection marker copy number distribution found in the constitutive co-transfection simulation (). We observe a steady increase in  upon an increase in noise level σ (), however, it is less that 10% for realistic levels of noise. Furthermore, we quantify bi-modality-dependent deviations of gene copy number ratios between the high and low output modes and introduce the metric Unlike , this deviation of gene copy number ratios, , decreases with an increase in the noise level  (). These observations confirm our hypothesis that even in multimodal circuits, the cells that share the same amount of the reference protein, also share very similar gene copy numbers, both in absolute and especially, in relative terms (– Figs). Moreover, deviations from the nominal gene copy number ratio decrease with the increase of noise levels . 10.1371/journal.pcbi.1008389.g002 Schematics of gene circuits FO and RIFFM and analysis outline. ()| Monomodal/fan-out (FO) and () bi-modal (RIFFM) gene circuit. The circuits are composed of five independent genes. Constitutively-expressed transcription factor rtTA co-induces PIT2 and the fluorescent protein mCherry in a Doxycycline-dependent fashion. PIT2 in turn activates two promoters P1 and P2, which express a transcriptional repressor lacI-KRAB and Kni, respectively, co-expressed via P2A linkers with Citrine and Cerulean fluorescent reporters. In the FO circuit the repressors do not interact due to mutated promoter binding sites, while in the RIFFM circuit they repress each other, establishing a mutual inhibition. () Graphical illustration of all steps to find the modes within our simulated data sets. The raw flow cytometry like data () is binned by the transfection marker (i.e. : SBFP2). The binned data is isolated and subsequent analysis is done only on this subset (). Afterwards the distribution of the log-transformed input signal (mCherry) within the binned subset is determined and at least one Gaussian is fitted to the distribution. A narrow bin(s) around the mode(s) (black arrows) of the fitted distribution(s) is determined (pink bars), thus obtaining a subset of the originally-binned dataset. The subset around the peaks ( and ) are now analyzed individually. For illustrative purposes, we show the input (mCherry) and output (Cerulean) signal of the subset around  () and  (). The modes of the log-transformed output distributions are identified using a similar peak finding procedure as for the input signal (mCherry). The output histograms and their modes (black arrows) are shown on the sides of plot. Within these modes, we look at the  of the gene copy number distributions for all circuit genes as well as the transfection reference gene and identify the vectors  and , respectively. 10.1371/journal.pcbi.1008389.g003 simulation of transiently-transfected gene circuits FO and RIFFM and the copy number analyses at various  noise levels. simulations (global parameters  = 0.08,  = 0.04,  = 1.4979,  = 1.2686 and :::: = 1.0: 1.3: 0.8: 0.5: 0.4) shown for two circuits:  monomodal/fan-out (FO) and  bi-modal (RIFFM).  Raw data of the simulated transiently transfected FO circuit. The amount of expressed proteins  (left: Cerulean) or  (right: Citrine) versus  (transfection marker: SBFP2) is shown as a density plot. Solid lines indicate the edges of a transfection marker bin.  Gene copy number distributions of cells binned by a particular value of log-transformed  in a bin shown in panel .  The modes of the copy number distributions, , are plotted versus the median signal of the transfection reference protein  for all bins (colored lines). The dash-dotted line marks the mean () of the global  distribution.  The ratio of the numerically-determined mode of the copy number distribution  and the anticipated copy number  plotted versus the  values in individual bins. The global mean of  is shown with a dash-dotted line.  Modes of the gene copy number distributions  normalized by the mode of the transfection reference gene  are shown as a function of  values in individual bins.  Raw data of the simulated RIFFM circuit with bi-modal output  (Cerulean; left) or  (Citrine; right). The black lines indicate a bin within the bimodal range.  The modes of the copy number distributions,  and , are plotted versus the median signal of the transfection reference protein  of all bins (colored lines). Dashed segments indicate the range of  in which the high and low modes do not coincide; the black dash-dotted line indicates the mean () of the global  distribution.  The ratios of the numerically-determined mode of the copy number distribution  and  and the anticipated copy number  are plotted versus the corresponding  values in individual bins. Dashed segments indicate the range of  in which the ratios corresponding to high and low modes do not coincide. The global mean of  is shown with a straight dash-dotted line.  Modes of the gene copy number distributions  and , normalized by the mode of the transfection reference gene  are shown as a function of  values in individual bins. Dashed lines indicate the range of  where the values do not coincide.  The ratios  depicted in panel  are shown in greater detail for the outputs  (Cerulean; top) and  (Citrine; bottom).  Fitted gene copy number distributions of the indicated bin in  are shown for all genes (left to right) and noise levels . Black curves indicate the fitted distributions to the low output mode, , and colored curves the fitted distributions of the high output mode .  Divergence in gene copy number modes  between high and low protein output modes normalized to the mode of copy number distribution of the transient co-transfection for all noise levels  as a function of  values in individual bins.  Difference of copy number modes’ ratios  in the high and low protein output modes for all noise levels  as a function of  values in individual bins. The rationale for extracting input/output relationship from transient transfection data The analyses above suggest a workflow for analyzing and deducing input/output relationships from transiently-transfected circuits. To summarize the findings so far, we show that cells, which express a certain level of reference protein  and reside at multivariate modes of log-transformed input and output expression, harbor both input and output genes (or plasmids) with the following properties: (1) even for multimodal outputs with large differences in protein level modes, the distribution of the input and output genes copy numbers corresponding to the different output protein modes are almost overlapping, with the copy number modes varying by about 10% for biologically-realistic noise values, and thus can be treated as the same copy number for all practical purposes; (2) the copy number distribution modes’ ratio almost exactly corresponds to the nominal ratio used in a transfection for all reference protein bin values, for both low and high output modes, and the deviation from the nominal ratio decreases with increased noise; (3) the distribution modes’ absolute values exactly match the naïve anticipation () when the reference protein is expressed at the level ; (4) the distribution modes’ absolute values (for both high and low output modes) deviate from the naïve expectation in a predictable linear fashion as a function of log-transformed reference protein level , with the magnitude of the deviation increasing with the overall noise level. However, because the actual noise level and thus the degree of deviation can be quantified experimentally, even in cells that lie away from  the copy numbers can be estimated not only in relative but also in absolute terms. We show that this holds for a case of a complex circuit that generates bi-modal output distribution, with only slight deviations of the copy number modes from the expectation. Accordingly, by analyzing the input and output values in the cells that reside in the multivariate modes of circuit inputs’ and outputs’ distributions (after binning by the log-transformed reference protein value ), we should be able to extract the information about the input/output response of the circuit that is comparable to the stable cell line harboring the circuit at the copy number derived from  according to  and corrected by the measure of deviation that depends on the noise level. Overview of the workflow validation procedure To validate the workflow suggested above, we simulate transient transfection and stable integration for  and  circuits for a wide range in circuit input levels using the exact same ODE model, with the input modulated via varying Dox level; otherwise the parameter randomization is performed as described above according to . To simulate a stable integration dataset, we initialize a copy number vector  such that the ratio between individual genes corresponds to the nominal ratio of the transient transfection, and the absolute copy number of the reference gene is set to different fixed values corresponding to the bins used for transient transfection data analysis (; Methods). After the datasets are simulated, we extract input/output relationships corresponding to various bins of log-transformed values of the (transfection) reference protein  from the simulated transient transfection data, as described in detail in the next section. This is compared to the results of the stable integration simulation performed for the copy numbers that correspond to those reference protein levels. The simulation of the stable integration scenario generates an input/output “cloud”, as has also been demonstrated experimentally [,,]. The cloud can be used "as is" for the purpose of comparison, or it can also be processed via output mode identification for different input levels and building averaged curves. The process is illustrated schematically in . The input/output relationship is generated for each level of log-transformed reference protein . We make use of the datasets simulated with different Doxycycline levels and thus different amounts of input expressed per gene copy. (Note that Doxycycline does not affect the gene copy number or the expression of the transfection reference protein, it is not a direct input and is not a part of the input/output relationships that we seek.) For a given  bin, a single transfection experiment simulation with a fixed Doxycycline value generates (for a bimodal case) at most four points on the input/output curve: ; ; ; and . In most cases, the input will only exhibit a single mode that we denote for uniformity  and thus only two points will be generated for a bi-modal case, and one for a monomodal case. For this same reference protein bin, we repeat the procedure defined earlier () for every Doxycycline level and generate multiple [; ] pairs that cover the entire input range. The procedure can be done for any desired reference protein bin, thus showing circuit behavior for different absolute gene copy number of its components (). The fact that every transient transfection performed with a certain Doxycycline level generates only up to four, and usually one or two, points on the input/output relationship curve is slightly counterintuitive because a flow cytometry plot would reveal wide distribution of the input values. However, this distribution results from the variability in the copy number of the input gene in the cells and is therefore irrelevant to the determination of the input/output relationship. In order to characterize an entire curve, there must be a practical way to modulate input expression per gene copy and repeat the experiment multiple times, every time with a different degree of modulation. This can be done with Doxycycline as in our case; when this is not feasible, one can mimic input modulation by systematically changing the relative dosage of a constitutive input-expressing gene, or use a series of constitutive promoters of varying strengths. In another observation, when extracting the modes, the high output modes corresponding to both the low and the high input modes fall on the same curve when plotted against the input values; the same is true for the low output modes (). This is not surprising, because the input value is the only determinant of the output. Therefore, we pool high and low output modes, respectively, and interpret them as the averaged input/output relationship of a circuit; when the behavior is bimodal, two curves are generated. 10.1371/journal.pcbi.1008389.g004 Peak Finder Algorithm For Flow cytometry (PFAFF) analysis strategy. The steps of finding peaks in distributions of a binned data as shown in  are repeated for every input induction level (i.e. Doxycycline level; here three representative cases for low (), medium () and high () input modulation levels are depicted) for each output (here, Cerulean and Citrine). Initially, a bin of the transfection reference protein (here, SBFP2) is determined and all downstream analyses only deals with cells residing in this bin. The plots in the dashed box show the example workflow of applying the peak finding to the individual input modulation levels. The density plots depict the binned data and the adjacent histograms show the distributions of their respective input and output proteins. Black wedges indicate the modes of the (convoluted) distributions and black markers indicate their location on the density plots. The [; ] mode pairs, identified in this workflow (markers), derived from the raw data corresponding to the different input modulation level are plotted on the input/output mapping charts the output Cerulean () and Citrine (). Validation using direct simulation data We applied our data generation tool for transient transfections to FO and RIFFM circuit architectures and simulated 500,000 cells at twelve different Doxycycline input concentrations and six noise levels of . In  we show representative examples of the raw data from transient circuit simulations at a single noise level ( = 0.16) and various Doxycyline modulations. Note the shift in the scatter plots in response to Doxycycline increase. For each noise level, we extract the corresponding input/output relations of the data set with our analysis strategy that we call eakinder nalysis or low cytometry, or PFAFF. The algorithm bins simulated cells according to the expression level of the transfection reference protein SBFP2 each bin containing an equal number of cells (9.5% of total population, 10 bins in total). Next, we determine the modes of log-transformed input and output protein distributions of cells residing in each bin for the different Doxycycline levels as described above, and build the input/output relationships corresponding to that bin (– Figs). In the stable integration scenario, we build datasets that correspond to different fixed sets of gene copy numbers. Specifically, the copy numbers are set to correspond to the median copy numbers of the bins used to process the simulated transient transfection data (Methods). We simulate 5,000 cells per Doxycycline value and repeat this for twelve different Doxycycline values to cover the entire input range. This simulation is repeated for each . These data serve as the gold standard to evaluate the performance of our method for transient transfection data processing, by how well the input/output relationships match the stable integration simulation for matching bin/stable copy number. In  we show the stable integration simulation and the analysis results from PFAFF, the latter extracted from a transfection reference bin that lies close to the global mean of the reference protein (i.e. SBFP2 bin 5; see – Figs for all bins, input and noise levels); the former simulated for the gene copy number that corresponds to this reference protein level. Note that the number of transfection reference bins does not influence the outcome (). We plot the stable integration outputs at various input levels as density plots in the background (grayscale). For the lowest noise case ( = 0.00), the density plots for the stable integration collapse to curves, as expected. Gradually increasing  leads to increasingly diffuse input/output relationships. Atop these density plots we superimpose the mode values extracted by PFAFF from the corresponding simulated transient transfection data and binned for the cells that express the same level of the transfection marker as the stable integration. The analysis suggests that the input/output relationship extracted using PFAFF superimposes with the input/output “cloud” simulated for the stable integration, when both reflect similar underlying absolute gene copy number. In order to expand the number of circuits for analyses, we simulated another commonly studied circuit family–the type-1 incoherent feed-forward motifs. Our simulations include two versions of the I1-FFL (one for each repressor; I1-FFL1 and I1-FFL2; ). We applied the same analyses as before to both I1-FFLs and show the comparison of input/output from stable integrated and transiently transfected circuits (; see – Figs for all bins, inputs and noise levels). As is the case for other two circuits, there is excellent correspondence between the input/output curves extracted from simulated transient transfection data, and the input/output behavior of the comparable simulated stable case. This motivated us to expand the number of circuits by a coherent feed-forward, a negative feedback and lastly a positive feedback motif; all of them showing similar, excellent agreement (– Figs). The initial qualitative analysis uncovers excellent overlap between the input/output relationships found by PFAFF, and the input/output clouds from the corresponding stable integration simulations. Only at the highest simulated levels of , i.e. 0.32, the PFAFF algorithm has minor difficulties with extracting expected input/output relationships. Indeed, a  of 0.32 is much larger than variations observed typically in nature . To obtain a quantitative measure of the correspondence, we extracted modes from the log-transformed protein expression distributions of input (mCherry) and outputs (Cerulean and Citrine) from the stable integration data sets with the same peak finder algorithm that we employ in PFAFF (Methods). We correlated the obtained modes with the modes that were found by PFAFF in the transient transfection case (). In the pooled modes from all data sets, meaning all external input levels and bins for each noise level, we find a high correlation between the modes from both simulation scenarios for all expression noise levels (mean of Pearson correlation coefficient >0.91±0.01 for output modes; : 0.00–0.32). 10.1371/journal.pcbi.1008389.g005 Results of PFAFF analysis on simulated FO and RIFFM flow cytometry data set. Raw simulated transient transfection data for circuits FO and RIFFM at noise level  = 0.16, modulated by different input levels of Doxycycline (columns). Each circuit (FO, RIFFM) is represented by two rows of charts depicting the input versus their respective output signals.  Simulated flow cytometry data set of the bin that lies at the transfection reference protein's global mean (transfection reference: SBFP2) at different gene expression noise levels  (columns) ranging from 0.00–0.32. The plots show the input/output curves extracted by PFAFF (colored crosses; top row: Cerulean, bottom row: Citrine) atop of the simulated stably integrated circuit at the indicated gene expression noise level  (grey density plot). FO undergoes an activation in both output colors. The RIFFM circuit shows a bi-modal behavior already at low noise levels for both output colors. 10.1371/journal.pcbi.1008389.g006 Results of PFAFF analysis on simulated I1-FFLs flow cytometry data sets. and  Circuit architecture of two additional I1-FFLs.  Simulated flow cytometry data set of the bin that lies at the transfection reference protein's global mean (transfection reference: SBFP2) at different gene expression noise levels  (columns) ranging from 0.00–0.32 is processed by PFAFF. The plots show the input/output curves extracted by PFAFF (colored crosses; top row: Cerulean, bottom row: Citrine) atop of the simulated stably integrated circuit at the indicated gene expression noise level  (grey density plot). Both I1-FFLs show adaptive behaviors in their respective outputs. 10.1371/journal.pcbi.1008389.g007 Quantitative analysis of the stable integration and transient transfection data sets. Correlation between extracted output modes of stable integration simulation and PFAFF results from transient transfection simulations. The mode values for both output colors (Cerulean and Citrine) for all input modulator levels and for all bins/stable copy number sets are plotted, and Pearson correlation coefficient ( or ) is shown for each plot. In this study we show that transient transfection data can be used to extract input/output relationships of gene circuits that are comparable to the data that would have been obtained with stably-integrated circuits. Our findings reveal that it is sufficient to focus on small subsets of transiently transfected cells that lie at multivariate modes of input and output expression, post-binning on a transfection reference protein, otherwise known as a "transfection marker". We prove numerically that cells in these modes harbor distributions of circuit genes with the following properties: (1) the modes’ absolute values can be deterministically deduced from the observed level of the transfection reference protein expression, the noise level in the experimental data, and the distance from the global mean of the transfection reference protein; (2) the modes’ ratios are identical to the gene or plasmid ratios used in the transient transfection experiments, for all values of the reference protein expression. Moreover, in the case of multimodal data, large differences in protein expression do not translate into significant differences between the underlying gene copy number distributions, and for all practical purposes the absolute and relative copy numbers can be considered identical for the different protein expression modes. Interestingly, the cells that belong to the bin that lies close to the global mean of the reference protein expression, harbor gene copy numbers whose modes' absolute  relative values correspond exactly to what one would expect from the naive expectation, namely the ratio between the knowable expressed protein level and the knowable global coefficient of proportionality between the protein and gene copy number. The detailed understanding of the gene copy number behavior in the multivariate protein expression modes that can be identified in the experimental data, provides a degree of confidence in relevance of extracted data to the ground truth behavior of the same circuit when stably integrated in a cell. This confidence is confirmed by the direct  validation experiments, where both types of data are directly simulated, the PFAFF workflow analysis is applied to the data from simulated transient transfections, and the results are compared to, and are shown to reproduce, the ground truth. While transient transfections are often valued as a tool to rapidly analyze genetic circuit behavior, they are rarely used to draw fine-tuned conclusions about the input/output relationship of corresponding stably integrated circuits, more so for multimodal circuits. This is likely due to various pitfalls in existing analysis methods, the most prominent being the insufficient treatment of multimodal systems and the lack of conclusive analysis of the underlying gene copy number distributions in identifiable cell populations. Our analysis strategy allows a thorough comparison of input/output relationships from both scenarios and results in an excellent agreement between them. This will play an important role in gene circuit design and characterization, as it alleviates the need to generate multiple stable cell lines. Standard cloning techniques were used to clone all plasmids. We used .  DH5a and DH10B as the cloning strains, cultured in LB Broth Miller Difco (BD; Cat. no. 244610) and Ampicillin (100ug/ml, Sigma-Aldrich; Cat. no. A0166-5G) as selection medium. All experiments were done with HEK 293 cells (Life Technologies) and were grown at 37°C, 5% CO in complete medium (DMEM (Thermo Fischer; Cat no. 11965092) supplemented with 10% fetal bovine serum (FBS; Sigma-Aldrich; Cat. no. F9665) and 1% Penicillin/Streptomycin (Sigma-Aldrich; Cat. no. P4333)). They were sub-cultured by seeding 10 cells into T75 flasks every 3–4 days. One day prior transfection, cells were passed through a 40um cell strainer (Falcon; Cat. No 352340) and counted with Bio Rad TC10. In each well (uncoated 6-well plates, Thermo Scientific Nunc; Cat. No. 2020–10) 300,000 cells were seeded and incubated for another 24 hours. On the day of transfection DNA was diluted in 250ul Opti-MEM I Reduced Serum (Gibco, Life Technologies Cat no. 31985–962) and mixed with a 244ul Opti-MEM I/6ul Lipofectamin 2000 Transfection Reagent (Thermo Fischer; Cat. no. 11668019). After a 20 minutes’ incubation step at room temperature, the transfection mix was added drop wise to the wells. The cells were incubated for another 72 hours before being measured by flow cytometry. All samples were measured with a BD LSR Fortessa cell analyzer. The medium was removed and cells were incubated with 300ul StemPro Accutase Cell Dissociation Reagent (Thermo Fischer; Cat. no. A1110501) at 37°C, 5% CO for 10 minutes. Reporter specific combinations were used to measure all four fluorescent proteins independently, but still providing a setup of little bleed over. In particular, we used for: SBFP2 a 405nm laser with 445/15, Cerulean 445nm laser with 473/10, Citrine 488nm laser with 542/27, mCherry 561nm laser with 610/20 and iRFP 640nm laser with 710/50 emission filter sets. We used the same PMTs (FSC: 350, SSC: 350, SBFP2: 220, Cerulean: 242, Citrine: 220, mCherry: 245, iRFP: 460) throughout all measurements and controlled for consistency of the instrument by using SPHERO RainBow Calibration particles (Cat no. 559123, BD). We experimentally co-transfected five different fluorescent protein genes (SBFP2 , Cerulean , Citrine , mCherry , iRFP ; ), individually driven by an Ef1a promoter and analyzed them via flow cytometry. The amount of transfected DNA (ng) was adjusted according to each plasmid’s size (nominal ratio: SBFP2: Cerulean: Citrine: mCherry: iRFP = 504: 634: 400: 239: 249). We collected more than 1,000,000 events and stringently gated the live population (~750,000 cells). This experiment created a five-dimensional distribution of fluorescent values. Fan-out gene circuit experiment We transfected five gene cassettes on individual plasmids as depicted in  into HEK293 cells and activated the circuit through the addition of Doxycycline at eight different input modulation levels (0nM, 0.90nM, 3.15nM, 0.01uM, 0.05uM, 0.13uM, 0.45uM and 1.35uM). After 72h post-transfection we analyzed the induced cells using flow cytometry and collected more than 1,000,000 events per replicate ( = 3). The obtained data were subjected to our analysis pipeline as outlined in section Data Analysis. We generated the model of multiple constitutively expressed genes using a steady state approximation (Eqs  and ). Once the gene copy number  and expression parameter  are determined, the protein output  is computed as described in . ODE circuit models were created with Simbiology, a MathWorks MATLAB 2018b package. Each molecular interaction was modeled according to the law of mass action ( "Detailed Models" and parameter values in ). This includes binding and unbinding of a transcription factor to inducible promoters, transcription of mRNAs and translation into proteins. All circuits have the same underlying interaction map. We created four different topologies by inactivating the translation reaction of the respective repressor mRNAs. Therefore, we generated  "knock outs" with minimal changes to the model. The vector of global proportionality coefficients  used in the simulation of constitutive gene co-transfection is a measure for the conversion of gene copy numbers to the number of proteins. In our circuit models, this coefficient is derived from expression and degradation rate constants. We adjusted the values of  according to the maximum expression levels of our circuit models to obtain similar and biologically feasible amounts (). In dynamic circuit models, binding/unbinding and transcription rates were either fitted from experimental data (Manuscript in preparation), literature values, or set arbitrarily at biologically feasible values. The translation rates  are based on previously-reported values  and were adjusted according to the length of each protein ( "Detailed Models"). In order to compute the values of anticipated gene copy numbers  from , we first have to determine the  values. This is done by removing the top and bottom 0.1 percentile from the  co-transfection and circuit simulations and binning the obtained data set into equally spaced bins (50 bins for co-transfection simulations; 25 bins for circuit simulations) according to the signal intensity of the transfection marker (). Since the  distribution within a bin is just a subset of the global  distribution, we use the median of the log-transformed  signal for each bin, which is then identified as  value. Together with the global proportionality coefficient  (see above) and the abundance parameter  we can compute  according to  for each bin of the respective data set. In-silico flow cytometry simulations Gene expression noise from lognormal distributions Within our  simulations, we introduce gene expression noise through the randomization of kinetic parameters. In the case of co-transfection simulations we randomize the vector of the proportionality coefficients  by drawing its individual values from a lognormal distribution , with the mean  being their coefficient of proportionality of the respective gene  () in log-space  and the standard deviation  being one of the six noise levels (0.00, 0.02, 0.04, 0.08, 0.16 or 0.32). In the case of circuit simulations, we introduce variability through the translation parameter vector . Likewise, it is drawn from a lognormal distribution  with the mean being set according to  in log-space  and the standard deviation being again one of the six noise levels. Gene expression noise from  distributions Gene expression noise is introduced by drawing individual values  of the proportionality coefficients from a  (gamma) distribution, (,). We chose the shape parameter  and the scaling parameter , so that the mean () and the variance of the distribution are the same as in the lognormal case. We simulated transient co-transfections at  = 0.08. Gene copy number/extrinsic noise We introduce extrinsic noise in our transient transfection simulations by drawing gene copy numbers  from a five-dimensional multivariate normal distribution . The mean of the distribution,  = , depends on the multiplicity parameter , which is drawn from a lognormal distribution ), and the abundance vector  (equimolar: :::: = 1.0: 1.0: 1.0: 1.0: 1.0 or nominal: :::: = 1.0: 1.3: 0.8: 0.5: 0.4). For our systematic comparison of gene copy number distributions (), we draw the multiplicity parameter  from a Poisson ((),  = 10) and  distribution ((,),  = 0.7436,  = 13.46), respectively. The covariance  = (()) is diagonal matrix and depends on the abundance , the multiplicity  and the constant factor  = 0.04. For every simulated cell, the multivariate distribution  changes along the lognormal distribution and in every iteration five gene copy numbers are drawn from it. The single-plasmid circuit contains all gene cassettes on a single entity. We achieve this by setting the constant factor  to zero. Consequently, the covariance matrix of the five-dimensional multivariate distributions  also turns zero. The remaining simulation is performed as described below in section “Gene circuit simulations”. We simulated our simple model independently 5×10 times (), randomizing both the parameters  and gene copy number , according to the description above. Each simulated run corresponds to a single cell and contains a randomized set of  and . We simulated the steady-state and the runs were stored in a single .-file that contained all information used to generate the data afterwards. This includes the individual parameters  and  for every cell as well as the output values. Thus, we obtained a data set that resembles a transient co-transfection experiment aided by the information of individual parameters. The simulations were performed in MATLAB 2018b. 1: program: Simulation Transient Co-transfection 2:    initialize abundance , constant factor  = 0.04 3:    for Noise-Level  in [0.00, 0.02, 0.04, 0.08, 0.16, 0.32] 5:            draw  from ,  = 1.4979 and  = 1.2686 6:            seed and draw  from 
 = ,  = (()) simulations of flow cytometry data for our circuits requires a mathematical model (ODE) generated by MATLAB’s Simbiology toolbox. The model was exported into the workspace and to decrease computational effort, we generated a SimFunction object. This function has five outputs: the number of fluorescent proteins (SBFP2, Cerulean, Citrine, mCherry) and transcription factor rtTA bound to Doxycycline at steady state (i.e. 1,500,000s). As the SimFunction’s input serves a matrix wherein each column represents the gene copy number (: pCS187, : pCS171, : pCS166, : pCS200, : pZ91), the Doxycycline level  ( = 12 logarithmically spaced values from 10–500,000 molecules) and eight translation parameters , each for every protein  produced. Sets of gene copy numbers  and gene expression noise variations  were drawn as described above. The simulation input, output as well as all parameters used for each cell are stored in a table and saved as.-files for documentation and further analysis. The simulations were performed in MATLAB 2018b. 1: program: Simulation Transient Circuits 2:    initialize abundance , constant factor  = 0.04 3:        for Noise-Level  in [0.00, 0.02, 0.04, 0.08, 0.16, 0.32] 4:            for Input-Level  in 1: 5:                for Cell  in 1: 6:                    draw  from ,  = 1.4979 and  = 1.2686 7:                    seed and draw  from 8:                    draw  from 9:                    initialize and simulate SimFunction-Model Determine copy numbers for stably integrated gene circuits We first simulated the transient transfection data set according to our initial parameters, which we drew from previous experiences. After binning the data set according to the protein output from our transfection marker , we determined the mode of the gene copy number  within each bin. The other values are derived from  according to their abundance coefficients. These values serve as the gene copy number for stably integrated gene circuits. Pre-processing of experimental flow cytometry data Retrieved data from BD LSR Fortessa was recorded with BD FACS Diva Software. The resulting files were exported in . format and loaded into FlowJo software . There, compensation of individual fluorescent channels was performed, live population gated and exported as scaled values into .-files. Scaled FACS values were transformed into bi-exponential space when needed via formulas from Parks et al.  with parameters  = 4.5,  = 2,  = 262144 and  = 0.401: Gene copy number distributions  in output peaks After binning the data set according to the transfection marker (50 bins in case of the co-transfection simulations, 25 bins in case of the circuit simulations), we fit Gaussians to the log-transformed values. We slice a window of ±0.15 log units around the mode(s) of the fitted distribution. Within this narrow window, we repeat the process for the remaining genes (co-transfection case: 1. Cerulean, 2. Citrine, 3. mCherry, 4. iRFP; circuit case: 1. mCherry, 2. Cerulean or Citrine). Since all parameters needed for the simulations are stored in an array, we can select all cells within that final slice and look up the gene copy numbers that were used to generate this subset of output data. The distributions of the gene copy numbers are then processed to discover their modes. Peak Finder Algorithm for Flow cytometry (PFAFF) https://github.com/benensonlab/PFAFF https://github.com/benensonlab/PFAFF The software is available on GitHub (). The repository contains the code, detailed  "PFAFF User Manual",  "Description of the example data set" and sample simulated data for running the analysis. User-provided data can also be analyzed according to the steps described in User Manual. The algorithm’s procedure starts by discarding the tails of the transfection control’s distribution. Within this window (i.e. 2.5–97.5% of transfection control fluorescence intensity) the distribution is segmented into bins of equal number of events (i.e. ten bins). Each bin is analyzed sequentially and all values are transformed bi-exponentially. The input distribution (i.e. mCherry) is approximated by a histogram in bi-exponential space and Gaussians are fitted to it. A following set of rules determines the number of fitted Gaussians: 1:  Fit Gaussians to mCherry Distribution 2:         Goodness-of-Fit for one Gaussian  0.975 7:           Goodness-of-Fit for two Gaussians  0.99 10:          fit three Gaussians 11:           distance between two peaks  0.42 12:          go back to use two Gaussian fit 14:           distance (mean closest-modes) to (two-Gaussian-Fit modes) < 0.3 15:           two-Gaussian-Fit mode and remaining three-Gaussian-Fit mode 19:           distance between the two modes  0.75 20:          go back to use one Gaussian fit A window of ±0.1 bi-exponential units is sliced around the peaks’ center. Within that subset of cells, distributions of the output colors (i.e. Cerulean and Citrine) are again approximated by histograms. Much like before a set of rules determines the number of Gaussians that are fitted to these distributions: 1:  Fit Gaussians to Cerulean or Citrine Distribution 2:         Goodness-of-Fit for one Gaussian  0.975 7:           Goodness-of-Fit for two Gaussians  0.995 10:          fit three Gaussians 11:           distance between peaks with highest intensities  0.9 12:          remove remaining peak from the data set 13:          fit one Gaussian for the highest peak 14:           Goodness-of-Fit  = Goodness-of-Fit for two Gaussians 17:           mode values of two Gaussian-Fit 19:           distance between the two modes  0.75 20:          go back to use one Gaussian fit For each bin, we repeat this fitting procedure. All extracted modes are re-transformed into flow cytometry units and stored in a table. The output of this algorithm is saved as MATLAB workspaces, that contain variables for generating (weighted) input/output mappings. Furthermore, various plots are generated (density plots of (raw) data, individual fits to data distributions, weighted input/output mappings and weighted mean input/output mappings) and saved as individual files in the result folder (see provided manual for details). Click here for additional data file. Click here for additional data file. Click here for additional data file. Click here for additional data file. Description of the example data set. Click here for additional data file. Click here for additional data file. Co-transfection experiment and in silico simulations. Click here for additional data file. In-silico simulations of a transient co-transfection with equimolar plasmid ratio. Click here for additional data file. In-silico simulations of a transient co-transfection with nominal plasmid ratio. Click here for additional data file. In-silico simulation of transient co-transfections at various initial gene copy number and parameter distributions. Click here for additional data file. PFAFF applied to experimental data of a FO circuit. Click here for additional data file. Comparison of multi-plasmid and single-plasmid gene circuits. Click here for additional data file. In-silico simulations of a transiently transfected monomodal circuit. Click here for additional data file. In-silico simulations of a transiently transfected bi-modal circuit. Click here for additional data file. Gene copy number ratios from the simulations of transiently transfected bi-modal circuit. Click here for additional data file. In silico simulations of stable integrations and transient transfections. Click here for additional data file. Workflow for simulation and analysis of genetic circuits. Click here for additional data file. Concatenation of high and low input and output modes. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (RIFFM and FO) at intrinsic noise level 0.00. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (RIFFM and FO) at intrinsic noise level 0.02. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (RIFFM and FO) at intrinsic noise level 0.04. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (RIFFM and FO) at intrinsic noise level 0.08. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (RIFFM and FO) at intrinsic noise level 0.16. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (RIFFM and FO) at intrinsic noise level 0.32. Click here for additional data file. PFAFF output for various bin numbers. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (I1-FFL1 and I1-FFL2) at intrinsic noise level 0.00. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (I1-FFL1 and I1-FFL2) at intrinsic noise level 0.02. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (I1-FFL1 and I1-FFL2) at intrinsic noise level 0.04. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (I1-FFL1 and I1-FFL2) at intrinsic noise level 0.08. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (I1-FFL1 and I1-FFL2) at intrinsic noise level 0.16. Click here for additional data file. In-silico simulation of stably integrated and transiently transfected (PFAFF input/output) circuits (I1-FFL1 and I1-FFL2) at intrinsic noise level 0.32. Click here for additional data file. Results of PFAFF analysis on simulated cFFL flow cytometry data sets. Click here for additional data file. Results of PFAFF analysis on simulated negFB flow cytometry data sets. Click here for additional data file. Results of PFAFF analysis on simulated posFB flow cytometry data sets. Click here for additional data file. Maps of plasmids used in co-transfection experiment. Click here for additional data file. (Quasi) steady states of a fan-out circuit at different protein degradation rates. Click here for additional data file. Model parameter values for co-transfection simulations. Click here for additional data file. Model parameter values for tested circuit architectures (RIFFM, I1-FFL1/2, FO, cFFL, negFB, posFB). Click here for additional data file. Click here for additional data file. Click here for additional data file. Model parameter values for simple fan-out circuit. Click here for additional data file..