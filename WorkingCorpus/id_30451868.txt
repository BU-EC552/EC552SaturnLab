Synthetic biology approaches in mammalian cells have rapidly progressed in a variety of fields, suggesting great potential in medical applications including drug discovery, vaccine production, disease diagnosis, and cell therapy. For example, researchers have designed several synthetic circuits that interface with endogenous gene networks to control apoptosis, differentiation, cell proliferation, and cell–cell communication. For future therapeutic applications, it is important to improve the safety and specificity of the circuits, especially for the purpose of cell therapy in the field of regenerative medicine. A delivery method using modified messenger RNAs (modRNAs) could provide safer means to control gene expressions compared with DNA delivery, because modRNAs exhibit a short half-life in cells and do not cause random genomic integration. To reduce off-target effects in non-target cells, it is important to produce desired outputs dependent on the cell state. One strategy is to design systems that determine the output of the circuits by sensing cell-specific, intracellular molecules as inputs. MicroRNAs (miRNAs) are a class of small noncoding RNAs that post-transcriptionally regulate gene expression by binding to target mRNAs. It has been reported that more than 2600 different miRNAs exist in humans (miRBase ver.22). The miRNA expression profile is related to important biological processes, including development, cancer, and cell reprogramming, and thus can be used to classify the cell state. These properties suggest that miRNA-responsive, synthetic circuits could provide useful tools for future therapeutic applications. We have previously designed miRNA-responsive, synthetic mRNAs (miRNA switches) that enable the detection and purification of target cells differentiated from human pluripotent stem cells based on endogenous miRNA activity. However, the information from a single miRNA input may be insufficent to distinguish cells in a heterogeneous population. In these cases, it is crucial to detect multiple miRNA inputs and logically control the outputs (e.g. cell fate). Although synthetic circuits using modRNAs that encode RNA binding proteins (RBPs) have been constructed in mammalian cells, complex synthetic RNA-delivered circuits that can detect multiple miRNAs and regulate output protein through logic computation have not been demonstrated. Thus, we aimed to design synthetic RNA-delivered logic circuits that function in mammalian cells by improving the performance of miRNA- and protein-responsive modRNAs. Schematic representation of the miRNA-responsive circuit and its topology.  Logic circuits can be constructed to detect cell-specific multiple miRNAs as input and translate genes ( or  in this study) as output only in target cells.  In OFF state (absence of input miRNAs), L7Ae protein represses translation of the output gene-coding mRNAs by interacting with the kink-turn motif (Kt). In ON state (presence of input miRNAs), the L7Ae translation is repressed by the miRNAs, which leads to output translation In this study, we construct a set of RNA-based logic circuits with RBPs that detect multiple miRNA inputs and regulate the output protein expression (Fig. ). We create five logic gates (AND, OR, NAND, NOR, and XOR) in mammalian cells using an RNA-only delivery approach. A 3-input AND circuit produces the output protein only in the presence of all target miRNAs. Additionally, we selectively control cell-death pathways between target and non-target cells by connecting a 2-input AND gate with apoptotic regulatory circuits. Improving the performance of miRNA-responsive circuits Engineering of L7Ae-mediated miR-21 circuits.  Schematic representation of engineered L7Ae-mediated, miR-21-responsive circuits with miRNA target sites within the 5′- and 3′-UTR. ,  The bar charts represent the gene translation output (EGFP/iRFP670) for each circuit in 293FT cells () and in HeLa cells (). -axis represents the mean EGFP per mean iRFP670 signal (EGFP/iRFP670). The output levels in OFF states of the standard circuit were normalized to 1. ON states in 293FT cells show the cells co-transfected with each circuit and miR-21 mimic (8 nM) (). miR-21 inhibitor (8 nM) was used to generate OFF states in HeLa cells (). Data are represented as the mean ± s.d. ( = 3). ,  Representative scatter plots and histograms for each circuit in 293FT cells (miR-21 mimic 0 or 8 nM) () and in HeLa cells (miR-21 inhibitor 0 nM or 8 nM) (). Gates shown on the plots were generated by negative control (non-transfected) cells. ON state and OFF state (red and blue) show the results in the presence and absence of input miRNAs, respectively.  Dose–response curves of the engineered L7Ae-mediated miRNA circuits with miR-21 mimics ranging from 0 to 8 nM in 293FT cells. The EGFP/iRFP670 ratio in each circuit without miR-21 mimic was set to 1. Data are shown as the mean ± s.d. ( = 3). The levels of significance (unpaired two-tailed Student’s -test) are denoted as ** < 0.01 and *** < 0.001. a.u. arbitrary units, iRFP near-infrared red fluorescent protein. Transfection details are described in Supplementary Table RBPs can function as both the input and the output of RNA-based regulatory devices. For example, L7Ae, a kink-turn (Kt) RNA binding protein, associates with the Kt of archaeal box C/D sRNAs. An L7Ae-Kt interaction at the 5′-UTR efficiently inhibits translation of the mRNA (Supplementary Figure ), probably by blocking translation initiation and ribosome function. We have previously used the L7Ae-Kt interaction to construct modRNA-based regulatory devices that detect one target miRNA and regulate the production of one output protein. The circuit topology of this device consists of two types of modRNAs (Fig. ); one is an -coding mRNA with four miRNA target sites that are completely complementary to the mature miRNA within the 3′ untranslated region (3′-UTR), and the other is an output-gene-coding mRNA with a Kt motif within the 5′-UTR. We refer to this device as L7-4xTX, where 4x represents the number of miRNA target sites, TX represents target sites to the specific miRNA, and the position of TX in the device name represents the location of the target site in the device (i.e., 5′-UTR or 3′-UTR). In the absence of the input miRNAs, the circuit produces no output protein due to L7Ae expression (OFF state), but produces the output protein in the presence of the input (ON state). However, the fold-change of the designed circuit between ON state and OFF state was moderate. As a first step toward realizing robust logic circuits with modRNAs, we aimed to improve the fold-change (ON/OFF ratio in output level) by enhancing sensitivity to the input miRNAs and reducing leaky protein expression, which would lead to a higher output expression level in ON state. We found that the knockdown effect of miRNAs on the miRNA switch is high when the target site (antisense sequence of the miRNA) was inserted into the 5′-UTR (Supplementary Figure ). Thus, we hypothesized that the insertion of a miRNA target site into both the 5′-UTR and 3′-UTR may have a stronger effect than insertion in only one UTR and thus improve the fold-change between ON state and OFF state (Fig. ). Accordingly, we constructed -coding modRNAs with miRNA target sites within both the 5′-UTR and 3′-UTR, and -coding reporter modRNA with a Kt motif within the 5′-UTR. We tested the performance of this miR-21-responsive RNA device by co-transfecting it with miR-21 mimic (chemically modified RNA that mimics endogenous miRNA) into 293FT cells. -coding modRNAs without the miRNA target sites were also introduced as a transfection control. In this study, we chose miR-21 along with miR-302a as representative miRNA markers, because they are highly expressed in several human cancer cells and pluripotent stem cells, respectively. We expected that the EGFP expression level would increase in a miR-21 mimic-dependent manner because 293FT cells do not express endogenous miR-21. We used 8 nM miR-21 mimic because the proportional activity of 8 nM miR-21 mimic in 293FT cells (up to 15.3-fold, Supplementary Figure ) is almost equal to that of endogenous miR-21 in HeLa cells (up to 15.8-fold, Supplementary Figure ), indicating that 8 nM miR-21 mimic reflects naturally occurring miRNA activity. Twenty-four hours after the transfection, we observed the circuit performance by flow cytometry analysis. We found that circuits with the device that contained miRNA target sites within both 5′-UTR and 3′-UTR (T21-L7-4xT21) showed the highest fold-change (9.2-fold) compared with standard circuits containing miRNA target sites only within the 3′-UTR (L7-4xT21, 2.7-fold) or within the 5′-UTR (T21-L7, 5.2-fold) (Fig. ). The circuit with T21-L7-4xT21 modRNA was much more effective at distinguishing cell populations in ON and OFF states compared with the other modRNA devices (Fig. ). To investigate whether the T21-L7-4xT21 circuit can detect endogenous miRNAs, we transfected it into HeLa cells, which express endogenous miR-21. The increased fold-change and cell separation between ON and OFF (with 8 nM miR-21 inhibitor) states with the T21-L7-4xT21 circuit was confirmed in HeLa cells (from 1.1- to 3.1-fold) (Fig. ). In addition, we used the T302a-L7-4xT302a circuit to detect another type of miRNA (miR-302a). We confirmed a significant fold-change between ON and OFF states (from 4.6 to 9.0-fold) in 293FT cells (Supplementary Figure ). The results were consistent with those for miR-21 (Fig. ), confirming that the improvement of the circuit performance by using modRNAs that contain the miRNA target site within both 5′- and 3′-UTR is independent of the miRNA sequence or cell line. Construction of logic circuits using modRNA-delivered device 2-input miRNA-responsive logic circuits. Different colors correspond to those in the truth table, scatter plot and output level columns, respectively. MiR-21 and miR-302a mimics were used as inputs. For example, input pattern [10] colored in light blue means miR-21 present (8 nM) and miR-302a absent (0 nM). The scatter plot column shows the overlay of scatter plots for four input patterns in each circuit. The output level was calculated by dividing the mean EGFP signal by the mean iRFP670 signal. The ratio (EGFP/iRFP670) was normalized by the ratio corresponding to a representative OFF state for each circuit. Data are shown as the mean ± s.d. ( = 3). Tukey’s multiple comparisons test results are shown in Supplementary Table Next, we constructed a modRNA-deliverable set of logic circuits that can sense the activities of multiple miRNAs to regulate output protein production. First, we designed a 2-input (miR-21 and miR-302a) AND circuit with EGFP as the output (first row in Fig. ). The AND circuit expresses the output only in the presence of both miRNAs (input pattern [11] in the truth table of Fig. ). The circuit consists of miR-21- or miR-302a-responsive -coding mRNAs, and -coding mRNA with a Kt motif (Kt-EGFP). We tested the performance of the circuit in 293FT cells, which have no activity for either miRNA, thereby enabling examination of the conditional four input patterns (denoted as [00], [10], [01], and [11]) by treatment with miR-21 (302a) mimics. As expected, the AND circuit functioned only in the presence of both miRNAs (Fig.  and Supplementary Figure ). Because L7Ae efficiently represses translation of Kt-EGFP mRNA (Supplementary Figure ), we found that the presence of either -coding mRNA was sufficient to repress EGFP expression. The fold-change was calculated by dividing the averaged output levels in each ON state ([11] for AND gates) by that in each OFF state ([00], [10] and [01] for AND gates) and found it to be 7.1-fold (Fig. ). We next designed an OR circuit (second row in Fig. ), which expresses the output when either one or both inputs are present (ON state = [10], [01], or [11]). This circuit consists of miR-21- and/or miR-302a-responsive single mRNA and -coding mRNA with a Kt motif. The designed OR circuit functioned with a fold-change of 5.4 (Fig. ). To generate more complex circuits, we next used a bacteriophage MS2 coat protein, MS2CP, as a second translational repressor protein in addition to L7Ae. First, we improved the response of MS2CP-responsive mRNA by engineering the surrounding sequence containing the binding motif (MS2). The sc2xMS2 motif-inserted mRNA, which consists of two MS2 motifs and a scaffold structure to stabilize the MS2CP-binding motif, showed the highest fold-change (14.7-fold) compared with that of other MS2CP-responsive mRNAs, which had one (1.85-fold, 1xMS2) or two (2.8-fold, 2xMS2) MS2 motifs inserted into the 5′-UTR (Supplementary Figure ). From this inclusion, we designed NAND, NOR, and XOR circuits (Fig. ) by connecting L7Ae- and MS2CP-responsive mRNAs. NAND (Not AND) and NOR (Not OR) circuits can be designed by inverting the output of AND and OR circuits, respectively. We used -coding mRNAs with a Kt motif (Kt-MS2CP) and -coding mRNA with two MS2CP binding motifs within the 5′-UTR (sc2xMS2-EGFP) as a second repressor device. The NAND circuit should produce no output only if both input miRNAs are present ([11]). The NOR circuit should produce outputs only when both inputs are absent ([00]). The XOR (eXclusive OR) circuit produces outputs only when exactly one input miRNA is present ([10] or [01]). Our NAND, NOR, and XOR circuits worked as expected, with fold-changes of 3.1, 3.5, and 5.5, respectively (Fig. ). From these results, we confirmed all the designed basic circuits (AND, OR, NAND, NOR, XOR) worked in mammalian cells using a modRNA-delivery approach (Fig.  and Supplementary Figure ). 3-input AND circuit.  The circuit recognizes the activity of three types of miRNAs (miR-21, miR-302a, and miR-206) and produces high output (EGFP) only when all three miRNAs are present ([111] state). The circuit design is shown in .  The bar chart represents the output level (EGFP/iRFP670) for each state in 293FT cells. Data are shown as the mean ± s.d. ( = 3). Tukey’s multiple comparisons test results are shown in Supplementary Table In addition, we designed a 3-input AND circuit using miR-21-, miR-302a-, and miR-206-responsive, -coding mRNAs with Kt-EGFP mRNAs (Fig. ). As expected, the circuit produced output EGFP production only in the presence of all three miRNAs, with a fold-change of 4.4 (Fig.  and Supplementary Figure ). Apoptosis regulatory 2-input AND circuit Apoptosis regulatory 2-input AND circuit.  The circuit has a pro-apoptotic gene, , as the output. The anti-apoptotic gene  was fused with the  gene through P2A peptides to enhance the repression of apoptosis.  The truth table in the circuit is shown. For example, input pattern [10] means miR-206 present (=8 nM) and miR-302a absent (=0 nM). The circuit induces apoptosis (cell death) as output only when both miRNAs are present (=[11] state).  Cells were stained with SYTOX red for dead cell staining and Annexin V for apoptotic cell staining 24 h after the transfection. Data are represented as the mean ± s.d. ( = 3). Tukey’s multiple comparisons test results are shown in Supplementary Table .  Representative flow cytometry data of apoptosis regulatory AND circuits. The positive rate of SYTOX red was calculated by the sum of the percentage of the Q1 and Q2 fraction. The positive rate of Annexin V was calculated by the sum of the percentage of the Q2 and Q3 fraction Finally, we validated whether RNA-based circuits can control cell-death signals through a logic operation. We designed a 2-input (miR-206 and miR-302a) AND circuit with human , a pro-apoptotic gene, as the endpoint output. In addition, , an anti-apoptotic gene was fused with  through P2A peptides to reinforce the repression of apoptosis against leaky hBax expression in OFF states (Fig. ). In this design, we expected that the circuits should kill cells only in the presence of both target miRNAs ([11] state). We co-transfected the circuits with miR-206 and/or miR-302a mimics into 293FT cells. Twenty-four hours after the transfection, we stained the cells with SYTOX red for dead cells and Annexin V for apoptotic cells to quantitatively assess the apoptosis level. The circuits induced apoptosis only when both input miRNAs were present. The apoptosis level in ON state was comparable to  mRNA transfection (Fig. ). Thus, our apoptosis regulatory 2-input AND circuit can selectively regulate cell death by sensing two target miRNAs. In this study, we designed and constructed multi-input logic circuits that can distinguish differences in the activities of multiple miRNA in a cell with an RNA-only delivery approach. We found that several basic logic circuits (AND, OR, NAND, NOR and XOR gates) can be constructed with a set of RBPs and mRNAs without the requirement of DNA-based transcriptional regulation by improving the performance of RNA regulatory devices (Figs.  and ). To quantitatively evaluate the performance of each circuit, we calculated the cosine similarity and net fold-change (Supplementary Figure ). Cosine similarity is an index for evaluating the error between the ideal implementation and observed behavior in a circuit (see Analysis of cosine similarity and net fold-change in Methods). The net fold-change was defined as the ratio of the averaged output level in ON and OFF states. From the analyses, AND and OR circuits showed better performance in net fold-change and cosine similarity, respectively, compared with NAND and NOR circuits (Supplementary Figure ), which we attribute to circuit complexity. All of the circuits showed statistically significant performance (Supplementary Tables , , and ). Although DNA-based circuits have great potential for applications such as designer cells (e.g., CAR-T cells), RNA-delivered circuits have an advantage in terms of safety, which makes them preferable for therapeutic applications in the field of regenerative medicine, such as the elimination of unwanted cells and purification of target cells from a heterogenous population differentiated from human pluripotent stem cells. MicroRNA-responsive circuits will be especially useful, because miRNA expressions are signatures of the cell identity and cell state. However, to date, most studies using synthetic circuits have required a DNA delivery method. We and others have developed synthetic RNA-delivered, miRNA-responsive circuits. To control cell fate more precisely, multi-input circuits with logic computation is necessary, as demonstrated in DNA-based systems. However, the construction of logic circuits in cells with RNA-only delivery has not been achieved previously, because previous RNA-based circuits show relatively low fold-change (ON/OFF ratio in outputs) and have a limited repertoire of devices with high repression capacity. By improving sensitivity to the input miRNA (Fig. ) and engineering a repressor device (MS2CP-responsive mRNA) to increase the ON/OFF ratio (Supplementary Figure ), here we report five kinds of 2-input basic logic circuits compatible with RNA-only delivery. These basic logic circuits which are composed of simple two types of repressor (miRNA- and protein-responsive mRNAs) are an important milestone toward the construction of scalable and more complex RNA-only circuits. To further engineer and improve synthetic RNA-based circuits that can respond to multiple miRNA targets, three issues regarding the circuit design should be considered. First, to increase the fold-change between ON and OFF states, we need to reduce undesired leakiness in the protein expression prior to miRNA-mediated post-transcriptional repression. For this purpose, the circuit may benefit by adding a post-translational system that controls the stability of the output protein products (such as the degron system). As an alternative approach, the insertion of multiple miRNA target sites into the 5′-UTR of the sensor mRNAs may enhance the miRNA sensitivity and circuit performance. Although we do not know the reason why the insertion of a miRNA target site into the 5′-UTR and 3′-UTR together results in enhanced downregulation of the target mRNAs, we assume that each designed miRNA target site is completely complementary to the miRNA of interest, which would thus induce AGO2-mediated mRNA cleavage. Second, to perform more complexed logic computation in cells, we need to scale-up the RNA-based circuits by using a set of orthogonal RBPs. Currently, the limited availability of translational repressors, such as L7Ae or MS2CP, makes it difficult to design more complex circuits. Finding new RBP-mediated repressors, such as CRISPR-Cas effector Cas13, may expand the repertoire of RNA-based circuits. Lastly, it is important to choose appropriate input miRNAs in order to detect and control the target cells in a heterogenous population. For this purpose, we need to measure not only the expression profiles, but the activity profiles of the miRNAs, because many miRNAs detected by RNA sequencing or microarray have weak or little activity according to reporter analyses. In conclusion, we have developed a framework for constructing basic logic circuits with RNA-only delivery, expanding the potential of RNA-based gene circuits to detect and control the cell state. We demonstrated that 2-input AND circuit with an apoptotic gene as the output regulated cell death according to differences in the two miRNA activities. Such a multi-input system enables us to purify target cells or control cell fate more precisely compared with a single miRNA-input system. Synthetic mRNA-based, multi-input miRNA-responsive circuits will contribute to the development of more sophisticated circuits for future medical applications. 293FT cells (Invitrogen, USA) were cultured in DMEM high glucose (Nacalai Tesque, Japan) supplemented with 10% FBS (JBS, Japan), 0.1 mM MEM non-essential amino acids (Life Technologies, USA), 2 mM -glutamine (Life Technologies) and 1 mM sodium pyruvate (Nacalai Tesque). HeLa CCL2 cells (ATCC) were cultured in DMEM High Glucose (Nacalai Tesque) supplemented with 10% FBS (JBS). All cell lines were cultured at 37 °C with 5% CO. All transfections were performed in 24-well format using Stemfect RNA Transfection Reagent Kit (Stemgent, USA) or Lipofectamine® MessengerMAX (Thermo Fisher scientific, USA) according to the manufacturer’s protocol. Opti-MEM (Thermo Fisher scientific) was used as buffer for MessengaerMAX. The MessengerMAX reagent and buffer were mixed for 10 min. The mRNAs with or without miRNA mimics or miRNA inhibitors diluted with buffer were mixed with the above reagent for 5 min. 293FT cells (1 × 10 cells per well) and HeLa cells (5 × 10 cells per well) were seeded in 24-well plates at 24 h before the transfection for all experiments. The medium was not changed before and after the transfection. All subsequent assays were performed 24 h after the transfection. The transfection details for each experiment are shown in Supplementary Table . Preparation of DNA template for in vitro transcription (IVT) A DNA template for IVT was generated by PCR using KOD-Plus-Neo (TOYOBO, Japan). A forward primer containing the T7 promoter and a reverse primer containing 120-nucleotide-long poly(T) tract transcribed into a poly(A) tail were used. PCR products amplified from the plasmids were subjected to digestion by DpnI restriction enzyme (TOYOBO). The PCR products were purified using a MinElute PCR purification Kit (QIAGEN, UK) according to the manufacturer’s protocol. All mRNAs were generated using the above PCR products and MEGAscript T7 Kit (Ambion, USA). In the reaction, pseudouridine-5′-triphosphate and 5-methylcytidine-5′-triphosphate (TriLink BioTechnologies, USA) were used instead of uridine triphosphate and cytosine triphosphate, respectively. For IVT of the MS2CP-responsive mRNA used in Fig. , N1-methylpseudouridine-5′-triphosphate (m1pU) (TriLink BioTechnologies) was used instead of uridine-5′-triphosphate. Guanosine-5′-triphosphate was 5-fold diluted with an anti-reverse cap analog (TriLink BioTechnologies) before the IVT reaction. Reaction mixtures were incubated at 37°C for up to 6 h and then mixed with TURBO DNase (Ambion), and further incubated at 37°C for 30 min to remove the template DNA. The resulting mRNAs were purified using a FavorPrep Blood/Cultured Cells total RNA extraction column (Favorgen Biotech, Taiwan), incubated with Antarctic Phosphatase (New England Biolabs) at 37 °C for 30 min, and then purified again using an RNeasy MinElute Cleanup Kit (QIAGEN). Synthetic miRNA mimics and inhibitors MiRNA mimics are small, chemically modified double-stranded RNAs that mimic endogenous miRNAs. The RNA mimic of human miR-21-5p, miR-302a-5p and miR-206 and negative control miRNA were used (Thermo Fisher Scientific). The negative control mimic is a random sequence validated not to have any downstream mRNA target for repression. MiRNA inhibitors for miR-21-5p (Thermo Fisher Scientific) were used in experiments using HeLa cells. Fluorescent images were taken at 24 h after the transfection by IX81 microscopy connected to a CDD-camera (Olympus, Japan). Images were edited to change the brightness and contrast using ImageJ software (NIH, Bethesda, MD, USA). Flow cytometry and data analysis All flow cytometry measurements were performed 24 h after the transfection using BD Accuri™ C6 (BD Biosciences, USA). For all fluorescence assays, clumps and doublets were excluded based on forward and side scatter. EGFP and iRFP670 were detected by FL1 (533/30 nm) and FL4 (675/25 nm) filters, respectively. The data were analyzed using FlowJo 7.6.5 software. 41467_2018_7181_Article_Equ1.gif The output level was calculated by the following formula:iRFP670 gating was determined from the mock sample with 99.9% cells outside the gate. Each data set was normalized by an appropriate control sample and then averaged by 3 data sets. Apoptosis and cell death assays Sample cells including those in the supernatant were collected 24 h after the transfection, washed with PBS and stained with Annexin V, Alexa Fluor 488 conjugated (Life Technologies) and SYTOX red (Life Technologies) for 15 min at room temperature. The cells were analyzed by BD Accuri™ C6. Annexin V, Alexa Fluor 488 conjugate was detected with FL1 filter, and SYTOX red dead-cell staining was detected with FL4 filter. Analysis of cosine similarity and net fold-change 41467_2018_7181_Article_Equ2.gif In Supplementary Figure , the correctness of multi-input logic circuits was quantitatively evaluated by calculating the cosine similarity between vectors  and  using the following formula: is a truth table vector that has ideal output (=0 or 1) for each state ([00], [10], [01], and [11]) as a vector. For example,  = (0 0 0 1) for AND circuit.  is an output signal vector that carries the observed output levels (=EGFP/ iRFP670) of each state ([00], [10], [01], and [11]). Thus, cos  ranges from 0 (worst) to 1 (best). Net fold-change was calculated by dividing the averaged output level in each ON state by that in each OFF state. All data are presented as the mean ± s.d. Unpaired two-tailed Student’s -test was used for the statistical analysis in Fig.  and Supplementary Figure . Tukey’s method was used for the statistical analysis in Figs. – (Supplementary Tables ,  and ). The levels of significance are denoted as * < 0.05, ** < 0.01, *** < 0.001, **** < 0.0001, and n.s., not significant ( ≥ 0.05). All statistical tests were performed using R. Electronic supplementary material.