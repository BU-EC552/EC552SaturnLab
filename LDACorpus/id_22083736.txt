Diagram of the synthetic network in yeast. Solid lines model transcriptional interactions while dashed lines are meant to represent protein-protein interactions. The synthetic network described herein has been built for benchmarking modeling and reverse-engineering approaches (, ). IRMA was designed to be isolated from the cellular environment (Cuccato et al., Heredity 102:527–532, 2009), and to respond to galactose or glucose, which respectively “switch” the network on and off by triggering transcription of its genes. This network (Fig. ) is very articulated in its interconnections, which include regulator chains, single input motifs, and multiple feedback loops generated by the combination of transcriptional activators and repressors. We selected well-characterized promoter/TF-encoding-genes pairs. We chose nonessential and nonredundant TF-genes that can be knocked out without affecting yeast viability. The following genes have been chosen for IRMA: as activators and repressors encoding genes: , ; as promoter genes: , , ,  (Fig. ). Synthetic Transcriptional Positive Feedback Loop in Mammalian Cells Design of the positive feedback loop in mammalian cells. The promoter  consist of seven direct repeats of a 42-bp sequence containing the tet operator sequences (), located just upstream of the minimal  promoter (P). The tetracycline-controlled transactivator  derives from the addition of the VP16 activation domain to the transcriptional repressor TetR. The d2EYFP is the destabilized  variant of enhanced  fluorescent protein with a half-life of approximately 2 h. This synthetic network is shown in Fig. . We took advantage of the inducible Tet regulatory system: the expression of Tetracycline-controlled transactivator tTA is self-controlled by a  promoter responsive to thetTA itself unless Tetracycline, or its analogous Doxycycline, is added to the medium in which cells are grown (). To follow the protein dynamics of the positive feedback loop, a destabilized yellow variant of the enhanced green fluorescent protein (d2EYFP) (Clontech), with a half-life of approximately 2 h, was expressed together with the tTA transactivator from the same mRNA, via an Intra Ribosomal Entry Sequence (IRES) in between of the transactivator tTA and the d2EYFP (Fig. ). In order to stably express in HEK293 cells the inducible feedback loop and to better characterize its dynamics overtime, we used a lentiviral vector (, ), based on the multisite Gateway technology provided by Invitrogen. Derivation of Mathematical Models for Synthetic Network When deriving a model from experimental data, three major approaches can be used: white-box, black-box, and gray-box. In white-box modeling, the model and parameter values are entirely derived from first principles, while in black-box, the model is completely derived from input–output data. The third alternative, the so-called gray-box approach (), combines the two above approaches. Specifically, first principles are used to partially derive the model structure, while parameters in the model are estimated from experimental data. The approach described in this chapter, both for the yeast and the mammalian synthetic network, is a gray-box one. In this case, modeling entails the following main steps to be executed iteratively: (1) derivation of the model equations and (2) estimation of the model parameters from experimental data and/or literature. Step (1) requires introducing simplifying hypothesis and choosing a proper formal framework. Among the different mathematical formalisms, those based on differential equations are commonly used to describe the average behavior of a population of cells (). The Differential Equations modeling approach is based on the following biological assumptions: the quantified concentrations are homogeneous in space and they are continuous quantities in time. These assumptions hold true for processes evolving on long time scales in which the number of molecules of the species in the reaction volume is sufficiently large. Step (2) is required to estimate unknown model parameters from the available experimental data. Experimental data are strongly affected by noise. Hence, classical optimization methods, based on gradient descent from an arbitrary initial guess of the parameters’ value, can be unfeasible. The above considerations suggest looking at stochastic optimization algorithms, such as Genetic Algorithms (GA) (), which provide a flexible approach to nonlinear optimization. Their application has been proved to yield good results in the parametrization of synthetic networks (, ). When the network is quite complex in terms of the number of the unknown parameters, there is the need of going through iteration between experiments and modeling, to gather more experimental data if needed. We show an example of such iteration, in the case of the yeast network. Refining Mathematical Models by Means Of Microfluidics Experiments Once a model of a synthetic network has been derived, it is possible to refine it by means of several alternative strategies. The primary goal of model refinement is the improvement of model predictions as regards the network dynamics, i.e., how gene and protein expression change in time following a perturbation; in order to accomplish this task, the experimenter may need to stimulate its synthetic network with highly dynamical signals. This is usually done to elicit nonlinear modes or other peculiar characteristics of the network under development. Most of the synthetic networks documented so far () use chemical compounds as inducers and thus the previous requirement often translates in the need to quickly change the concentration of these compounds in the media where cells are grown. On the contrary, effective strategies for data acquisition are needed to measure changes in the concentration of the species of interest in live cells. Here, we propose an integrated strategy intended to solve both of these issues at once via “microfluidics” devices and time-lapse fluorescence microscopy. Microfluidics involves the manipulation of very small fluid volumes, enabling creation and control of nanoliter-volume reactors, thus mimicking cellular microenvironments. Microfluidics devices can be conveniently used to finely control the concentration of compounds in the extracellular environment during time lapse microscopy experiments. Data acquired from long term stimulation of cells carrying fluorescent tags and tracked by the microscopy imaging can be conveniently used to improve the quality of the mathematical model of the circuit of interest. In the following sections, we illustrate how this platform can be adapted in experimental contexts involving both simpler and higher eukaryotic systems, namely mammalian cell lines and . Yeast Culture, Strains, and Semiquantitative and Quantitative RT-PCR MATa ura3-52 his3-D200 ade2-101 lys2-801 leu2-3 trp1-901 gal4-D542 gal80-D538 ade5::hisG strains YM4271 background () (). YEP medium: 10 g/L Bacto yeast extract, 20 g/L Bacto peptone. YEPD medium: YEP containing 2% glucose. YEPGR medium: YEP containing 2% galactose and 2% raffinose. SC medium: 6.7 g/L yeast nitrogen base without amino acids, 1.35 g/L amino acid powder mix. Rneasy MiniElute Cleaneup Kit (Quiagen). SuperScript III First-Strand Synthesis System (Invitrogen). Platinum SYBR Green qPCR SuperMix-UDG with ROX (Invitrogen). 7000 ABI Real-Time PCR machine. Applied Biosystems SDS software version 1.2.3 to perform data analyses. Microfluidics and Microscopy Apparatus Cole-Parmer nano syringe pump (Cole-Parmer). Tygon Microbore Tubing I.D.: 0. 25” O.D.: 0.125” (Swagelok). Tygon Microbore Tubing I.D.: 0.020” O.D.: 0.060” (VWR). Sulforhodamine B (Sigma-Aldrich). Inverted fluorescence microscope with temperature and CO conditioning and appropriate fluorescence filters. Mammalian Cells Culture and Lentiviral Transduction 293FT cells maintained at 37°C in a 5% CO-humidified incubator, and cultured in Dulbecco’s Modified Eagle’s Medium DMEM (GIBCO BRL) supplemented with 10% heat-inactivated fetal bovine serum (FBS) (Invitrogen), 1% -glutammine, 1% MEM Nonessential Amino Acids, 1% MEM Sodium pyruvate, and 1% antibiotic/antimycotic solution (GIBCO BRL). Hek 293 cells maintained at 37°C in a 5% CO-humidified incubator, and cultured in Dulbecco’s Modified Eagle’s Medium DMEM (GIBCO BRL) supplemented with 10% heat-inactivated fetal bovine serum (FBS) (Invitrogen), 1% -glutamine, and 1% antibiotic/antimycotic solution (GIBCO BRL). Doxycicline (Clontech) dissolved in tissue-culture water to a final concentration of 10 μg/mL, stored in aliquots at −20°C, and then added to tissue culture dishes as required. Polybrene (Invitrogen) dissolved in tissue-culture water to a final concentration of 6 mg/mL, stored in aliquots at −20°C, and then added to tissue culture dishes to a final concentration of 6 μg/mL. Blasticidin (Sigma) dissolved in tissue-culture water to a final concentration of 100 mg/mL stored in aliquots at −20°C, and then added to tissue culture dishes to a final concentration of 3 μg/mL. PCR and Construction of Gene Circuit Taq Phusion (Fynnzymes) is used to a final concentration of 0.02 U/μL; the HF buffer is added to a final concentration of 1×, primers and dNTPs are supplied to a final concentration of 0.5 μM each and 200 μM each, respectively. Taq DNA polymerase (Invitrogen) is used to a final concentration of 1 U/μL; the PCR buffer is added to a final concentration of 1× MgCl 1.5 mM, primers, and dNTPs are supplied to a final concentration of 0.5 μM each and 200 μM each respectively. 5 U/μL of NheI and EcoRV restriction enzymes (Roche). 2 U/μL of T4 DNA Ligase, and T4 DNA Ligase buffer to a final concentration of 1×. LR Clonase II plus enzyme mix (Invitrogen). Computing System and Algorithms Personal computer equipped with MATLAB Simulink (MathWorks). Image processing algorithm implemented in the control schematic. The  cassette was amplified by PCR and inserted in front of the stop codon of  gene in YM4271 strain resulting in P278 strain. To generate P280 strain  promoter was amplified from W303 and cloned in YIplac128 between Hind III and Sac I. ORF was cloned between Sac I and Nde I, thus resulting in p. The  cassette was integrated in  locus. ORF was amplified from W303 and cloned among Bam HI and Pac I of p. The  cassette was integrated downstream of the  promoter of P280 strain, obtaining P324. promoter was cloned in Pst I and Bam HI of YIplac211, and then  was inserted between Bam HI and Sac I. The  was integrated in  locus, thus yielding P326. gene was deleted in the strain P326 by integrating  from pAG25. was integrated in  locus resulting in IRMA containing strain. To construct the IRMA containing strain, sequential PCR-based genomic integrations were made sequentially. All the integrations were confirmed by PCR. Further details can be found in (). Prepare the total RNA.2. Treat 1 μg of RNA with 2.5 U of DNAseI. Clean up with RNeasy MiniElute Cleaneup Kit (Quiagen). Reverse-transcribe the RNA cleaned using SuperScript III First-Strand Synthesis System. Set up quantitative real-time PCR reactions in duplicates using Platinum SYBR Green qPCR SuperMix-UDG with ROX. Amplify the cDNA thus obtained using a 7000 ABI Real-Time PCR machine. In order to analyze the dynamic behavior of the network, we analyzed expression profiles of network genes by quantitative real-time RT-PCR following two different perturbation experiments; in the first we shifted cells from glucose (YEPD medium) to galactose (YEPGR medium) (“switch-on” experiments) and from galactose to glucose (“switch-off” experiments). In the second, we overexpressed each of the five network genes in cells that were grown either in glucose or galactose (). Construction and Testing of the Synthetic Positive Feedback Loop in Hek293 Cells Cloning of a destabilized yellow-green variant of enhanced green fluorescent protein (d2EYFP) in the p vector: the  was amplified from pd2EYFP-1 (Clontech) by PCR using the High-Fidelity DNA Polymerase Taq Phusion, with a forward primer containing a NheI recognition sequence and a reverse primer containing an EcoRV recognition sequence. The PCR product and p were then digested with NheI-EcoRV restriction enzymes and the  ligated in place of  (ratio ng of vector/ng of d2EYFP  =  1/3–1/5). Generating the pENTR vectors: in order to produce a lentiviral vector by using the gateway system we first generated the pENTR vectors containing the genes and the promoters of interest flanked by specific recombination sites. The p was linearized with the AseI restriction enzyme and recombined with the pDONR221 (invitrogen) following the manufacturer instruction. In this way we generated p vector with specific recombination sites. The  promoter was amplified from pTRE2 (clontech) by PCR. The PCR was performed with the Taq polymerase provided by Invitrogen that adds a single deoxyadenosine (A) to the 3′ ends of PCR products. This allows PCR inserts to ligate efficiently with the pENTR5′-TOPO vector which is supplied linearized with single 3′-deoxythymidine (T) overhangs, obtaining the pENTR5′-TOPO- with specific recombination sites. Finally, we performed a recombination reaction between the pENTR, pENTR5′-TOPO-, and the p using the LR clonase enzyme according to manufacturer instructions. The lentivirus was then produced in 293FTcells as described in the instructions provided by Invitrogen. Cell culture for lentiviral transduction: To transduce cells with the virus produced, 500000 HEK293 cells were plated and incubated overnight. The day of transduction the medium was removed and 1 mL of the virus was added to the cells together with polybrene to a final concentration of 6 μg/mL. After an overnight incubation the medium containing the virus was removed and replaced with complete culture medium containing the blasticidin to a final concentration of 3 mg/mL to select for stably transduced cells. To test the dynamics of the autoregolatory loop, we performed two sets of time-series experiments in which stably integrated HEK293 cells were imaged using time-lapse microscopy and fluorescence of d2EYFP was quantified. For both the experimental designs in the first time point, cells were treated with Doxycycline to “switch off” the network, since Doxycycline prevents the tTA transactivator to bind the  responsive promoter. In the first set of experiments, the dynamics were followed for 37 h at 37°C, while in the second set the temperature was reduced to 32 °C to limit cell motility and thus facilitate image analysis (). We constructed the synthetic positive feedback loop into a lentiviral vector system to allow integration of the circuit in mammalian cells. To this end, we used the ViraPower Promoterless Lentiviral Gateway Expression System (Invitrogen), which takes advantage of the site-specific recombination properties of bacteriophage lambda, making the transfer of single DNA sequences faster than the usual cloning strategies. Mathematical Modeling the Yeast Synthetic Network Step (i). Derivation of the Model from First Principles 193175_1_En_4_Chapter_Equa_4.gif The network of interest it the one showed in Fig. . Details about the network construction are reported in Subheadings  and . For each species in the network, i.e., each mRNA (capital letters) and correspondent protein concentration (small letters), we wrote one equation, which expresses its change in time as the result of production and degradation: 193175_1_En_4_Chapter_Equb_4.gif The first two terms on the right-hand side of the mRNA equations represent the production, where α are the basal transcription rates;  are the maximal transcription rates modulated by the Hill functions: Parameters of the mathematical model the yeast synthetic network These are used to model transcriptional activation, or repression;  and  represent transcription factor levels,  are the Hill coefficients (pure numbers that refer to the cooperativity of the activation binding reaction) and  are the Michaelis-Menten constants, equal to the amount of transcription factor needed to reach half maximal activation (or repression). For protein equations, the production rates are β, i.e., the maximal translation rates. Degradations of mRNAs and proteins are represented by , i.e., the degradation constants. The amount of free Gal4 depends on the interactions of the galactose pathway with the network genes. For the units of measurement, please refer to Table . Summing up, when writing the above model, we made the following assumptions: (A1) the transcriptional activity of each promoter is leaky (α); (A2) the degradation kinetics of both mRNAs and proteins are first-order; (A3) the protein production terms are proportional to the corresponding mRNA concentrations; (A4) the transcriptional activation–repression of each promoter by a transcription factor can be modeled as a Hill function (). Note that the concentration of Gal4free is the amount of Gal4 protein that is not involved in the formation of the protein-protein complex with Gal80 and hence activates the  promoter driving  expression. Identification and validation results of time-series, phenomenological model.  represent average expression data for each of the IRMA genes at different time points.  represent standard errors.  represent in silico data. () Identification results of the phenomenological model on the average 5 h “switch-on” time-series. () Validation of the phenomenological model on the average 3 h “switch-off” dataset. In order to identify model’s parameters and validate the model, we collected mRNAs expression levels during a time course experiment, by shifting cells from glucose (YEPD medium) to galactose (YEPGR medium) (“switch-on” experiment) as described in () and in Subheadings  and . Data are shown in Fig. a. We included as the first point of the time-series the expression level of the network genes after growing cells overnight in glucose, just before shifting them from glucose to galactose (). The second point, taken after 10 min, is measured just after the shift has occurred. The averaged gene expression profiles (Fig. a) show that the standard washing steps, needed to shift cells from glucose medium to the fresh new galactose-containing medium, induce a transient increase in mRNA levels of  and  (Fig. a, gray bars). This effect is not dependent on galactose addition, but uniquely on the washing steps (), and it is probably due to the transient deprivation of carbon source during washing, which attenuates the degradation levels of  and  mRNAs (). Moreover, the activation of 1 appears to be delayed with respect to the other Swi5 targets, respectively  and  (Fig. a). Such delay is physically due to the sequential recruitment of chromatin modifying complexes to the  promoter, which follows binding of Swi5 (, ). We then performed four additional experiments, shifting cells from galactose to glucose, thus “switching off” gene expression in the network, as described () and in Subheadings  and . The averaged time-series gene expression profiles (Fig. b) were used for validating model predictive performance. We refer to this dataset as the “switch-off” dataset. Experimental and simulated overexpression experiments (, ). In vivo expression levels of IRMA genes after overexpression of each gene (perturbed gene; indicated by the  on the bars) from the constitutive  promoter () and after transformation of the empty vector (). IRMA cells were transformed with each of the constructs containing one of the five genes or with the empty vector. At least, three difierent colonies were grown in glucose () and in galactose-rafinose () up to the steady-state levels of gene expression. Quantitative PCR data are represented (average data from different colonies) (, ). In silico expressionlevels of IRMA genes obtained by simulating the overexpression of each gene with the phenomenological model (, ). In silico expression levels of IRMA genes obtained by simulating the overexpression of each gene with the refined model. Finally, we collected another set of experiments to be used to further validate the model’s predictive ability. We measured gene expression responses of the five network genes following ­exogenous overexpression of each of the five genes under the control of a strong constitutive promoter, as described in () and in Subheadings  and . Such overexpression experiments were performed both in glucose and in galactose. We refer to these two experimental datasets as the “Galactose steady-state” and “Glucose steady-state” (Fig. a, c). Step (i). Derivation of the Phenomenological Model At this stage, we had to properly refine the model both to be able to capture the features highlighted by the gene expression profiles and to reduce the number of parameters to be estimated. First of all, we made the following extra modeling assumptions: (A5) a fix time delay, , equal to 100 min, is added in the activation of the  promoter by Swi5; (A6) a transient decrease in the mRNA degradation of  and  of value Db1 and Db2 is added for an interval of 10 min to describe the effect of the washing steps. Due to the lack of protein concentrations measurements, we also assumed that the protein concentrations are monotonically increasing functions of their corresponding mRNA concentrations at any time (A7). 193175_1_En_4_Chapter_Equc_4.gif In order to define the active amount of Gal4 (GAL4 free in the above Equations), we needed to describe the effect of the galactose pathway on the network dynamics. In the literature, very detailed models of the galactose pathway have been presented (). Such paradigms can be simplified in a number of ways, but it often leads to include in the model nonmeasurable complexes concentrations. Thus, we decided to use a phenomenological approach, assuming that (A8) the protein-protein interaction between Gal80 and Gal4 can be modeled as a direct inhibition of  on the promoter of , and that the strength of such inhibition depends on the medium (strong inhibition in glucose, weak inhibition in galactose). Actually we assumed that the  promoter is activated by  and noncompetitively inhibited by  The resulting phenomenological Delay Differential Equations (DDEs) model is: We use the symbol ^ to indicate medium-dependent quantities. Thus, we are assuming that the Michaelis-Menten coefficient of the phenomenological description of the inhibition of  is dependent on the medium. Step (II). Identification of Model’s Parameters and Model Validation For the sake of simplicity, we set all of the Hill coefficients to 1. For the identification of the remaining parameters, we used the “switch-on” dataset, using as initial values the simulated steady-state mRNA levels in glucose. Parameters’ identification results, obtained by using the Genetic Algorithm and hand refinement (
) are shown in Fig. a and the inferred parameters in Table . The model captures the delay in  activation and the small variations of  and . In order to validate the model predictive performance, we used the “Glucose steady-state” and “Galactose steady-state” over­expression experiments, and compared them with their in silico counterparts by simulating the overexpression of each of the five genes (Fig. b), (D)). We further validated the predictive performance against the “switch-off” time-series by simulating in silico the “switch-off” experiment (i.e., setting the medium-dependent parameters to their values in glucose and starting the simulation from the steady-state equilibrium in galactose) (Fig. b). The phenomenological DDEs model has good descriptive and predictive performance. However, the 24 identified parameter values are likely to be different from their physical values. For example, model parameters (Table ) indicate that the inhibition of Ash1 on  is so weak that can be neglected, even if in the literature it has been reported otherwise (). Additional Experimental Investigation. Promoter Strength Experiments and Reidentification of the Correspondent Parameters (Step (II)) At this point, we needed to clarify the biological properties of the  promoter by taking direct measurements of the promoters’ parameters (). We thus measured the transcriptional response of the promoters of , , , and  the latter when regulated by both Swi5 and Ash1 (
). For each promoter, we fitted to data the equation at steady state of the gene whose expression the promoter drives. Of note, it became apparent from the new experimental data and the fitting results that galactose not only weakens the inhibition of Gal80 on the 0 promoter (assumption (A8)), but also allows a faster activation of the  promoter. Moreover, in galactose such activation is possible for values of  lower than in glucose. Step (i). Phenomenological DDEs Refined Model 193175_1_En_4_Chapter_Eque_4.gif In order to capture the behavior observed from the new experiments, we considered two additional parameters in the model to be explicitly dependent on the medium. Thus, we refined the previous model by changing the equation of , which became

where again the symbol ^ indicates parameters dependent on the medium. From the analysis of data, we found that the value assumed by 
 in galactose is 9 times bigger than the one in glucose. Analogously, the value of 
 is 9 times bigger in glucose than in galactose ( Table ). Step (ii). Identification and Validation of the Refined Model Identification and validation results of time-series, phenomenological model.  represent average expression data for each of the IRMA genes at different time points. Dashed lines represent standard errors.  represent in silico data. () Identification results of the phenomenological model on the average 5 h “switch-on” time-series. () Validation of the refined model on the average 3 h “switch-off” dataset. From the promoter dataset, we estimated 16 parameters, including the medium-dependent ones (Table ). From such data, we could neither fit degradation constants nor the washing effect parameters. Thus, the remaining 17 parameters were evaluated again from the “switch-on” experiment (Table ). In simulations, the initial values of mRNA concentrations were set to the steady state values predicted by the model in glucose. The in silico “switch-on” time-series is shown in Fig. a. Also in this case, we tested the predictive ability of the model performing in silico the previously described “Glucose steady-state” and “Galactose steady-state” overexpression experiments (Fig. e, f) and the “switch-off” time-series (Fig. b). Now, the identified parameters confirm that the Ash1 inhibition of the  promoter is indeed strong, as reported in the literature (). There are still discrepancies between the in vivo and in silico initial values of , , and  in the “switch-off” dataset, and in the predicted steady state of mRNA levels in galactose. We attribute them to the unmodeled effect of protein dynamics, which have been removed from the original model due to the lack of experimental measurements. In particular, we noticed that the Gal4 protein is stable (), and therefore even a small, or transient, increase in its mRNA level is able to induce the  promoter, regulating Swi5 in our network. Since we do not explicitly model protein dynamics, a small increase in  mRNA cannot fully activate  in the model and does not cause the increase in  mRNA seen in vivo. The quality of the fitting and the predictions could be further improved by modeling the proteins levels of all the genes in the network. However, in the actual version of the network, it is not possible to measure protein levels with the exception of only one gene (Cbf1). Thus, the assumption of steady state for protein dynamics is required, not only to simplify the model but also mainly to not introduce the problem of overfitting and nonuniqueness of parameters for proteins. Modeling the Synthetic Transcriptional Positive Feedback Loop in Mammalian Cells Step (i). Derivation of the Mathematical Model The network of interest is the one showed in Fig. . Details about the network construction are reported in Subheadings ,  and . Again, the formal framework we chose is based on Ordinary Differential Equations, since we are measuring the average behavior of a population of cells uniformly infected by the virus. Hill functions to model the rate of gene transcription, including basal activity to describe the leakiness of the  promoter (A1) Linear degradation for all genes and proteins (A2) Linear dynamics for the translation (A3) Michaelis–Menten-like modeling of the effect of the inducer (Doxycycline) (A4) Distinct dynamics for the unfolded (inactive) and folded (active) forms of the reporter protein (d2EYFP) (A5) For each species, i.e., each mRNA (italic capital letters) and correspondent protein concentration (roman small letters), we wrote one equation, which expresses the change in concentration of the species in a given time interval, as the result of a production and a degradation. We assumed: 193175_1_En_4_Chapter_Equd_4.gif The last assumption was introduced to take into account time delay for the maturation of d2EYFP protein. Thus, we derived two differential equations as in (): one for the translation of mRNA to the unfolded d2EYFP protein, and one for the folded protein d2EYFP. Letting 
 be the  mRNA concentration, 
 the tTA protein concentration, 
 the unfolded d2EYFP protein concentration, and 
 the folded d2EYFP protein concentration, the equations describing the network become: Note that, due to the presence of the IRES, the concentrations of tTA protein and d2EYPF protein depend on the same variable (
), that is the amount of  mRNA. As in the case of the yeast synthetic, network, to identify model’s parameters and validate the model predictive ability, we performed two sets of “switch off” time-series experiments as described in Subheading . HEK293 cells expressing the positive feedback loop, were imaged using time-lapse microscopy and fluorescence of d2EYFP was quantified. At the beginning of the experiment (first time point) cells were treated with Doxycycline to “switch off” the network, since Doxycycline prevents the ttA transactivator to bind the  responsive promoter. In the first set of experiments the dynamics were followed for 37 h at 37°C, while in the second set the temperature was reduced to 32°C to limit cell motility and thus facilitate image analysis. Derivation of Mathematical Models for Synthetic Network Parameters of the mathematical model of the positive feedback loop in mammalian cells Hill coefficient of the  promoter Affinity Doxycycline promoter interaction We first simulated the model using, when available, the parameters values previously estimated in the literature ( ref. ), and reported in Table . However, using such parameters, we were not able to correctly reproduce the experimental “switch-off” dynamic behavior of the postive feedback loop. In particular, using the reference parameters the in-silico simulation shows faster dynamics than the in vivo data. Thus, we used the experimental “switch off” time series to identfy the model parameters using a Genetic Algorithm optimization method, letting the parameters vary in a neighborhood of the literature value. In this case, hand refinement (
) was not necessary, since the number of parameters to estimate was lower than in the yeast network case, and the search interval was smaller. Of note, during the parameter fitting procedure, we tried to minimize the changes to parameters previously estimated in the literature. Dynamical behavior of the positive feedback loop in mammalian cells. In this figure model predictions of the dynamics characterizing the circuit for varying concentrations of Doxycycline (1 μg/mL for () and (), 100 ng/mL for () and 10 μg/mL for ()) have been reported. The sample time is equal to 15 min. The cells were treated with the antibiotic at   =  0 (min). Model predictions are reported in with thick line while experimental results are represented in . In (), the cells were kept at 37°C and observed up to 37 h. In (–) the cells were kept at 32°C and observed up to 61 h. In () we report the comparison of the dynamics of the circuit obtained by varying the strength of the positive feedback loop.  = model simulation of the system including the positive feedback loop using the inferred parameter values (Table ).  = model simulation of the system reducing the strength of the positive feedback loop.  = model simulation of the system removing the positive feedback loop. The simulations of the model with the identified parameters (Table ) are shown in Fig. . The model is now able to recapitulate the positive feedback loop dynamics in response to different inducer concentrations and experimental settings ( Subheading ). We estimated a different the degradation rate of the reporter protein (d2EYFP) in the two experimental conditions. As mentioned above, in the first set of experiments (Dataset 1) the cells were kept at 37°C, while, in the second round of experiments (Dataset 2), we used a lower temperature (32°C) to limit cell motility. Figure  (A) and (C) show the response of the system using the same amount of inducer (1 μg/mL), with cells at 37°C and 32°C, respectively. The dynamics of the “switch off” are faster if the temperature is higher, as the cells metabolism is faster (). In the model, we captured this behavior by changing the degradation rate of the reporter protein (parameter 
 in Table ). Another parameter we estimated, the maximal transcription rate of the  promoter (Table ), was quite different form the reported value in literature. The physical meaning is that the strength of the positive-feedback loop is much stronger than previously estimated, at least in the cell-line we used in this experiment (HEK 293). The presence of the positive feedback loop is the key to understand the dynamics of the network, because it makes it harder for the d2EYFP to be down regulated by Doxycycline. Indeed, in Fig. e we analyzed how the presence of the positive feedback loop affects the switch-off dynamics: decreasing its strength (green line) or removing it (black line), the network is switched off much faster. The model was further refined as described in (). Time-lapse Experiments Based on Microfluidics Dynamics In order to carry out experiments with  or mammalian cell lines, appropriate microfluidic device designs must be conceived. The design of such devices should be carefully considered on the basis of the morphological characteristics of the cells used: 10 μm in height channels, for example, may be suited for  but may be not compatible with many mammalian cell types. For this reason the experimenter is highly recommended to check both morphological and physiological properties of the cells to be employed before moving to the device design step. The setup of experiments for  and mammalian cell lines is quite similar and differs only in the preparation of cells and temperature/CO conditioning settings. Depending on the motility level of cells you may be interested in lowering it: two effective ways to accomplish this is either (a) by lowering the temperature in the microincubator at 32°C or (b) using drugs such as Cytochalasin D, ladrunculin, Nocodazole, etc. Advantages and disadvantages of both the types of approaches should be carefully evaluated before choosing for one or the other since temperature-based strategy may interfere with cells’ metabolism (thus adding uncertainty to the quantification results) while drugs-based strategies (mainly acting on cytoskeleton and microtubules development) may be characterized by unwanted side effects. Fill the 50-mL Falcon tube with 5 mL Synthetic Complete medium. Add 500 μL Galactose 20% (w/v). Add yeast cells from the solid medium culture. Place the Falcon tube in the shaker at 30°C/150–200 rpm. Measure O.D. and dilute in 5 mL so as to obtain a final O.D. of 0.5. This protocol assumes you designed and built a microfluidic device with  ports,  of which are inlets. Setting Up the Computing System Program your microscopy control scheme to acquire bright field as well as fluorescent fields at regular time intervals (5 min with exposure times of 200–400 ms have been found to work fine for yeasts). Your image processing algorithm should use bright field image to locate cells. Once cells are located, a binary mask image is used to compute a mean fluorescence of cells. A mean intensity quantification of the red fluorescence field can be used to match the galactose/raffinose time profile obtained experimentally with the desired one and this information can be used to understand whether clogging or other detrimental phenomena are taking place in the device. Set up your algorithm so that once images are acquired the image processing routine is launched on them: This section deals with the specific aspects of the computing system behind the control law. The implementation presented uses MATLAB Simulink but other software packages like National Instruments LabView can be used as well. Here, we provide details of both the steps needed to acquire and process data from the microscope. To obtain a lentiviral vector by recombination of three plasmids, we found that the optimal concentration of each plasmid is: pENTR5′-TOPO promoter 10 ng, pENTR gene 10 ng, p 120 ng, according to the fmoles required for each vector. We suggest to dephosphorylate the p linearized with the AseI restriction enzyme before performing the recombination reaction in pDONR221 to avoid the possibility of forming colonies in the negative control because the plasmid is prone to becoming circular again. We, thus, recommend to add 5 U of the Alkaline Phosphatase, Calf Intestinal (CIP) (New England Biolabs) to the vector linearized and to leave the reaction at 55°C for 45 min, and then to purify the fragment with the QIA quick PCR purification kit (QIAGEN). It is really necessary to control that all the concentrations of the vectors you find in the ViraPower Promotrless Lentiviral Gateway Expression System are correct. The Doxycycline and Blasticidine working solution can be stored at 4°C up to 1 month. As reported, when you are modeling a synthetic network, to decide what can be simplified, and what needs to be modeled in more details, it is necessary to go through iterative refinement steps both in the model and in the experimental dataset. Multiple identification of each parameter running GA more than one time letting the parameter vary in a physical feasible range. In this way, we obtained different values for each parameter (even with the same setting, since the algorithm is stochastic) that, however, remain quite close to each other. Thus, this step allows to significantly restricting the search range. Hand refinement of the parameters in the narrow range obtained in step (a). When the number of unknown parameters is high, as in yeast network case, and the physical feasible range for them is large, it is not easy to identify them. Even though stochastic identification techniques provide a flexible approach to nonlinear optimization, it is good to proceed with hand refinement. Thus, we proceeded in this way: Since each experiment is costly and time consuming, the best option in the iterative analysis of a biological network is, at each step, to only perform those experiments that the mathematical modeling deems indispensable. In the case of the yeast network, we could have performed the promoter strength experiments from the beginning, since the Hill functions were almost unchanged during the model refinement, with the exception of the  and  promoters modeling. However, the need of performing such experiments arose after the identification of Model C, since we did not trust the identified Hill functions parameters. The quality of the microscopy section is of primary importance in experiments involving  expressing fluorescent reporters due to the thickness of the wall protecting yeasts from the external environment. Yeast experiments of this type are best carried out at magnifications like 40× and 60×. High numerical aperture objectives should be preferred to make the image processing easier. High-quality mercury lamps are needed to obtain good fluorescent field images; CCD cameras can lower the Signal to Noise Rate (SNR) associated to the images when compared to conventional cameras (). Attention should be paid to the air-bubbles washing steps: PDMS is porous and the user can take advantage of this property to get rid of the air-bubbles just by injecting ddHO at high pressure (just by pressing the plunger of the syringes used to flush the device). Once there are no more bubbles in the device, the experimenter should pay attention to the disconnection of the ddHO syringes: the needles should be gently disconnected and pressing the plunger for 10 s before unplugging the related needle can help in generating the pressure needed to prevent air from reentering the port. All media, sugars and dyes to be used should be filtered with 0.22 μm filters so as to avoid the presence of small particles that can accelerate the clogging of the device or, alternatively, mislead the image segmentation algorithm. The preparation of the media in a fume hood does provide a strong advantage in this context. When sugars such as galactose are used as inducers, supplementing with supporting metabolic sources should be considered as an option. Growth of yeast cells in media featuring galactose can be quite slow: having cells slowly moving in a field can be a good advantage from the point of view of the image processing algorithm, unfortunately the metabolic implications of these conditions cannot always be predicted with accuracy thus adding uncertainty to our experiments. In the proposed protocol, we used a red fluorescent dye, namely, Sulforhodamine B, whose excitation and emission spectra largely overlap with red fluorescent protein tag (e.g., Cherry etc.). If the protein to be controlled is tagged with such a fluorescent protein it may help using a different dye (e.g., Atto 655) to track the inducer compound concentration. Nevertheless, it should be noted that choosing such option may imply buying new filters (Atto 655, for example, emits in the far red and requires a specific filter like the Cy5.5-A (Semrock, PN FF685-Di01-25  ×  36)). The image processing algorithm is one of the key points of the whole setup: several free software packages have been proposed in the field of cellular microscopy being CellProfiler (), Cell-ID (), CellTracker (). Nevertheless, it should be noted that achieving a good quality of segmentation often may require a long session of parameter fine-tuning and, more often, flexibility of these packages is an added value and not a core characteristic. Experienced users should consider developing their own code on the basis of their specific application and experimental context: testing the dependence of the ­segmentation results on the experimental conditions may help in ­optimizing the code and make it more robust to varying boundary conditions..