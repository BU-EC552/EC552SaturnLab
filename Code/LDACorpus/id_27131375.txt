Recent advances in genome editing and metabolic engineering enabled a precise construction of  biosynthesis pathways for high-value natural products (,). One important design decision to make for the engineering of heterologous biosynthesis systems is concerned with which foreign metabolic genes to introduce into a given host organism (). Although this decision must be made based on multifaceted factors, a major one is the suitability of pathways for the endogenous metabolism of a host organism, in part because the efficacy of heterologous biosynthesis is affected by competing endogenous pathways (–). To address this point, we developed an open-access web server called MRE (Metabolic Route Explorer) that systematically searches for promising heterologous pathways by considering competing endogenous reactions in a given host organism (Figure ). There are various computational tools available to guide the design of heterologous pathways with a range of scopes and functions. Table  summarizes features of several heterologous pathway design tools. One key difference among these design tools is the specification of host organisms. Some tools, including BNICE (), PredPath () and Metabolic tinker (), were developed to explore pathways irrespective of the consideration for host organisms. Thus, these tools cannot assess the suitability of pathways for a specific context of the endogenous metabolic system of a host organism. Some other tools, on the other hand, restrict the user to use one specific host organism. For example, pathway design tools based on flux balance analysis (FBA), such as XTMS (), DESHARKY (), OptStrain () and GEM-Path (), are specific to the  chassis. While FBA-based tools tend to offer rich information to evaluate  pathways, they demand detailed knowledge of a given metabolic system with tight reaction-flux boundaries in order to identify meaningful steady-state flux distributions among a large number of candidate solutions. Clearly, such data are only available for well-studied organisms, and this may be a major reason why FBA-based tools focus on the pathway design in . In contrast, FMM () and PHT () allow the user to select a host organism from a large set of choices. However, these tools do not use the chassis information to rank suitable biosynthesis pathways for a given endogenous metabolic system. Instead, with this information, PHT just reports which enzymes are not natively available in the host, whereas FMM suggests the introduction of foreign enzymes for some reactions in heterologous pathways. Another main feature difference is the basis for chemical transformation of intermediate precursors that forms metabolic routes. While tools such as FMM, DESHARKY and Metabolic tinker specify chemical transformation using metabolic reaction sets from databases [e.g., KEGG () and RHEA ()], other tools, including BNICE, PredPath and XTMS, predict some generalized chemical transformation rules using such curated reaction sets and apply them to expand potentially feasible metabolic routes. Unlike these existing tools, MRE focuses on the suggestion of foreign enzymes with well-characterized activities for promising heterologous pathways by taking into account the effects of the existing, endogenous metabolic infrastructure of a host organism. To find promising biosynthesis routes from a large number of potential candidates, thermodynamic data offer useful information (). Some existing pathway design tools, such as Metabolic tinker and XTMS, use thermodynamic data to constrain the reaction directionality or to rank pathways based on their net favorability, which does not consider competing endogenous reactions. In contrast, MRE uses thermodynamic data to rank pathways in a host-dependent manner from the perspective of the integration of new reactions into the endogenous metabolic system. In order to suggest actual foreign enzymes for the design of heterologous biosynthesis pathways, MRE only considers verified reactions as metabolic parts. For each foreign reaction in a suggested heterologous pathway, MRE generates information about endogenous reactions competing for metabolites. Since one effective approach to increase the productivity is to attenuate or eliminate competing reactions (,,), MRE may also offer useful insights into how to debottleneck and optimize heterologous pathways. Typical user-interface pages of MRE. () The query input page. () The summary page for the top-ranked routes. () The page for a graph comprising the top 10 routes. () The page for pathway-level information. () The competing reaction information page. Feature summary of heterologous pathway design tools Information given for each pathway Fraction of conversions via normalized Boltzmann weights Required metabolites, EC numbers for enzymes, genes for foreign enzymes, reaction free energy, competing native reactions EC numbers for enzymes, availability of each enzyme in various host organisms, suggestion for foreign enzymes EC numbers for enzymes, local and global compound similarities for each reaction step Gene scores, reaction steps, toxicity, yield, Gibbs energy Source compound for the retrosynthesis path, predicted reactions with EC numbers, genes for foreign enzymes, toxicity, production yield Possible reactions for each chemical transformation step and net favorability Final compound of biodegradation, predicted intermediates and reactions, confidence for each predicted reaction Source or target compound, EC numbers for enzymes, genes for some foreign enzymes, growth rate reduction measures 3-level EC number for each predicted chemical transformation MRE makes use of several data resources. The main ones are from the KEGG databases (). KEGG lists around 4000 organisms, which MRE uses for the selection of a host organism. The KEGG COMPOUND database is used to identify metabolites, while the KEGG REACTION database and the ExPASy ENZYME database () are used to find metabolic reactions with verified activities. The eQuilibrator dataset () is used to obtain the reaction Gibbs energy in the standard 1M concentration setting. The KEGG RPAIR database () is used to restrict search space based on the relation between reactants and products. The KEGG GENES database is used for DNA sequence data for enzymatic genes, and the KEGG taxonomy mapping dataset is used to calculate taxonomic distances. To explore biosynthesis routes with MRE, the user specifies a host organism and a pair of the starting and target compounds. To increase its usability and to help the user specify organisms and compounds, MRE comes with an auto-completion feature. With advanced options, the user can override the default setting for the metabolic route search. These options include the maximum number of reaction steps (denoted by ), the number of top-ranked pathways to generate (denoted by ), and a list of compounds that are not considered as primary metabolic precursors in the search, which we call the . By default,  and  are set to 8 and 50, respectively, while the exclusion list is based on the one from Metabolic tinker () and has 101 compounds that have high degrees of connectivity in its metabolic network graph, for example, water, ATP and ADP. This exclusion list can also be customized to have other compounds (e.g., CO). In addition, MRE allows the user to constrain the chemical transformation of precursors based on RPAIR types (e.g., main, cofac and trans). These filtering schemes to constrain possible chemical transformations were reported to increase the relevance of the  biosynthesis route suggestion (). By default, MRE considers chemical transformations based on main, cofac and trans RPAIR types. Based on the input query for biosynthesis requirements, MRE generates the top- metabolic routes, and the main result page summarizes these routes. For each metabolic route, MRE highlights whether it is endogenous or heterologous to the host organism. For each foreign reaction in a heterologous biosynthesis route, MRE predicts which metabolites may not be available in the host, and it lists exogenous genes for the corresponding enzymatic activity and suggests a list of foreign genes based on a taxonomic similarity measure whose cDNA sequences can be downloaded in the FASTA format. It also shows a list of native reactions competing for a metabolic precursor with each foreign enzymatic reaction. MRE provides a mean to visualize a specific pathway with competing endogenous reactions as well as a graph aggregating top-ranked routes. Figure  depicts the workflow of MRE. Our tool first constructs a directed graph representing a host-independent metabolic network with verified reactions. This graph comprises all metabolic reactions with verified activities found in the data source, and it is built regardless of the choice of a host organism for a biosynthesis system. It next assigns weights to the edges in the graph in a host-dependent fashion by classifying which enzymatic reactions are native and foreign in the given host organism and by using the thermodynamic data. To search for biosynthesis routes from the starting material to the product in the host, MRE explores the host-independent metabolic network with the host-dependent weighting scheme exhaustively and generates top- biosynthesis routes. Host-independent metabolic network with verified reactions To construct the host-independent metabolic network, we first identified metabolic reactions with verified activities. We categorized enzymatic reactions based on Enzyme Commission numbers (EC numbers) (). Each EC reaction (i.e., a reaction class corresponding to each EC number) denotes a class of catalytic reactions with the same chemical transformation. To retrieve verified metabolic reactions with known enzymes, we filtered out reaction classes with partially qualified EC numbers as these partial EC reactions are unverified and can lead to misinterpretation of enzymatic activities (). We also removed those EC reactions that do not contain any enzymes. With this filtering process, we identified 5389 complete EC reactions and 76 spontaneous reactions with verified activities. We next estimated the standard reaction Gibbs energy Δ′° for each of these verified reactions using eQuilibrator with absolute temperature set to 298.15K. Each verified EC reaction is then split into two reactions: the forward reaction with the reaction Gibbs energy Δ′° and the backward reaction with the reaction Gibbs energy −Δ′°. Those EC reactions whose Δ′° could not be estimated were assigned the largest of the estimated values for both directions. We adopted this approach to take a conservative stance and avoid the suggestion of biosynthesis routes containing reactions with no thermodynamic information as much as possible. Using these reactions, we built a directed graph that models the transformation of metabolites where its vertices represent metabolites and its edges represent chemical transformations via verified metabolic reactions. Since this directed graph unifies all metabolic reactions with verified activities in the reaction databases, its structure is independent of the endogenous metabolic system of any host organism. Host-dependent reaction weighting scheme Using the user-specified host organism, we assigned weights to the edges of the directed graph. To assign the weight of each outgoing edge from a given compound node, we first assumed that this reaction was in the host organism and computed the probability of converting the precursor via this reaction over the competing native reactions. That is, by representing the competition for a metabolic precursor with endogenous reactions by a statistical mechanical model, we computed the probability of each reaction with Δ′° through the Boltzmann distribution. We next took the logarithm of this probability and assigned it as the weight of this outgoing edge. While this type of statistical mechanics modeling has been widely applied in the context of gene regulation to capture the promoter states (–), it is, to our knowledge, novel in the context of the biosynthesis system design. This weighting scheme depends on a host organism and models the competition for metabolic precursors with the endogenous reactions. Importantly, this competition-based weighting scheme can capture the effects of competing endogenous reactions on heterologous reactions, while a thermodynamic favorability-based weighting scheme cannot. This can make their weight assignments widely different from each other (as illustrated in Figure ). A detailed description of this weighting scheme is given in Appendix. An illustration of differences between the thermodynamic favorability-based weighting scheme and our competition-based weighting scheme. Nodes are metabolites and edges are metabolic conversions via reactions. Red edges indicate native reactions, while blue edges indicate foreign reactions. () The thermodynamic favorability based approach. The value within a green oval for each edge represents the weight Δ′°/ where  is the gas constant and  is the absolute temperature. () The competition-based approach. For each edge, the value within a pink oval represents its weight. With this scheme, edges with the same Δ′° value can have different weights in a host-dependent fashion. For example, the weight of C1 → C3 is ln [/(1 +  + )], while that of C1 → C4 is ln [/(1 + )]. Biosynthesis pathways of interest are often those that transform a higher fraction of a starting material to a target product. One heuristic to rank pathways based on this productivity criterion is the net favorability of pathways. At a first glance, the net thermodynamic favorability can be seen as a good measure to rank pathways based on this criterion. However, this measure can only quantify the ratio of the target concentration to the source concentration at equilibrium, which may not correspond well with the true picture of the titer of the target product, especially when a given pathway has strong competing reactions and the equilibrium concentration of the starting material is substantially lowered. As described in the previous section, our reaction weighting scheme is based on the logarithm of normalized Boltzmann weights. Unlike thermodynamic favorability measure, this estimates a fraction of a given precursor that is converted into next intermediate metabolites. Thus, a pathway score based on the sum of all reaction weights in a given pathway can characterize the lower bound of a fraction of starting material that is converted into the product through this pathway, and this score can capture the productivity of each pathway more appropriately. Given the metabolic network graph with host-dependent weights, MRE exhaustively searches for biosynthesis paths from the given starting material to the given product and generates top- metabolic routes, each of which has at most  reaction steps. In this search, the compounds in the exclusion list are not considered as intermediate precursors of the product. To rank routes, MRE computes their scores by summing all reaction weights in each route and keeps  routes with the highest scores (as illustrated in Figure ). MRE transforms the metabolic route search problem into a classical computer science problem known as -shortest loopless path problem () and uses an efficient algorithm to solve it. The core part of the search was implemented in C++. An illustrative example to show differences in ranking outcomes between the thermodynamic favorability based approach and our new resource utilization competition-based approach. () A simplified metabolic network. Nodes are metabolites and edges are metabolic conversions. Red edges indicate native reactions, while blue edges indicate foreign reactions. The value within a green oval for each edge indicates Δ′°/ where  is the gas constant and  is the absolute temperature. Here, compound C1 is the starting metabolite, and compound C6 is the target product. There are three routes for this biosynthesis. () Ranking of the three biosynthesis routes with the thermodynamic favorability approach (the lower the score, the better) and our competition-based approach (the higher the score, the better). For example, the score of C1 → C4 → C6 is −1 + 2 = 1 with the former, whereas it is ln [/(1 + )] + ln [/(1 +  + )] = −2.44 with the latter. Computational performance analysis in the runtime environment To evaluate the computational performance of MRE, we measured its processing time in the runtime environment. To this end, we randomly selected 1000 reachable pairs of source and target compounds. With the setting of the largest reaction step size and the largest number of top-ranked pathways (i.e.,  = 20 and  = 500), it took less than 10 s for MRE to exhaustively explore routes and process queries on average. In 95% of the samples, the processing time was less than 20 s, and even in the worst case, it was just less than 30 s. With the default setting (i.e.,  = 8 and  = 50), the processing time was at most 1.36 s. Thus, we expect that the exhaustive pathway search employed in MRE will not compromise the user experience based on its processing time. As a case study, we applied MRE to search for pathways for various biosynthesis specifications using either  K-12 MG1655 or  as the host organism. Table  summarizes the top-ranked heterologous pathways that MRE discovered. This shows that, in biosynthesis of a range of high-value natural products, MRE was able to identify pathways that are known to be productive. We also analyzed the results by comparing them with those from four open-access web servers that can design heterologous biosynthesis pathways, namely, FMM (), Metabolic tinker (), PHT () and XTMS (). To explore biosynthesis pathways with these tools, we used their default configurations. Top-ranked pathways identified by MRE for various biosynthesis specifications Results of top-ranked pathway identified by MRE Predicted the native route () as the best, and found shorter routes For each biosynthesis specification, the source and target compounds are specified in KEGG ID, and the host organism is in KEGG organism code. For each pathway, the number of reaction steps and the necessary foreign enzymes(in EC number) are specified. Comparison with FMM (), Metabolic tinker (MT) (), PHT () and XTMS () is also shown. For each tool, its default setting was used, except for the configuration of a pathway length, which was set to accommodate known pathways. Tools that have identified at least one path for a given biosynthesis specification. Tools whose top-ranked pathway is the same as the top-ranked one from MRE. Naringenin is a plant secondary metabolite, which is reported to have various health benefits (), including high antioxidant capacities () and significant antiviral effects on the hepatitis C virus (). Owing to inefficiencies in the production of naringenin from natural plant sources, metabolic engineering to have an efficient microbial synthesis of this high-value natural product is thought to be a commercially viable alternative (,). In this analysis, we selected L-tyrosine (KEGG compound ID: C00082), an aromatic non-essential amino acid, as the starting material since a state-of-the-art heterologous naringenin production from L-tyrosine in an  strain is known (see Figure ). This heterologous biosynthesis route comprises four foreign enzymatic reactions. To analyze the performance of MRE in comparison with other tools, we applied two open-access biosynthesis pathway web servers, Metabolic tinker () and XTMS (). Since these two recently developed tools also rely on reaction thermodynamic data for their pathway ranking, we can also analyze the effects on our competition-based ranking scheme. Given this biosynthesis requirement, Metabolic tinker and PHT were not able to find any pathways, while XTMS generated a predicted pathway with hypothetical reactions as its top-ranked candidate. In contrast, the top-ranked route from MRE and FMM was identical to the state of the art. The pathway information given by MRE indicates that the third reaction in the pathway, which transforms p-coumaroyl-CoA into naringenin chalcone, is a bottleneck and competes for the availability of cofactor malonyl-CoA with a more favorable native reaction involved in the fatty acid biosynthesis in the  host (Figure ). This suggests that an increase in the concentration of malonyl-CoA or the inhibition of the fatty acid biosynthesis could enhance the productivity of this naringenin biosynthesis pathway. Indeed, previous studies demonstrated that both an increase in the availability of malonyl-CoA in the host and a decrease in the activities in the fatty acid pathway can increase the naringenin titers (,). While FMM was also able to identify the heterologous naringenin biosynthesis pathway that MRE found, the pathway information given by FMM was not helpful to find an optimization target as FMM does not have a feature to quantify the effects of competing reactions in the host. A heterologous biosynthesis pathway to produce naringenin from L-tyrosine in an  host. () The structure of an experimentally derived biosynthesis pathway (). The EC number for each reaction is indicated below the arrow. The KEGG compound ID of each metabolite is framed in red. The abbreviations are: tyrosine ammonia lyase (TAL); 4-coumarate:CoA ligase (4CL); chalcone synthase (CHS) and chalcone isomerase (CHI). () The information of the top-ranked biosynthesis pathway in MRE. Production of value-added chemicals from glycerol Glycerol is a readily available and relatively inexpensive chemical compound that can be generated in large amounts as a byproduct of biodiesel and bioethanol production processes (,). Because of its economic viability and long-term sustainability, fermentative production of high-value materials from glycerol has gained much attention recently (). By using glycerol as the starting material, we searched for pathways for the production of two value-added chemicals, 1,3-propanediol (1,3-PDO), a commodity chemical mainly used to make polyester fiber, and 1,2-propanediol (1,2-PDO), another high-demand commodity chemical used to make a wide range of products including antifreeze, thermoset plastics and cosmetics. We first applied MRE to search for pathways for the production of 1,3-PDO in  chassis. The top-ranked pathway that MRE identified is a known two-step heterologous pathway (), which requires the introduction of a glycerol dehydratase gene and a 1,3-propanediol dehydrogenase gene in the host (Figure ). Since the first glycerol dehydratase reaction competes for the utilization of glycerol against several native reactions including glycerol kinase, MRE predicts that this can be a target for productivity optimization. Metabolic tinker and XTMS were not able to find any pathways for the 1,3-PDO production, whereas FMM and PHT found the same pathway that MRE identified. We next applied MRE to search for pathways for the synthesis of R-1,2-PDO in the yeast chassis. We found that the top-ranked pathway (Figure ) was a known synthesis pathway for 1,2-PDO (). In this pathway, glycerol is first converted to dihydroxyacetone phosphate (DHAP) via two native enzymatic reactions. Methylglyoxal synthase then transforms DHAP into methylglyoxal, which is, in turn, converted into (R)-lactaldehyde. Finally, lactaldehyde reductase is used to produce R-1,2-PDO from (R)-lactaldehyde. FMM and PHT were not able to find any pathways that convert glycerol into R-1,2-PDO, whereas Metabolic tinker identified the same pathway that MRE found as the top-ranked one. Since XTMS focuses on the  chassis, we applied this tool to search for heterologous R-1,2-PDO production pathways in ; however, no pathways were found. Pathway-level graphs generated in MRE. () The top-ranked pathway for the production of 1,3-PDO from glycerol in . () The top-ranked pathway for the production of R-1,2-PDO from glycerol in yeast. () A known pathway and () top-ranked pathway for the production of artemisinic acid from acetyl-CoA in yeast. In these graphs, oval nodes represent compounds, while box nodes represent reactions. For compound nodes, red nodes are the starting material, green nodes are the target products and yellow nodes are other compounds. For reaction nodes, purple nodes are native reactions, cyan nodes are foreign reactions and gray nodes are competing native reactions. Artemisinic acid is an intermediate precursor for antimalaria drug artemisinin (,), and its production is often celebrated as one of the early success stories of the combination of metabolic engineering and synthetic biology (). This engineered biosynthesis pathway utilizes the endogenous mevalonate pathway in budding yeast to transform acetyl-CoA into farnesyl pyrophosphate (FPP), which is then converted into artemisinic acid with heterologous amorphadiene synthase and three-step oxidation reactions (,). To see if MRE could recover this engineered pathway, we applied it to explore pathways for the production of artemisinic acid from acetyl-CoA in yeast. We found that one of the top-ranked pathways that MRE generated was this known heterologous pathway (Figure ). Interestingly, the pathway that MRE identified as the top candidate (Figure ) was slightly different from the previously engineered pathway. The difference lies in how isopentenyl pyrophosphate (IPP) is converted into farnesyl pyrophosphate (FPP). In the top-ranked path, IPP is first converted into (2Z,6Z)-farnesyl diphosphate (Z,Z-FPP). This route is chosen because IPP is a precursor of a thermodynamically highly favorable native reaction, and the conversion reaction from IPP to Z,Z-FPP is much more favorable than that from IPP to FPP, enabling a higher fraction of IPP to be utilized in the route. By using Z,Z-FPP as the precursor, this route introduces three foreign carbon-oxygen lyases to form FPP. FMM, Metabolic tinker and PHT were not able to find any pathways. XTMS found a partial pathway that converts FPP into artemisinic acid, albeit it is for the  chassis. In this paper, we introduced MRE, an open-access biosynthesis design tool, that searches for promising metabolic routes for a given biosynthesis specification and suggests exogenous enzymes for heterologous biosynthesis pathways based on the infrastructure of an endogenous metabolic system. A main limitation of MRE is its reliance on the data sources (mainly KEGG) to mine verified metabolic reactions and to search for biosynthesis routes based on them. Indeed, while painstaking effort has resulted in a large collection of annotated metabolic reaction data, among the 9910 reactions in the KEGG REACTION database (Release 76.0), we found 1272 with no EC numbers, 1079 with partial EC numbers and 2170 with no annotations for associated genes. While this deficiency can prevent MRE from finding promising biosynthesis pathways, we expect the number of verified reactions in KEGG to increase over time and this issue to be alleviated eventually. At the same time, we are considering an option to also integrate other metabolic reaction databases such as Rhea () in a future release. Several existing tools took an approach to expand a list of metabolic parts in hand by defining specific transformation rules (,,), albeit such rules can be subjective (). To design biosynthesis systems, this approach relies on the prediction of metabolic parts with specific metabolic activities, which may or may not exist. Thus, the design of biosynthesis systems via this top-down approach may require the  design of unnatural proteins to achieve specific metabolic activities. MRE was, on the other hand, developed to suggest actual enzymes for heterologous pathways. Thus, it takes a complementary, bottom-up approach in which a biosynthesis system is designed by using well-characterized metabolic parts. To this end, we made a conscious decision to use only verified reactions. Here, by using the biosynthesis of a range of high-value natural products as a case study, we have shown that MRE can suggest promising heterologous biosynthesis pathways and provide useful information to pinpoint bottlenecks of pathways. In summary, with the host-dependent competition-based pathway ranking scheme along with the suggestion of foreign enzymes with competing endogenous reactions, MRE is expected to offer novel insights into the design and optimization of heterologous biosynthesis systems..