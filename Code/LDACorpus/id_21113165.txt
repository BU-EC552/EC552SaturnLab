The synthesis of DNA encoding regulatory elements, genes, pathways, and entire genomes provides powerful ways to both test biological hypotheses as well as harness biology for our use. For example, since the use of oligonucleotides in deciphering the genetic code, to the recent complete synthesis of a viable bacterial genome, DNA synthesis has engendered tremendous progress in biology. Currently, almost all DNA synthesis currently relies on the use of phosphoramidite chemistry on controlled-pore glass (CPG) substrates. The synthesis of gene-sized fragments (500–5,000 basepairs) relies on assembling many CPG-oligonucleotides together using a variety of techniques termed gene synthesis. Technologies to assemble verified gene-sized fragments into much larger synthetic constructs are now fairly mature,,,,. The price of gene synthesis has reduced drastically over the last decade. However, the current commercial price of gene synthesis, ~$0.40–1.00/basepair (bp), has begun to approach the relatively stable cost of the CPG oligonucleotide precursors (~$0.10–0.20/bp). At these prices, the construction of large gene libraries and synthetic genomes is out of reach to most. To achieve further cost reductions, many ongoing efforts focus on reducing the cost of the oligonucleotide precursors. For example, microfluidic oligonucleotide synthesis can reduce reagent cost by an order of magnitude and has been used for proof-of-concept gene synthesis. Another promising route is to harness existing DNA microchips, which can produce up to a million different oligonucleotides on a single chip, as a source of DNA. Previous efforts have demonstrated the ability to synthesize genes from DNA microchips,,,. These approaches have thus far failed to scale for at least three reasons. First, the error rates of chip-based oligonucleotides from DNA microchips are higher than traditional column-synthesized oligonucleotides. Second, the assembly of gene fragments becomes increasingly difficult as the diversity of the oligonucleotide mixture becomes larger. Finally, the potential for cross-hybridization between individual assemblies imposes strong constraints on the sequences that can be constructed on an individual microchip. Recently, LeProust et al. improved the quality of microchip-synthesized oligonucleotides by controlling depurination during the synthesis process. These arrays produce up to 55,000 200mer oligonucleotides on a single chip and are sold as a ~1–10 picomole pools of oligonucleotides termed OLS (Oligo Library Synthesis). Several groups have used OLS pools for use in DNA capture technologies, promoter analysis, and DNA barcode development,,,,. We have previously shown that individual oligonucleotides in a 55,000 150mer OLS pool were evenly distributed. We reanalyzed this data set to provide a rough estimate of the error rates (see Methods online) and found the error rate of this OLS pool was ~1/500bp both before and after PCR amplification, suggesting that the OLS pools can be used for accurate large-scale gene synthesis (see  online). We used these OLS pools to test if they would provide a better starting point for more scalable DNA microchip-based gene synthesis methods. We designed two OLS pools (OLS Pools 1 & 2) of different lengths, each containing ~13,000 130mer or 200mer oligonucleotides respectively.  is a general schematic of our methods for utilizing OLS pools in a gene synthesis platform. Briefly, we designed oligonucleotides that were then printed on DNA microchips and recovered as a mixed pool of oligonucleotides (OLS Pool). Next, we took advantage of the long oligonucleotide lengths to independently PCR amplify and process only those oligonucleotides required for a given gene assembly. For the 200mer OLS Pool 2, we first amplified a “plate subpool” that contained DNA to construct up to 96 genes, and then amplified individual “assembly subpools” to separate the oligonucleotides for an individual gene. For the 130mer OLS Pool 1, we directly amplified into assembly subpools, foregoing the plate subpool step. Next, the primers used for these amplification steps were removed by either Type IIS restriction endonucleases to form double-stranded DNA (dsDNA) fragments (OLS Pool 2), or a combination of enzymatic steps to form single-stranded DNA (ssDNA) fragments (OLS Pool 1). Finally, we used PCR assembly to construct full-length genes, performed enzymatic error correction to improve error rates if necessary, and finally cloned and characterized the constructs. Obtaining subpools of only those DNA fragments required for any particular assembly is crucial for robust gene synthesis in very large DNA backgrounds. In addition, isolating subpools relieves constraints on sequence similarity inherent in past approaches. To facilitate this, we designed 20mer PCR primer sets with low potential cross-hybridization (“orthogonal” primers) derived from a set of 244,000 25mer orthogonal sequences developed for barcoding purposes. Two separate orthogonal primer sets were constructed for the different OLS pools because of their varying requirements for downstream processing. Both sets were screened for potential cross-hybridization, low secondary structure, and matched melting temperatures to construct large sets of orthogonal PCR primer pairs. To construct genes from the OLS pools, we developed automated algorithms to split the sequence into overlapping segments with matching melting temperatures such that they could be later assembled by PCR. Genes on OLS Pool 1 and 2 were designed differently to test the effect of different overlap lengths. We designed genes on OLS Pool 1 such that the processed ssDNA pools fully overlapped to form a complete dsDNA sequence. In OLS Pool 2, the processed dsDNA fragments partially overlapped by ~20 bp and can be assembled into a contiguous gene sequence using PCR. We initially constructed a set of fluorescent proteins to test the efficacy of the gene synthesis methods on both OLS Pools. For OLS Pool 1, we designed two independent “assembly subpools” that encoded for GFPmut3b plus flanking orthogonal primer sequences that are later used for PCR assembly (“construction primers”). The two assembly subpools, GFP43 and GFP35, differed in the average overlap length (43 and 35 bp, respectively), total length (82–90 and 64–78 bases, respectively), and number of oligonucleotides (18 and 22, respectively). We also designed two subpools, Control Subpools 1 and 2, containing ten and five 130mer oligonucleotides, respectively, to test amplification efficacy. The other eight subpools, containing a total of 12,945 130mer sequences, were constructed on the same chip but were not used in this study except to provide potential sources of cross-hybridization. Each of these 12 subpools was flanked with independent orthogonal primer pairs (“assembly-specific primers”). As a control, we used these same algorithms to design a set of shorter CPG oligonucleotides (20 bp average overlap; 35–45 bases in length; and 39 total oligonucleotides) encoding GFPmut3b and obtained them from a commercial provider (IDT). These oligonucleotides were combined to form a third pool that was also tested (“GFP20”). All synthesized oligonucleotides used in the study can be found in the  online. Each of the four subpools (GFP43, GFP35, Control 1, and Control 2) were PCR amplified from the synthesized OLS pool using modified primers that facilitated downstream processing (see  online). The oligonucleotides were then processed to remove primer sequences (see  online). Briefly, lambda exonuclease was used to make the PCR products single stranded, and then uracil DNA glycosylase, Endonuclease VIII, and DpnII restriction endonuclease were used to cleave off the assembly-specific primers. The resultant gel shows that while the reaction was efficient, unprocessed oligonucleotide still remained. In addition, we observed spurious cleavage by DpnII that was likely due to the extensive overlap within the subpool that is inherent in the gene synthesis process. We assembled the GFP43, GFP35, and GFP20 subpools using PCR, which resulted in GFP-sized products as well as many incorrect low molecular weight products (). We gel isolated, digested, and then cloned the assembly products into an expression vector ( and  online). We used flow cytometry tests, manual colony counts, and sequencing of individual clones to measure the error rates (see  online). All three of the assays correlated well, and the error rates determined through sequencing were 1/1,500 bp, 1/1,130 bp, and 1/1,350 bp for the GFP43, GFP35, and GFP20 synthesis reactions, respectively (See  and  online). These results demonstrated a number of important findings. First, our subpool assembly primers were sufficiently well-designed to provide stringent subpool amplification of as few as 5 oligonucleotides out of a 12,995 oligonucleotide background. Second, the relative quantities of the oligonucleotides in the assembly subpools were sufficient to allow PCR assembly. Third, the error rates from 130mer OLS pools are sufficient to construct gene-sized fragments (717 bp) such that >50% of the sequences will be perfect. In fact, the error rates from both the GFP43 and GFP35 assemblies were indistinguishable from the column-synthesized GFP20 assemblies. Fourth, our data showed that the level of fluorescence of our gene assemblies correlated with the number of constructs with perfect sequence, providing a useful screen to test fluorescent gene assemblies in OLS Pool 2 (see  online). Finally, while PCR assembly was able to generate full-length product, many smaller misassembled products were also formed, requiring the use of difficult-to-automate gel isolation steps. In OLS Pool 2, we designed 836 assembly subpools split into 11 plate subpools, encoding 2,456,706 bases of oligonucleotides that could potentially result in 869,125bp of final assembled sequence. We first constructed three fluorescent proteins to test assembly protocols in OLS Pool 2: mTFP1, mCitrine, and mApple. We found that the PCR assembly protocols developed for ssDNA subpools in OLS Pool 1 only produced short (<200 bp) misassemblies when applied to the dsDNA subpools in OLS Pool 2. We tested over 1,000 assembly PCR conditions by varying parameters such as DNA concentration, annealing temperatures, cycle numbers, polymerase choice, and buffer conditions. Using the best protocol (see ), we assembled the three genes with no detectable misassemblies, thereby removing the need for gel isolation ( and ). Cloning followed by flow cytometry screening showed that 6.8%, 7.5%, and 6.8% of the cells were fluorescent for mTFP1, mCitrine, and mApple assemblies, respectively (see ). Assuming 6% correct sequence per construct and no selection against errors in the assembly process, the error rate was ~1/250 bp for 200mer OLS Pool 2, significantly above that of the estimates for 130mer OLS Pool 1 (~1/1000 bp) and the sequenced 55K 150mer OLS pool (~1/500 bp). This is not completely unexpected, as the amount of depurination is dependent upon the number of deprotection steps during synthesis and thus the oligonucleotide length. Despite the higher error rate, there were several advantages to the 200mer OLS Pool 2. First, the extensive overlaps designed in OLS Pool 1 caused spurious processing of the primers from the assembly subpools. The use of Type IIs restriction endonucleases to process primers to form dsDNA resulted in more robust processing. Second, the use of two amplification steps conserves chip-eluted DNA to allow for future scaling of the gene synthesis process (See ). Third, the assemblies of OLS Pool 1 produced many smaller bands and required lower-throughput gel isolation procedures. This could be due to mispriming during PCR assembly because of the long overlap lengths used in the design process. The assemblies in OLS Pool 2 used much shorter overlap lengths, and resulted in no smaller molecular weight misassembled products. In order to improve the error rates of the genes assembled from OLS Pool 2, we used ErrASE, a new commercially-available enzyme cocktail, to remove errors in the assembled fluorescent proteins. For each gene, we applied ErrASE at six different stringencies, re-amplified the constructs, cloned the PCR products, and re-screened the cloned genes using flow cytometry. Improvement of the level of fluorescence progressively increased with increased ErrASE stringency. At the highest levels of error correction, the fluorescence levels were 31%, 49%, and 26% for mTFP1, mCitrine, and mApple respectively (see  and  online). We also performed the ErrASE procedure on our GFP43 and GFP35 pools from OLS Pool 1, resulting in fluorescence levels of 89% and 92% respectively ( and ). We sequenced clones of GFP43 and GFP35 and found 3 errors in 21,510 (1/7170 bp) and 4 errors in 20,076 (1/5019 bp) sequenced bases, respectively. As a more challenging test for our DNA synthesis technology, we designed and synthesized oligonucleotides for 42 genes encoding single-chain Fv (scFv) regions corresponding to a number of well-known antibodies in OLS Pool 2. We have previously had trouble synthesizing these genes using commercial gene synthesis companies. This might be partly due to the prototype (Gly4Ser)3 linker, which is designed to maximize flexibility and allow the heavy and light V regions to assemble. The repetitive nature and high GC content of the linker-encoding sequences often represents a challenge for accurate DNA synthesis. We therefore tested three different linker sequences that varied in GC content and repetitive character of the linker encoding sequence. In addition, the presence of high sequence homology in the antibody backbones and linkers represented a potential source of cross-hybridization that could interfere with assembly. Supplementary Figs. 7c, 9, and 10a As expected, the antibody sequences did not assemble as robustly as the fluorescent proteins and thus we further optimized the conditions during pre-and post-assembly (see  online). Under the best protocol, 40of the 42 constructs assembled to the correct size (see  and  online). The two misassembled genes displayed faint bands at the correct size, which were gel isolated and reamplified to produce strong bands of the correct size. We sequenced 15 antibodies including representatives from all three linker types. We performed enzymatic error correction using ErrASE, gel isolated the product and finally cloned the constructs into an expression vector. One of the 15 antibodies did not clone, and another had a deleted linker region in all 21 sequenced clones. Both of these antibodies were encoded with the highest GC content linker. The average error rate of the 14 antibodies that did clone was1/315 bp (see  and  online); this was significantly higher than the GFP assemblies, but still sufficient for construction of genes of this size (~10% clones should be perfect on average). In addition, sequence analysis showed no instances of subpool cross-contamination during the assembly process. Our results show for the first time the assembly of gene-sized DNA fragments totaling ~35,000 bp from oligonucleotide pools of more than >50 kilobases. A number of key features are important to make the process work including the use of low-error starting material, well-chosen orthogonal primers, subpool amplification of individual assemblies, optimized assembly methods, and enzymatic error correction. We describe two separate OLS pool lengths and assembly methods, which have their own advantages and disadvantages (see  online). The shorter, 130mer OLS Pool 1 assemblies have lower error rates, but because there are no plate amplifications, will be harder to scale as we begin to utilize larger OLS pools. The longer 200mer OLS Pool 2 is easier to scale, but contained higher error rates. The costs of oligonucleotides in both processes are less than $0.01/bp of final synthesized sequence, and thus the dominant costs are enzymatic processing, cloning, and sequence verification. Future work on lowering cost of perfect sequence will focus on the ability to lower sequencing costs such as by using cheaper next-generation sequencing technologies, or by incorporating other error-correction techniques such as PAGE selection of oligonucleotide pools or mutS-based error filtration,. Reanalysis of OLS Pool Error Rates We reanalyzed a previously published data set for determining sequencing error rates. Briefly, the dataset was derived from high-throughput sequencing using the Illumina Genome Analyzer platform of a 53,777 150mer OLS pool. Two sequencing runs were performed; the first before any amplification, and the second after two rounds of ten cycles of PCR (20 cycles total). As our previous analyses were mostly looking for distribution effects, we reanalyzed this existing data to get an estimate of error rates pre-and post-PCR amplification. We realigned the dataset using Exonerate to allow for gapped alignments and analysis of indels. Specifically, we used an affine local alignment model that is equivalent to the classic Smith-Waterman-Gotoh alignment, a gap extension penalty of -5, and used the full refine option to allow for dynamic programming based optimization of the alignment. These reads were solely mapped on base calls by the Illumina platform. We used these alignments to count mismatches, deletions, and insertions as compared to the designed sequences. However, since base-calling can be more error prone on next generation platforms than traditional Sanger-based approaches, we filtered the results based only on high-quality base-calls (Phred scores of 30 or above or >99.9% accuracy). This was accomplished by converting Illumina quality scores to Phred values using the Maq utility sol2sanger and only using statistics from base calls of Phred 30 or higher. All error rate analysis scripts were implemented in Python and are available upon request. While this method provides an estimate for error rates, unmapped reads may have higher error rates and thus underestimating the total average error rate. In addition, base-calling errors might still overestimate the error rate. Finally, using only high-quality base calls, which usually occur only in the first 10 bases of a read, might only reflect error rates on the 5′ end of the synthesized oligonucleotide. Design and Synthesis of OLS Pools The 13,000 oligos in the first OLS library (“OLS Pool 1”) were broken up into 12 separately amplifiable subpools (“assembly subpools). Each assembly subpool was defined by unique 20 bp priming sites that flanked each of the oligos in the pool. The priming sites were designed to minimize amplification of oligos not in the particular assembly subpool. This was done by designing set of orthogonal 20-mers (“assembly-specific primers”) using a set of 240,000 orthogonal 25-mers designed by Xu . as a seed. From these sequences we selected 20-mers with 3′ sequence ending in thymidine or ‘GATC’ for the forward and reverse primers respectively. We screened for melting temperatures between 62–64 °C and low primer secondary structure. After the additional filtering, 12 pairs of forward and reverse primers were chosen to be the assembly-specific primers. The 13,000 oligos in the second OLS library (“OLS Pool 2”) were broken up into 11 subpools corresponding to 11 sets of up to 96 assemblies (“plate subpools”), which were further divided into a total of 836 assembly subpools. A new set of orthogonal primers were designed similarly to the previous set (without the GATC and thymidine constraints) but further filtered to remove Type IIS restriction sites, secondary structure, primer dimers, and self-dimers. The final set of primer pairs was distributed among the plate-specific primers, assembly-specific primers, and construction primers. See  online for more detailed design information and primer sequences. OLS pools were synthesized by Agilent Technologies, and are available upon signing a Collaborative Technology Development agreement with Agilent. Costsof OLS pools area function of the number of unique oligos synthesized and of the length of the oligos (<$0.01 per final assembled base-pair for all scales used in this study). OLS Pools 1 and 2 were independently synthesized, cleaved, and delivered as lyophilized ~1–10 picomole pools. Amplification and processing of OLS subpools Lyophilized DNA from OLS Pools 1 and 2 were resuspended in 500 μL TE. Assembly subpools were amplified from 1 μL of OLS Pool 1 in a 50 μL qPCR reaction using the KAPA SYBR FAST qPCR kit (Kapa Biosystems). A secondary 20 mL PCR amplification using Taq polymerase was performed from the primary amplification product. The barcode primer sites were removed using a technique previously described. In brief, the forward primers contained a phosphorothioate bond at the 5′ end and the last nucleotide on the 3′ end was a deoxyuridine; the reverse primers contained a DpnII recognition site (‘GATC’) at the 3′ end and a phosphorylated 5′ end. PCR amplification was followed by γ exonuclease digestion of 5′ phosphorylated strands, hybridization of the 3′ primer site to its complement, and cleavage of the 5′ and 3′ primer sites using USER enzyme mix and DpnII (New England Biolabs), respectively. Plate subpools were amplified from1 μL of OLS Pool 2 in 50 μL Phusion polymerase PCR reactions. Assembly subpools were amplified from the plate subpools by 100μL Phusion polymerase PCR reactions. A BtsI digest removed the forward and reverse primer sites. See the  online for more detailed protocols. Assembly of fluorescent proteins GFPmut3 was assembled from the OLS Pool 1 assembly subpools by PCR. The GFP43 and GFP35 subpools were designed such there was full overlap between neighboring oligos during assembly, with average overlaps of 43 bp and 35 bp for GFP43 and GFP35, respectively. For the first set of assemblies, 330 pg of the GF43 subpool or 40 pg of the GFP35 subpool were used per 20 μL Phusion polymerase PCR assembly. The full-length product was gel-isolated, amplified using Phusion polymerase, and cloned into pZE21 after a HindIII/KpnI digest. The second set of assemblies was built using a similar procedure, except that the assembly PCR used 170 pg or 190 pg of GFP43 and GFP35 subpools, respectively; and the gel-isolated product was not re-amplified prior to cloning. Oligonucleotides for mTFP1, mCitrine, and mApple were designed such that there was on average a 20 bp overlap between adjacent oligonucleotides. The proteins were built from OLS Pool 2 assembly subpools by first performing a KOD polymerase pre-assembly reaction that was done in the absence of construction primers followed by a KOD polymerase assembly PCR in which the construction primers were included. ErrASE error correction was then performed on aliquots of the synthesis products following the manufacturer’s instructions. The assembled product was digested with HindIII and KpnI and cloned into pZE21. Sequencing of clones was performed by Beckman Coulter Genomics. See the  online for more detailed protocols. ErrASE is an enzyme cocktail designed to remove errors in synthetically assembled genes (Novici Biotech, Vacaville CA). Assembled genes are denatured and re-annealed to allow for the formation of hetero-duplexes. A resolvase enzyme in ErrASE then recognizes and cuts at mismatched positions. Other enzymes in the cocktail remove these cut mismatched positions. The products could then be reamplified by PCR to reassemble the full-length gene. Specifically, sixaliquots of 10–50 ng of each assembled gene was added to 10 μL of PCR buffer (we have also tested the effects of including betaine in the buffer see ). Hetero-duplexes were formed by denaturing at 95°C and slowly cooling to room temperature. Each aliquot was then used to resuspend six different lyophilized ErrASE mixtures of increasing stringency provided by the manufacturer. After a 1–2 hour room temperature incubation, the assemblies were re-amplified and visualized on an agarose gel. Of the reactions that resulted in a correctly-sized band, the one that used the most stringent ErrASE protocol was selected for cloning. Fluorescent cell fractions of the cloned libraries of assembly products were quantified using a BD LSR Fortessa flow cytometer either a 488 nm laser with a 530 nm filter (30 nm bandpass) or a 561 nm laser with a 610 nm filter (20 nm bandpass). 125 ng of each antibody assembly pool was pre-assembled in 20 μL KOD pre-assembly reactions. We then tested 9 amplification protocols for the ability to amplify the 42 antibody pre-assemblies into full-length genes. We attempted to clone 8 constructs from the best assembly protocol (afutuzumab, efungumab, ibalizumab, oportuzumab, panobacumab, robatumumab, ustekinumab, and vedolizumab; see  and ). The 8 assemblies were error-corrected using ErrASE, gel-isolated, re-amplified using Phusion polymerase, gel-isolated again, and cloned into pSecTag2A after an ApaI/SfiI digest. Sequencing was performed by Genewiz. All but oportuzumab cloned successfully. We then repeated the experiment, increasing the amount of assembly pool DNA in the pre-assembly reaction to 400 ng. We selected a different set of 8 constructs from this second set of assemblies for cloning (abagovomab, alemtuzumab, ranibizumab, cetuximab, efungumab, pertuzumab, tadocizumab, and trastuzumab; see  and ). Using the same methods as with the first set of cloned antibodies, this second set was error-corrected, gel-isolated, cloned, and sequenced. See the  online for more detailed protocols..