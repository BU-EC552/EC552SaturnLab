Metal ion pollutants are commonly found in soil, water, and crops. With the recent industrial expansion, wastewater containing heavy metal increasingly contaminates our living surroundings [–]. Furthermore, non-degradable heavy metals may accumulate in food chains, and the resulting toxicity damages organisms [–]. Hence, detection techniques have gradually begun to receive attention. Recent progress in research on synthetic biology offers an alternative means for metal ion detection via the help of promoter elements, such as P and P derived from .   or P acquired from . [, ]. To make the design of detectors easier, it is necessary to develop a method to evaluate and select adequate components for achieving a desired detection performance. In recent years, large numbers of genetic tools and engineering approaches have been and still are being developed for metal ion biosensors. Synthetic biologists are forced to find interchangeable parts, such as promoters, ribosome binding sites (RBSs), and regulatory sequences, that can be validated as construction units and assemble devices. The ability to quickly and reliably engineer biological systems from libraries of standard interchangeable parts is one trademark of modern technology [–]. Thus, to build a metal ion biosensor for a specified purpose, one may need a systematic design process that begins with the specification, which states the desired goal and technical details. Based on the specification, the biosensor is then represented by a block diagram which consists of functional units of the system. At later stage the design is evaluated and verified its feasibility via computational simulations and experimental validations until the configuration and combination of biological parts reach suitable performance . Although a great deal has been accomplished in a short time, engineering a metal ion biosensor to produce a desired behavior still remains an acute problem, due to the uncertainties and fluctuations at the molecular level [–]. Recently, applying the analysis of nonlinear stochastic molecular systems to evaluate the flexibility of combinations of biological parts has been a subject of considerable interest. A multi-objective H/H performance criterion is derived here for the design specifications of a metal ion biosensor to achieve the H optimal tracking of a desired I/O response and H optimal attenuation of parameter fluctuations and cellular noise simultaneously. Based on the design specifications, the optimal design of the biosensor can be solved by an associated Hamilton Jacobi inequality (HJI)-constrained optimization problem, which cannot be easily achieved by present analytical or numerical methods. In order to simplify the analysis and design of a nonlinear stochastic metal ion biosensor with multi-objective H/H performance, a Takagi-Sugeno (T-S) fuzzy model is employed here to interpolate several local linear stochastic systems to approximate the nonlinear stochastic metal ion biosensor system. This allows the HJI-based design problem to be replaced by a linear matrix inequality (LMI)-based design problem. Thus, the multi-objective H/H I/O response matching design of a synthetic biosensor then can be achieved by solving a LMIs-constrained multi-objective optimization problem. However, there are tradeoffs between the H and H performances. As natural selection is an important mechanism in defining traits best suited to environmental change in the face of evolutionary trade-offs , one question that arises is whether a similar strategy could be adopted for multi-objective design problems. Inspired by biological evolution events, such as mutation, crossover, and selection, a multi-objective evolutionary algorithm (MOEA) is a method to determine non-dominated Pareto optimal solutions [, ]. In particular, MOEA is useful when considering the tradeoffs between design factors under consideration in multi-objective H/H design problems. Consequently, according to the criterion required for the user-oriented specifications, the design can be constructed by selecting adequate components with the help of a multi-objective evolutionary algorithm (MOEA)-based searching method. In summary, this study provides a systematic design method for developing next-generation synthetic biology, from biological component selection to genetic circuit assembly. When the component libraries are more complete, more precise detection for metal ion can be achieved. The contributions of this paper are fourfold. (a) A nonlinear stochastic system is introduced to model a metal ion biosensor with intrinsic parameter fluctuations and extrinsic molecule noise. (b) A multi-objective (MO) H/H I/O response matching performance criterion is derived to fit the design specification for a metal ion biosensor, which achieves the H optimal tracking of a desired I/O response and H optimal robust attenuation of parameter fluctuations and cellular noise simultaneously. (c) By solving a LMIs-constrained optimization problem, a metal ion biosensor can be constructed, which achieves the H/H multi-objective design by selecting adequate components from existing libraries. (d) The proposed MOEA-based search method provides synthetic biologists with a useful tool for the design of metal ion biosensors, particularly in the face of tradeoffs between the design factors considered in next-generation synthetic biology. For the convenience of description and explanation, as shown in , the metal ion biosensor is assembled by selecting a set of promoter-RBS components from the corresponding component libraries in . The assembly included a metal ion-induced promoter-RBS component  from the component library in Table A in , a constitutive promoter-RBS component  from the component library in Table B in , and a quorum sensing (QS)-dependent promoter-RBS component  from the component library in Table C in . The metal ion-induced promoter-RBS  connects downstream with the LuxI coding sequence, the production of which synthesizes a specific N-acylated homoserine lactone (AHL) as a signal molecule [–]. The LuxR coding sequence is connected to the constitutive promoter-RBS component . When a sufficient amount of the LuxR protein is produced in the presence of AHL, AHL binds to the LuxR protein to form a complex [, , ]. The complex targets the cognate QS-dependent promoter-RBS component  and thereby activates transcription of the green fluorescent protein (GFP) coding sequence. The dynamic model of the metal ion biosensor in  can then be described as follows:

in which

where , , , and  denote the concentrations of autoinducer synthase, autoinducer, transcriptional activator protein, and immature reporter protein, respectively, and  denotes the intensity of GFP fluorescence.  is the concentration of metal ions and  is the total concentration of the metal ion-dependent regulatory protein.  denotes the complex of  and , while  represents the complex of  and . (,
,), (,0,0,0), and (,,,) are the activities of the metal ion-induced promoter-RBS component, the constitutive promoter-RBS component, and the QS-dependent promoter-RBS component, respectively.  and  are the maximum and minimum promoter-RBS strengths of the  metal ion-induced promoter-RBS component in Table A in ;  is the promoter-RBS strength of the  constitutive promoter-RBS component in Table B in , and  and  are the maximum and minimum promoter-RBS strengths of the  QS-dependent promoter-RBS component in Table C in .  denotes the degradation rate for autoinducer synthase,  denotes the degradation rate for the autoinducer itself,  denotes the degradation rate for the transcriptional activator protein,  denotes the degradation rate for the immature reporter protein, and  denotes the degradation rate for the mature reporter protein.  is the dilution rate due to cell growth.  is the autoinducer synthesis rate.  is the maturation rate for the reporter protein.  and  denote the binding affinity and binding cooperativity between the  complex and the corresponding promoter-RBS component, respectively.  is the dissociation rate between the metal ion  and the metal regulatory protein .  and  are the binding affinity and binding cooperativity between the  complex and the promoter-RBS part, respectively.  is the dissociation rate between the autoinducer  and the transcriptional activator protein . However, biological components are inherently uncertain in a molecular biological system. For example, the kinetic parameters of the components, including the processes of transcription and translation, the degradation rates of regulatory proteins, dilution rates of the cells, and the maturation rates for the reporter proteins, are all stochastically uncertain  as a result of gene expression noise from biochemical processes, thermal fluctuations, DNA mutation, and evolution. Additionally, a synthetic gene circuit  also suffers from environmental molecular noise. Therefore, the equations in () should be modified as follows:

where Δ, Δ, Δ, Δ, Δ, Δ, Δ, Δ, Δ, Δ, Δ, Δ, and Δ are the standard deviations of the corresponding stochastic parameters and () is Gaussian noise, which has a mean of zero and unit variance, and accounts for sources of random fluctuation. The Gaussian noise parameters ,  = 1, 2, 3, 4, with a zero mean and variance of , are molecular noise for both the transcriptional and translational gene expression processes.  denotes molecular noise in mature protein expression. Consequently, the whole QS-based metal ion biosensor is expressed by (), which can also be represented by the more generalized nonlinear ordinary differential equation:

where () represents the state vector of the QS-based metal ion biosensor. (,) is the output vector. () is extrinsic molecular noise from the environment.  (,,) is the set of promoter-RBS components selected from the corresponding component libraries in Tables A, B, and C in . ((),,) is a smooth nonlinear function that characterizes the behavior of the QS-based metal ion biosensor. ((),,)() is the intrinsic parameter fluctuations of the QS-based metal ion biosensor.  denotes the noise-coupling matrix.  is the output matrix. For the convenience of analysis and design of the QS-based metal ion biosensor inserted into host cells, the nonlinear stochastic differential equation of metal ion biosensor in () can be represented by the following Ito’s stochastic differential equation:

where () is a standard Wiener process or Brownian motion with () = () to represent the random parameter fluctuations of the synthetic gene circuit. In general, () in () is dependent on , i.e., the solution of () can be represented by (, ). If the output (,) is the last state of metal ion biosensor, then  = [0,0,0,0,1]. The purpose of our design is to construct a metal ion biosensor by selecting a set of suitable components from the corresponding libraries to achieve optimal matching of a desired I/O response and minimize the effect of external disturbance and noise simultaneously within a feasible range of metal ion concentrations, i.e., to achieve optimal H matching and optimal H disturbance filtering simultaneously. To achieve this, the following design specifications are needed: where () is the desired reference state, () is the output vector of the desired reference model, (,) represents a desired steady state trajectory for (),  is a matrix to be specified for the transient behavior of (), and  is the output matrix of the desired reference model. In general,  = . At the steady state, () = -(,). If we set  = -, then at the steady state, (,) = (,). Therefore, if the desired steady state (,) of the metal ion biosensor in () is set as (,) and we could select an adequate set  of components from the corresponding libraries so that the stochastic dynamic Eq () of the metal ion biosensor could match the desired reference model in (), i.e., at the steady state, () = -(,) and the I/O response is given by  = -(,). where  is the weighting matrix and  is the output of the following augmented system:

and Since the reference signal () is treated as an uncertain external input by the designer, it account for sources of noise. Thus, if the H matching performance and H filtering performance in () and () are minimized simultaneously by choosing an appropriate set of components from the corresponding component libraries in , the engineered metal ion biosensor will then optimally match the specified I/O response and optimally filter parameter fluctuations and environmental disturbances simultaneously, i.e., to select a component set  from component libraries in  to solve the following simultaneous minimization problem:

where () and () are defined in () and (), respectively. To make the design easier, an indirect method is proposed by simultaneously minimizing the upper bounds of () and (), i.e., the multi-objective problem in () is transformed to a suboptimal problem as follows:

subject to


where  and  are the upper bounds of H and H performances, respectively. H performance in () can be considered as the penalty of the quadratic matching error under the assumption () ≡ 0 and  in () denotes the upper bound of H performance under the assumption () ≡ 0. The inequality in () means that the effect of extrinsic molecular noise on the matching error is less than  from an average energy point of view. Because the statistics of extrinsic molecular noise may be unavailable or uncertain, it is very difficult to obtain the noise filtering ability * for all possible extrinsic noise () directly and only the upper bound  of the noise-filtering ability * can be given in () at first. Similarly, the upper bound  of  is also given. We will then decrease the upper bound (, ) to as small a value as possible to approach the lower bound (, ), i.e., to get (, ) by minimizing (, ) indirectly. If the extrinsic environmental molecular noise () is deterministic, then the expectation on () in () and () should be disregarded. If the initial condition (0) is considered, then the noise-filtering upper bound in () should be modified as follows:

for some Lyapunov function ((0)), i.e., the energy due to the initial condition (0) should be considered in the effect of noise [, ]. Based on the multi-objective H/H design criterion, we obtain the following result for the QS-based metal ion biosensor design. The multi-objective I/O matching problem in ()–() is equivalent to how to select components , , and  of the metal ion biosensor from the corresponding component libraries in  to solve the following HJI-constrained multi-objective problem:

subject to


with (())>0 and ((0))<, i.e., the I/O response of an engineered metal ion biosensor will optimally match the specified I/O response of the reference model and optimally filter intrinsic fluctuations and external disturbances simultaneously. It is still very difficult to solve the constrained multi-objective minimization in () to simultaneously achieve the optimal matching of the specified reference output in () and optimal filtering of parameter fluctuations and environmental disturbances. Recently, the fuzzy dynamic model has been widely used to interpolate local dynamic models to efficiently approximate a nonlinear dynamic system [, ]. Hence, in this situation, we employ the T-S fuzzy model to interpolate several linear systems at different local operation points to efficiently and globally approximate the augmented nonlinear system in () so that the design procedure for a multi-objective optimal design of a synthetic metal ion biosensor can be simplified. In this study, the T-S fuzzy method is employed to simplify the analysis and design procedure for the QS-based metal ion biosensor under intrinsic parameter fluctuations and extrinsic environmental molecular noise. The T-S fuzzy model is described by fuzzy if-then rules. The  rule of the fuzzy model for the augmented system in () is proposed in the following form [, , ]:

for  = 1,2,…,, where  is the element of premise variables of the  augmented system, i.e., z = [,…,],  is the fuzzy set,  and  are the fuzzy system matrices,  is the number of if-then rules, and  is the number of premise variables. The physical meaning of the fuzzy rule  is that if the premise variables (),…,() are with the fuzzy sets ,…,, then the augmented system in () can be represented by interpolating the linearized system in () via the fuzzy basis. The fuzzy dynamics in () are denoted as follows [–]:

in which

where , () is the grade of membership of  () in  or the possibility function of  () in , and μ is the fuzzy basis function for  = 1,2,…,. The denominator  in the above fuzzy basis function is only for normalization so that the total sum of the fuzzy basis is . The physical meaning of () is that the fuzzy stochastic system interpolates L local linear stochastic systems through the nonlinear basis μ() to approximate the nonlinear stochastic system in (). In , Takagi and Sugeno proposed a systematic method to build a T-S fuzzy model for nonlinear function approximation by a system identification tool, i.e., the local system matrices  and  in () can be identified by the least square estimation method. Conversely, many studies have proved that the T-S fuzzy model can approximate a continuous function to any degree of accuracy. However, there is still some fuzzy approximation error in (). In the design, for simplicity, the fuzzy approximation error can be merged into the external noise. After investigating the approximation of the nonlinear stochastic QS-based metal ion biosensor by the fuzzy interpolation method, in order to avoid solving the nonlinear constrained simultaneous optimization problem in () for the multi-objective design problem of a QS-based metal ion biosensor under intrinsic parameter fluctuations and extrinsic molecular noise, the measurement procedure for the matching and filtering abilities of a QS-based metal ion biosensor could also be simplified by the fuzzy approximation method. We then get the following result. Based on the T-S fuzzy model in (), the H/H I/O response matching problem in Proposition 1 becomes how to select promoter-RBS components , , and  from the corresponding component libraries in  to solve the following multi-objective problem:

subject to



for  = 1,2,…,. Based on the optimal selection of these promoter-RBS components, the I/O response of an engineered metal ion biosensor will achieve the optimal matching for the I/O response of the specified reference model and the optimal filtering of parameter fluctuations and environmental disturbances simultaneously. Thus, the multi-objective H/H optimal I/O response design of the QS-based metal ion biosensor obtained by solving the HJI-constrained multi-objective optimization problem in () could be replaced by solving the following LMI-constrained multi-objective optimizations:

where Ω is the feasible set of promoter-RBS libraries in . In this study, the fuzzy approximation method in () or () is only employed to simplify the analysis and design procedure via solving >0 for LMIs in () instead of solving (())>0 for HJIs directly. Further, based on the fuzzy interpolation of local linear systems, i.e., replacing ((),,) and ((),,) by the fuzzy approximations in (), () =  is employed in in Proposition 2 to solve the HJI in Proposition 1. The HJI in Proposition 1 is replaced with a set of LMIs in Proposition 2 and we only need to solve >0 for LMIs to guarantee the output of an engineered QS-based metal ion biosensor that will optimally match the specified reference I/O response in () and optimally filter parameter fluctuations and cellular disturbances simultaneously. In general, it is very difficult to directly solve the LMI-constrained multi-objective optimization in () for a synthetic gene circuit. In this study, a MOEA-based library searching method is proposed to solve the LMI-based multi-objective I/O response-matching problem in () for a metal ion biosensor in sequel. In general, no unique solution exists such that  and  in () are minimized simultaneously. Therefore, more effort is needed for the multi-objective optimization problem in () to seek a set of Pareto optimal solutions, from which the designer can select the preferred option. However, a problem remains with the tradeoff between H and H performance. In light of evolutionary trade-offs, the mechanism of natural selection produces traits best-suited for adapting to environmental change. A similar strategy can be adapted for the multi-objective design problem in (). Inspired by biological evolution, a MOEA is a population-based method to determine Pareto optimal solutions that are non-dominated. Compared with the weighted sum method, MOEA is useful for considering multi-objective design problems, in particular for assessing tradeoffs between design factors. Thus, before discussing the design procedure of the multi-objective I/O response-matching problem in (), some properties regarding the Pareto optimal solutions are given as follows: (Dominance) Consider two solutions (, , ) and (, , ) in Ω for two objective values (, ) and (, ) subject to the LMIs in ()–(), respectively. (, ) is said to dominate (, ), if ≤ and ≤. (Pareto optimal solution) A solution (*, *, *) is the Pareto optimal solution of the multi-objective optimization problem in () with respect to Ω if another feasible solution does not exist (°, °, °) such that objective values (°, °) dominate (*, *). The design procedure for a QS-based metal ion biosensor is then summarized as follows: In addition to the design of a QS-based metal ion biosensor, the proposed method can be applied to the design of synthetic gene regulatory networks with any kind of dynamic behavior. 10.1371/journal.pone.0165911.g001 The metal ion biosensor is assembled by selecting a set of promoter-RBS components from the corresponding component libraries in , namely, a metal ion-induced promoter-RBS component  from the component library in Table A in , a constitutive promoter-RBS component  from the component library in Table B in , and a QS-dependent promoter-RBS component  from the component library in Table C in . A reference model with the desired I/O response to be matched by the metal ion biosensor in () is given as follows: Standard derivations of molecular noise and parameter fluctuations in () to be tolerated  are specified in order to guarantee the robust design of the metal ion biosensor. H design performance between the engineered biosensor output  in () and the desired reference output  is given by: H filtering performance to attenuate the effect of () on matching error is given as follows: Provide user-defined design specifications as a desired reference model in () for the quorum sensing-based metal ion biosensor. Select an initial set  of promoter-RBS components from corresponding libraries, each of which can be satisfied with the LMIs in ()–() with >0. Sort the current set  into different fronts by Pareto dominance ranking and assign a crowding distance to each of them. Create an offspring set  using MOEA operators, such as reproduction, crossover, and mutation. Calculate the objective values of the new set  obtained by natural selection. Stop when the Pareto front is achieved or an acceptable solution is obtained. Otherwise, create the next generation and return to step 3. The design procedure begins by representing the nonlinear stochastic augmented system of a metal ion biosensor and the desired reference model in () by the Takagi-Sugeno (T-S) fuzzy model in () using the interpolation of linear stochastic systems. In particular, at steady state, the desired fluorescence intensity of the metal ion biosensor to different metal ion concentrations is described as follows: According to (), at steady state, our design goal for the steady state in () is () = –(,) and thereby  = –(,). In order to let the steady state  in () match () in (), if we select the followings for the reference model in ()

then  = () at the steady state of the reference model in (). We suppose the quorum sensing-based metal ion biosensor suffers from intrinsic parameter fluctuations, with zero mean and unit variance, as well as the external environmental noises , 
 and  for the transcription and translation processes, and noise  for mature reporter protein expression, are all Gaussian, with zero mean and unit variance. In order to then efficiently achieve the desired I/O response matching design problem of the metal ion biosensor under intrinsic parameter fluctuations and external disturbances, the multi-objective H/H matching design in () is applied to the design problem. Based on the design procedure, a MOEA-based library search method is employed to search a set  from corresponding libraries in  to minimize the objective values in () subject to >0 and the LMIs in ()–(). From the Pareto front in , there are six Pareto solutions. The one with the red cross that makes a compromise between the optimal H solution and H solution is selected for the multi-objective H/ H I/O response of the metal ion biosensor. In this design case, the components from the corresponding libraries are found to be , , and . The desired response is shown in , with the fluorescence intensity values under different Cu(II) ion concentrations. Clearly, at steady state, the metal ion biosensor can match the desired I/O response in (), despite the parameter fluctuations and environmental disturbances. 10.1371/journal.pone.0165911.g002 Pareto front obtained by solving the multi-objective problem in () through the proposed MOEA-based library search method from Tables A–C. 10.1371/journal.pone.0165911.g003 The resulting metal ion biosensor. The adequate set  = (, , ) is selected from the corresponding libraries in . The green points are the experimental results (mean of three trials) by  = (, , ). The gray solid line is the desired I/O response in (). With recent industrial expansion, heavy metal and other pollutants increasingly contaminate our living surroundings [–]. Heavy metals are non-degradable and may accumulate in food chains, where the resulting toxicity can damage organisms [, ]. Therefore, heavy metal detection techniques have gradually begun to receive attention. In order to more easily design a QS-based metal ion biosensor, a multi-objective H/H performance criterion is derived to infer a sufficient condition required for user-oriented specifications using a direct method by minimizing the upper bound of H and H performance simultaneously. Based on the multi-objective design criterion, a metal ion biosensor can then be designed by solving an associated HJI-constrained optimization problem. However, the HJI-constrained optimization problem is difficult to solve directly by any analytical or numerical method because of the complexity of nonlinear dynamics. Therefore, a Takagi-Sugeno (T-S) fuzzy model is employed here to solve the HJI easily and indirectly. The T-S fuzzy model has been widely applied to approximate nonlinear systems by interpolating several local linearized stochastic systems. By using a T-S fuzzy model and choosing an appropriate Lyapunov function, the HJI-constrained multi-objective optimization problem in () for solving the H/H I/O response matching of a nonlinear stochastic metal ion biosensor is reduced to an equivalent LMI-constrained multi-objective optimization problem in (), which can be solved efficiently by an MOEA algorithm with the help of MATLAB’s LMI toolbox. Thus, according to the LMI-constrained criterion, the multi-objective metal ion biosensor design can be constructed by evaluating and selecting adequate promoter-RBS components from corresponding libraries within a feasible range of metal ion concentrations. However, because the multi-objective design problem has no unique solution, a problem remains in dealing with the tradeoff between H and H performance. In light of natural selection on traits best-suited for environmental change being an important mechanism for determining evolutionary trade-offs, a similar strategy seems to be adaptable for the multi-objective design problem. Inspired by biological evolution, the MOEA is a population-based method to determine non-dominated Pareto optimal solutions. Unlike the necessity for complicated computations in conventional design strategies, only simple operators (e.g., selection, crossover, and mutation) and some simple calculations are required for the iterative selection of adequate components. Therefore, MOEAs are useful when considering design problems, in particular for assessing tradeoffs between the design factors under consideration. Consequently, according to the user-specified criteria, this method may offer possible design guidelines for selecting adequate components for a QS-based metal ion biosensor from the corresponding libraries. When the component libraries are more complete, a more precise detection performance of metal ion biosensor can be achieved. In fact, in addition to the QS-based metal ion biosensor, the proposed method can be applied to the design of synthetic gene regulatory networks with any kind of dynamic behavior. In this study, a nonlinear stochastic system is introduced to model a synthetic metal ion biosensor with intrinsic parameter fluctuations and extrinsic molecule noise. A multi-objective H/H I/O response matching performance criterion is derived here for the design specifications of the metal ion biosensor in order to simultaneously achieve the optimal H matching of the desired I/O behavior and the optimal H filtering of parameter fluctuations and cellular noise. An indirect method is proposed to solve the multi-objective H/H I/O response matching design by minimizing their upper bounds simultaneously. Further, based on a fuzzy interpolation technique, the HJI-constrained multi-objective design problem for the metal ion biosensor is transferred to a more simple LMI-constrained multi-objective design problem. According to the LMI-constrained multi-objective design criterion, a metal ion biosensor can be constructed with a desired I/O response by evaluating and selecting adequate components from the corresponding promoter-RBS libraries. The proposed MOEA-based search method provides synthetic biologists with a useful tool for the design of gene circuits, particularly in regards to tradeoffs between the design factors under consideration. The experimental results verify that the design can optimally match the specified reference I/O response and can optimally filter parameter fluctuations and environmental disturbances simultaneously. Click here for additional data file. Click here for additional data file. Click here for additional data file..