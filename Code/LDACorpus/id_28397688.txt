Multistability is a mechanism that cells use to achieve a discrete number of mutually exclusive states in response to environmental inputs, such as the lysis/lysogeny switch of phage lambda (; ) and sporulation/competence in  (; ). In multicellular organisms, multistable switches are also common in the cellular decision-making including the regulation of cell-cycle oscillator during cell mitosis (), Epithelial-to-Mesenchymal transition and cancer metastasis (; ), and the well-known cell differentiation process, which is a manifestation of cellular state determination in a multistable system (; ). However, loss of multistability can drive cells to acquire metastatic characteristics and stabilize highly proliferative, pathogenic cellular states in cancer (). C.H. Waddington hypothesized the ‘epigenetic landscape’ to explain canalization and fate determination mechanism during cell differentiation (). In this hypothesis, differentiation is depicted as a marble rolling down a landscape with multiple bifurcating valleys and eventually settles at one of the local minima, corresponding to terminally differentiated cells. More recent theoretical studies further proposed the local minima to be modeled as steady states or attractors of dynamical systems, which can be mathematically described using differential equations (; ). As such, cell differentiation can be interpreted as a state transition process on a multistable dynamic system. A myriad of theoretical analysis have investigated the functioning of such systems and quantified the Waddington landscape and developmental paths through computation of the probability landscape for the underlying gene regulatory networks (; ; ; ; ; ; ). Recent studies also revealed that the potential landscape and the corresponding curl flux are crucial for determining the robustness and global dynamics of non-equilibrium biological networks (; ; ). Furthermore, the multiple stable steady states have been predicted beyond the bistable switches with or without epigenetic effects, which is reflected in slow timescales (; ; ; ; ; ). Experimental researches, however, mostly focus on bistable switches, involving transitions between only two states. And demonstrations, from a combination of experiments and computational modeling, for the existence and operation of such a landscape in a higher dimensional multistable system are still lacking. Moreover, it remains unknown how gene regulatory networks (GRNs), gene expression noise, and signal induction together shape the attractor landscape and determine a cell’s developmental trajectory to its final fates (; ; ; ; ; ; ; ; ). Conceptual and experimental design of MINPA and its sub-networks. () Abstract diagram of MINPA topology, where X and Y mutually inhibit (T-bars) each other and auto-activate (arrowheads) itself. Four inducers to regulate the four color-coded regulatory edges are also listed. () Molecular implementation of the MINPA network.  (purple arrow) is activated by AraC (yellow) and repressed by LacI (light green), while  (cyan arrow) is activated by LuxR (blue) and repressed by TetR (red). Arabinose and AHL (oval) can induce AraC and LuxR activation, respectively. IPTG and aTc (hexagon) can respectively relieve LacI and TetR inhibition. GFP and mCherry serve as the readout of  and , respectively. Therefore, TetR and AraC collectively form the node X in (), color-coded as purple rectangle. Similarly, LuxR and LacI collectively form the node Y in (), color-coded as cyan rectangle. Genes, promoters and regulations are color-coded corresponding to the topology in (). () List of MINPA and its 14 sub-networks. Numbering of indices is converted from topologies’ binary name (see  for more details). T represents ‘topology’. R represents ‘repression’, and A represents ‘autoactivation’. Superscript is used to describe the number of such types of edges. Topologies with shaded background were later constructed and analyzed experimentally. () Dynamic responses for  () and  () through induction with Arabinose (Ara) and IPTG, and AHL and aTc, respectively. Presented data was the mean value of three replicates. mCherry and GFP serves as the readout of the two promoters. http://dx.doi.org/10.7554/eLife.23702.003 Experimental design, topological hierarchy and multistability probability analysis of MINPA sub-networks. () Abstract diagrams and molecular implementation of the eight MINPA sub-network topologies, including tunable positive feedbacks (), mutual inhibition (), dual-positive feedbacks (), and their combinations (T7, T11, T13, and T14). Genes, promoters, and regulations are color-coded corresponding to the topology on the left side. () Biological devices for testing promoter  () and  (), respectively. Fluorescence was measured by flow cytometry at 12 hr and 24 hr (not shown) after adding the inducers. All the data points were averaged from three repeated experiments. Grey arrows represent constitutive promoters (BBa_K176009). () Principle components and optimal Hill functions fitted for hybrid promoter  and . () List of MINPA and its 14 sub-networks, which are named, and color-coded, as binary numbers based on the existence of regulatory edges. () Topological hierarchy of the 15 motifs. () Probability of multistability (tristability and quadrastability) for the nine experimentally constructed networks. SSS: stable steady states. The range for activation/repression strength is [0.3, 0.8], and the probability was calculated from the number of parameter sets giving rise to multistability over 2000-repeated computational simulations. () Histograms for parameter combination that have multistability in sub-networks of T10, T13, T14 and T15 (MINPA). For each sub-network, the network activation and inhibition strength Sa, Su, St and Sl are randomly selected from given ranges and the number of corresponding SSS is recorded. We repeat this procedure for all sub-networks for 2000 times and calculate the probabilities of bistability (blue lines), tristability (black lines) and quadrastability (red lines). () Scatter plots for all parameter combinations that have multistability in MINPA. We generate parameters using the same approach as () and select the parameter combinations that can generate three or four SSS in MINPA. http://dx.doi.org/10.7554/eLife.23702.004 Complex contextual connections of GRNs have impeded experimentally establishing the shape and function of the cell fate landscape. Rationally designed and tunable synthetic multistable gene networks in , however, could form well-characterized attractor landscapes to enable close experimental investigations of general principles of GRN regulated cellular state transitions. Since the functioning of these principles only requires the most fundamental aspects of gene expression regulation, they would also be applicable for cell differentiation regulations in mammalian cells. Here, we combine mathematical theory, numerical simulations, and synthetic biology to probe all possible sub-networks of mutually inhibitory network with positive autoregulations (MINPA, ), which has been hypothesized to have multistability potentials (; ). Moreover, MINPA and its sub-networks are recurring motifs enriched in GRNs regulating hematopoietic development (Gata1-Pu.1, ), trophectoderm differentiation (Oct3/4-Cdx2, ), endoderm formation (Gata6-Nanog, [; ]), and bone, cartilage, and fat differentiation (RUNX2-SOX9-PPAR-γ, [; ]). MINPA circuit construction and multistability analysis Figure 1—figure supplement 1B–D Engineered circuits of MINPA () and its sub-networks () are designed to use two hybrid promoters,  and  which are characterized experimentally to show small leakage and high nonlinearity ( and ). For MINPA topology, hybrid promoter  drives  and  expression, representing the node X in , whereas  controls  and  transcription, representing the node Y. AraC and LuxR activate  and  in the presence of Arabinose and AHL (3oxo-C6-HSL) respectively, forming positive autoregulations. IPTG inhibits the repressive effect of LacI on TetR expression, while aTc counteracts TetR repression on LacI. Hence, the two nodes form the topology presented in the conceptual design shown in . Green fluorescent protein (GFP) and mCherry serve as the corresponding readouts of  and  activities in living cells (). Figure 1—figure supplement 1E–F Figure 1—figure supplement 1H–I Topologies of MINPA and all its subnetworks can be divided into four layers, from one- to four-dimensional networks based on the number of regulatory edges ( and ) and further categorized into nine groups based on the configurations of activation and inhibition. By computationally searching a large parameter range for each of the nontrivial networks (), we found that networks with two auto-activations, including A, RA, RA, have high probability of tristability or quadrastability (), defined as having three or four stable steady sates (SSS) under a common induction condition. However, MINPA has broader parameter distributions than the other two (), which suggests it is more resistant to parameter change and thus likely to achieve multistability in experimental settings. Systematical multistability evaluation of MINPA and its sub-networks In order to experimentally evaluate dynamic properties of these networks, we constructed nine circuits including tunable positive feedbacks (T6 and T9), mutual inhibition (T5), dual-positive feedbacks (T10), and their combinations (T7, T11, T13, T14 and T15). One-dimensional networks (T1, T4, T2 and T8) and trivial two-dimensional networks (T3 and T12) are excluded for their low multistability probability. All motifs were constructed using the same set of components (). Sequential induction of MINPA and its sub-networks. () Schematic illustration of rationale for sequential induction. This two-parameter bifurcation diagram of a bistable toggle-switch depicts all steady state values of response (Z-axis) with combinations of inducer I and II (X and Y axes). Arrows illustrate order and direction of inductions and consequent steady state value changes. Solid lines on the X-Y plane are the boundaries of bistability. Dashed lines on the X-Y plane are projections of solid white arrowheads. () Arabinose (Ara) and IPTG were sequentially (left and middle columns) or simultaneously (right column) applied to induce T9, T13, T11, and T15. T: topology. The concentration of Arabinose and IPTG is 2.5*10m/v, and 5*10 M, respectively. To indicate the effects of inducers, we used the same color for applied inducers and its regulated connections, which were also shown in bold lines. The other non-regulated connections are represented by thin lines. () AHL and aTc were sequentially (left and middle) or simultaneously (right) applied to induce T6, T7, T14, and T15. The concentration of AHL and aTc is 1*10 M, and 200 ng/ml, respectively. () Ara and AHL were sequentially (left and middle) or simultaneously (right) applied to induce T10, T14, T11, and T15. The concentration of Arabinose and AHL is 2.5*10m/v, and 1*10 M, respectively. Samples were treated with the first inducer till OD is about 0.15 and then the second inducer was added. Cells were grown for another 24 hr before measured by flow cytometry. The experiments were performed in triplicate and repeated two times, and representative results are presented. The inducers are color-coded as visual assistance to indicate which edge of inset diagram it regulates. http://dx.doi.org/10.7554/eLife.23702.005 Experimental design and validation of sequential induction strategy in a synthetic toggle switch circuit. () Abstract diagram and molecular implementation of the toggle switch circuit. TetR () and LacI () mutually inhibit each other through binding to  and  promoter, respectively. IPTG and aTc (hexagon) can respectively relieve LacI and TetR inhibition. GFP serves as the readout of . () Time course results of the sequential induction. The y-axis represents forward scatter (FSC-A), and the x-axis indicates GFP fluorescence. IPTG and aTc were sequentially (left and middle columns) or simultaneously (right column) applied to induce the toggle circuit. The first inducer was added to the media for 5 hr, and then the second inducer was added. Fluorescence was measured by flow cytometry at 0 hr, 5 hr, 12 hr, and 24 hr after the second inducer was added into the cultures. The concentration of IPTG and aTc is 8*10 M, and 100 ng/ml, respectively. Experiments were repeated for at least three times, and representative results were shown. http://dx.doi.org/10.7554/eLife.23702.006 Time course results of sequential induction for the MINPA () circuit. () Arabinose (Ara) and IPTG were sequentially (left and middle columns) or simultaneously (right column) applied to induce T15. The first inducer was applied for 5 hr, and then the second inducer was added into the culture. Fluorescence was measured by flow cytometry at 0 hr, 12 hr, and 24 hr after the second inducer was added into the culture. The concentration of Ara and IPTG is 2.5*10m/v, and 5*10 M, respectively. () AHL and aTc were sequentially (left and middle) or simultaneously (right) applied to induce T15. The first inducer was applied for 6.5 hr, and then the second inducer was added into the culture. The concentration of AHL and aTc is 1*10 M, and 200 ng/ml, respectively. () Ara and AHL were sequentially (left and middle) or simultaneously (right) applied to induce T15. The first inducer was applied for 5 hr, and then the second inducer was added into the culture. The concentration of Arabinose and AHL is 2.5*10m/v, and 1*10 M, respectively. () IPTG and aTc were sequentially (left and middle) or simultaneously (right) applied to induce T15. The first inducer was applied for 6.5 hr, and then the second inducer was added into the culture. The concentration of IPTG and aTc is 1*10 M, and 200 ng/ml, respectively. Fluorescence was measured by flow cytometry at 0 hr, 12 hr, and 24 hr after the second inducer was added into the culture. The inducers are color-coded as visual assistance to indicate which edge of inset diagram it regulates. http://dx.doi.org/10.7554/eLife.23702.007 Sequential induction for circuits T5, T7, T13, and T15 with inducers IPTG and aTc. Left: IPTG was first applied to induce the circuits, and then aTc was added; Middle: aTc was first applied to induce the circuits, and then IPTG was added; Right: IPTG and aTc were added simultaneously into the medium. The concentration of IPTG and aTc is 1*10 M and 200 ng/ml, respectively. Samples were treated with the first inducer for 6.5 hr and then the second inducer was added. Fluorescence was measured at 24 hr by flow cytometry. http://dx.doi.org/10.7554/eLife.23702.008 Probing a circuit’s multistability typically requires thorough hysteresis experiments covering wide ranges of doses for all inducers (; ; ), which becomes infeasible for nine complex networks with four inducers. To improve the efficiency of probing multistability and tunability, we designed a ‘sequential induction’ method to accelerate exploration of unknown high dimensional bifurcation spaces (see Appendix text for details), instead of conventional ‘back and forth’ hysteresis on one parameter dimension. The main concept relies on the fact that multistable gene networks could exhibit discontinuous jump from one state to another in response to changing parameter (inducer) combinations. Taking the classic ‘toggle switch’ as an example (), the circuit can be tuned by two external inducers and its two-parameter bifurcation diagram has a stretched  shape (). Initialized at an arbitrary state A, the cells could reach State C in the bistable region directly when induced with both inducers simultaneously. If the cells are first induced by Inducer I to go to state B, they will also reach State C after Inducer II is added. However, if the same dose of Inducer II is applied first, cells will cross the bifurcation plane to state D on the low-Response surface and then reach state E with addition of Inducer I (). State C and E are two different steady states with the same induction dosages, illustrating hysteresis and verifying multistability. To test our theoretical analysis, a synthetic toggle switch circuit was constructed (). Following experimental design principles (see Appendix text for details), we designed a protocol to show the sequential induction effects. We first employed IPTG to induce the circuit for 5 hr, and then aTc was added. Time course results showed that cells stayed at low-GFP state till 24 hr (). However, cells induced with aTc first, and then IPTG mainly stayed at high-GFP state, another stable steady state under this condition. Simultaneous aTc and IPTG induction produced similar cell distributions. These results show that sequential induction can be used as a strategy to quickly explore a multistable potential landscape for complex non-equilibrium systems. Without knowing the exact bifurcation range beforehand, such ordered sequential inductions could help quickly explore the irregular bifurcation space to reveal multistability for systems with complicated bifurcations, which is typically caused by interfering parameters. Similar sequential induction techniques have been shown to enable access of otherwise hard-to-reach cell death states in breast cancer cells (). This strategy has also been widely employed in directed differentiation of stem cells to specific lineages (; ; ) and reprogramming somatic cells to induced pluripotent stem cells (). Although specific inducer concentrations are required to observe the effects of this strategy in synthetic circuits, sequential induction with pre-selected inducer combinations can help perform a coarse-grained exploration from different directions in the parameter space. Furthermore, stochastic gene expression of the circuits also contributes to cellular population distribution thus leads to pronounced sequential induction effects, given experimentally feasible amount of time, when the system is entering its multistable region from different directions. Therefore, distinct final states, or even different population distributions, under sequential induction strongly suggests the existence of nonlinear dynamics, including multistability (see Appendix text for details). Using the sequential induction approach, we tested the nine circuits using flow cytometry. Cells were first induced by inducer I, inducer II was then added into the media for another 24 hr. Depending on the network configuration, four different dual-inducer combinations were used. For example, Arabinose and IPTG were applied sequentially and simultaneously to T9, T13, T11 and T15, respectively (). It can be seen only T15 exhibits significant expression difference between three induction patterns, while the others show little change ( and ). It should be noted that T15 also exhibits tri-modality of fluorescence expression, suggesting multistability given the presence of gene expression noise, which is partially consistent with our computational predictions. Similarly, AHL and aTc were applied to T6, T7, T14, and T15, respectively ( and ). Results show that only T15 exhibits significant fluorescence pattern change with different inductions, whereas T6 and T7 exhibit minor uniform shifts of expression. T14, although exhibiting bimodality, only shows a ratio change of two populations between three inductions and no sign of bifurcation. Sequential induction by Arabinose and AHL combinations has little effect on T10, T14 and T11, but T15 displays three notable populations for AHL-then-Arabinose induction ( and ). IPTG and aTc were also tested on T5, T7, T13 and T15, but no notable dynamics were observed ( and ). Taken together, T15, the full MINPA topology, shows the most variety and complexity in population heterogeneity under sequential inductions, suggesting this circuit has the highest potential to generate complex multistability within our induction range and hence enable us to approach the Waddington landscape. Bifurcation and hysteresis verification of multistability Bifurcation analysis and hysteresis of MINPA. () Engineered MINPA is tunable to reach four individual states: low-low, GFP, mCherry, and high-high, under no induction, 1*10 M AHL and 100 ng/ml aTc, 2.5*10 (m/v) Arabinose, 1*10 M AHL and 2.5*10 (m/v) Arabinose, and respectively. To indicate the effects of inducers, we used the same color for applied inducer and its regulated connection (bolder lines) in the MINPA topology. The other non-regulated connections are represented by thin lines. () 3-D bifurcation diagram of MINPA.  is a lumped parameter composed of increasing concentrations of Arabinose and AHL, but the ratio of Arabinose and AHL is fixed, i.e., [Arabinose]/[AHL] is a constant. GFP and mCherry represent the states of node X and Y. Blue lines represent stable steady states, while red ones are unstable steady states. Grey, green, rose, and golden spheres represent low-low, GFP, mCherry, and high-high state, respectively. And the size of spheres correlates with the attractiveness of each state. C1, C2, C3, and C4 are four increasing concentrations of Arabinose and AHL used for experimental probing. () Hysteresis results of MINPA under induction of . C1-C4: cells with low-low initial state () are induced with  at C1 to C4; C1-C4: cells with high-high initial state () are induced with  for 24 hr at C1 to C4. C1: no inducers; C2: 2.5*10m/v Arabinose and 1*10 M AHL; C3: 2.5*10m/v Arabinose and 1*10 M AHL; C4: 2.5*10m/v Arabinose and 1*10 M AHL. Arabinose and AHL were added at the same time to induce the cells. 100,000 cells were recorded for each sample by flow cytometry. http://dx.doi.org/10.7554/eLife.23702.009 Another view of the 3-D bifurcation diagram of MINPA at C2. The circuit’s quadrastability is illustrated as four similar-sized colored spheres on the same gray plane, which represents the low-low, GFP, mCherry, and high-high state, respectively. Blue lines represent stable steady states, while red ones are unstable steady states. Grey, green, rose, and golden spheres represent low-low, GFP, mCherry, and high-high state, respectively. And the size of spheres correlates with the attractiveness of each state. C2: 2.5*10m/v Arabinose and 1*10 M AHL. http://dx.doi.org/10.7554/eLife.23702.010 Bifurcation analysis for and hysteresis of MINPA with induction of Arabinose and AHL. () One-dimensional bifurcation analysis for all four inducers in MINPA. We perform bifurcation analysis for each inducer while setting the concentration of other inducers to be very small (10). The blue curves are branches of stable steady states (SSS), while the red curves are branches of unstable steady states (USS). The bifurcation analyses are performed using Matlab. () Dual induction bifurcation analysis for Arabinose and AHL in MINPA. We perform bifurcation analysis for dual induction of different β (see Appendix for details). The blue curves are branches of SSS, while the red curves are branches of unstable steady states. () Hysteresis of MINPA for initial low-low state cells with induction of Arabinose and AHL. Cells with initial low-low state were induced with a series of concentrations of Arabinose (from 2.5*10m/v to 2.5*10m/v to 2.5*10m/v) and AHL (from 1*10 M to 1*10 M to 1*10 M). Data circled by red rectangles are shown in . Cells were grown for 24 hr before measured by flow cytometry. 10,000 events were recorded. () Hysteresis of MINPA for initial high-high state cells with induction of Arabinose and AHL. Initial high-high state cells were collected from the initial low-low state cells induced with 2.5*10m/v Arabinose and 1*10 M AHL for 12 hr. Cellular states were then monitored by flow cytometry to ensure its high-high state profile. The high-high state cells were washed and then inoculated into fresh medium with the same concentrations of Arabinose and AHL (from 2.5*10m/v to 2.5*10m/v to 2.5*10m/v) and AHL (from 1*10 M to 1*10 M to 1*10 M). Data circled by red rectangles are shown in . Cells were grown for 24 hr before measured by flow cytometry. 10,000 events were recorded. http://dx.doi.org/10.7554/eLife.23702.011 Next, operating principles and full tunability of T15 (MINPA) were further examined by using four inducers (Arabinose, AHL, aTc, and IPTG) to fine tune the strength of regulations and perturb the system (). Uninduced cells showed low GFP and low mCherry expression (low-low state, LL). In the presence of AHL and aTc, high GFP and low mCherry (GFP state) is observed; low GFP and high mCherry (mCherry state) emerged with induction of Arabinose; and high GFP and high mCherry (high-high state, HH) was achieved when induced with Arabinose and AHL. These results verify that our engineered MINPA circuit is functioning as designed and fully controllable with four distinct states reachable through appropriate inductions, respectively. Figure 3—figure supplement 2A–H To help design experiments to further investigate the circuit’s quadrastability, a detailed mathematical model was developed to describe the system (see Appendix for details). Using parameters derived from hybrid promoter testing experiments, bifurcation analysis was carried out to systematically quantify MINPA’s dynamic behavior (,  and ).  is the three-dimensional bifurcation diagram, where levels of GFP and mCherry represent the states of node X and Y, and ‘’ is a lumped parameter composed of a fixed ratio of the concentrations of Arabinose and AHL. Overall, it can be seen that the system, initialized without induction, is predicted to be quadrastable (shown as four colored spheres, representing LL (grey), GFP (green), mCherry (rose), and HH (golden) state, respectively) but with the low-low state to have dominant attractiveness (shown as the big gray sphere) when  is low (C1). However, when  level is within an intermediate range, relative stabilities between different states become comparable. When  level increased from C1 to C2, the circuit’s quadrastability becomes well pronounced, illustrated as four similar-sized colored spheres on the same gray plane, which represents the low-low, GFP, mCherry, and high-high state, respectively (). As  continues to increase from C2 to C3, while the other three SSS remain stable, the stability of the GFP branch disappears. Further increase of  results in only one stable state-the high-high state, shown as the orange sphere with biggest size. To establish MINPA’s quadrastability and tristability as predicted, hysteresis, a hallmark of multistability (; , ), of the network was tested. Initialized at the low-low state, cells were induced by increasing doses of  corresponding to C1 to C4 and measured by flow cytometry ( and ). As predicted, C1 (cells with initial Low-Low state grown at C1 condition) experiment demonstrates uniform low-low fluorescence profile, due to the low-low state’s dominant attractiveness, and C4 shows a uniform high-high profile. Interestingly, C3 indeed illustrates tri-modality, which is the result of predicted tristability. C2 experiment, on the other hand, exhibits enough heterogeneity to signal high-high, low-low, and mCherry state, but does not illustrate significant trace of GFP state. Given that GFP state is achieved through combinational induction of AHL and aTc (), we hypothesize that the GFP state here is not easily accessible with AHL induction only. Next, cells initialized at high-high states were collected and diluted into fresh media with the same concentrations of  ( and ). As predicted, these cells keep high-high expression profile even with inductions as low as C1, another demonstration that the system is already multistable at C1. Taken together, the two sets of experiments demonstrated clear hysteresis and verified the existence of three of the four predicted SSS. Experimental demonstration of model-guided quadrastability of MINPA Model-guided quadrastability of MINPA through triple induction. () Dynamic evolution of computed energy landscapes of MINPA under sequential/simultaneous inductions of Arabinose, and/or AHL and aTc. Center route: simultaneous induction with three inducers; Left route: sequential induction with AHL and aTc first, and then Arabinose. Right route: sequential induction with Arabinose, and then AHL and aTc. Deeper wells represent the higher stability of corresponding states. For each three-dimensional landscape, corresponding two-dimensional state-potential plots were also shown. Red line sketches the potentials from mCherry state to high-high to GFP state while green one represents the potentials from mCherry state to low-low to GFP states. mC: mCherry; HH: high-high; LL: low-low. GFP* and mCherry* is the computed GFP and mCherry abundance from the model. To indicate the effects of inducers, we used the same color for applied inducers and its regulated connections, which were also shown in bolder lines. () Experimental validations of model-predicted quadrastability using flow cytometry. Quadrastable steady states were observed when Arabinose, AHL, and aTc were simultaneously added into the media (), corresponding to the Center route in A). Four populations were also observed when AHL and aTc were first added to growth media for 6.5 hr and then Arabinose was added, and cells were grown for another 24 hr before measurement (), corresponding to the Left route in ). Bimodality (low-low and mCherry states) was generated when Arabinose was first applied and then AHL and aTc were added (), corresponding to the Right route in ). Concentrations for Arabinose, AHL and aTc are 2.5*10m/v, 1*10 M, and 400 ng/ml, respectively. Representative results from three replicates are showed and 100,000 cells were recorded for each sample by flow cytometry. http://dx.doi.org/10.7554/eLife.23702.012 Cells’ states under induction with the first inducer, microfludic results to demonstrate quadrastability with IPTG and aTc induction, and time course of sequential induction of AHL, aTc and Ara. () Up left: Flow cytometry result for cells simultaneously induced with 2.5*10m/v Arabinose, 1*10 M AHL and 200 ng/ml aTc for 6.5 hr. Up right: Cells were first induced with 1*10 M and 400 ng/ml aTc for 6.5 hr, and then measured by flow cytometry. About 12% cells were moving from low-low state to GFP state at 6.5 hr. Bottom left: Cells were first induced with 2.5*10m/v Arabinose and no obvious state transition was observed at 6.5 hr. However, at 9.5 hr, most cells (84.6%) were transitioned to mCherry state (Bottom right). () Microfluidic setup and device design (adopted from Dr. Hasty lab (). () Images showing E.coli growing in the device. White arrows indicate the flow direction. () Time course of the cells growing and fluorescence state change with 2*10 M IPTG and 200 ng/ml aTc induction in the trap. The red flow is medium without inducer for 6 hr, and then cells switch to medium with inducers for 18 hr. Small white arrows show single cells with state change from GFP to mCherry. Magnification: 40x. () Time-course sequential induction with AHL, aTc first and then Arabinose (corresponding to the Left route in ). The indicated time point is the time after Arabinose added into the culture. 10,000 events were recorded. The low-low state cells changed from 21.2% (12 h) to 24.6% (24 h) to 30.6% (36 h). http://dx.doi.org/10.7554/eLife.23702.013 To further investigate what determines the accessibility of certain SSS in this quadrastable system and how cells navigate this attractor landscape, we take into account gene expression stochasticity () to sketch out MINPA’s quasi-potential attractor landscape ( and Appendix), which is calculated as the negative logarithmic function of stationary distribution density in the phase space of GFP and mCherry. Using the weighted ensemble random walk algorithm (Appendix), the stationary density distribution can be efficiently calculated from the initial uniform distribution. It can be seen that when there is no inducer, MINPA is already quadrastable with four local minima, which is consistent with bifurcation analysis for C1 condition. Furthermore, the much stronger stability of the low-low state (deepest well, Top landscape) and high state-transition barrier explain homogeneous low-low population (C1 experiment in ) when cells were initialized with no inductions. Figure 4—figure supplement 1B–D Since Arabinose and AHL combination is not sufficient to enable the cells to reach all four SSS, we chose to add aTc to the mix to further facilitate cell transitions among these four SSS. Using our expanded model, we simulated simultaneous and sequential inductions and computed corresponding quasi-potential landscape (), showing cells harboring the same MINPA network exhibiting distinct landscapes under different inductions. AHL and aTc promote a more stable GFP state (Left center), while Arabinose induction modulates the landscape to be biased toward mCherry state (Right center). When the three inducers were applied simultaneously, the landscape changes and the four states show comparable stabilities (Bottom), suggesting a higher possibility of quadramodal cell population experimentally. Experimental validation is shown as flow cytometry measurements of cells treated with Arabinose, AHL, and aTc simultaneously for 24 hr (, and ). Such a hybrid induction greatly facilitates the cells’ transition from low-low state to the other three states so that a quadramodal distribution emerges. Single-cell time lapse microscopy results also showed that the initial low-low state cells could differentiate into GFP, mCherry and high-high state cells ( and ). This also finally verifies predicted quadrastability of MINPA. Figure 4—figure supplement 1A and E There are two other strategies to reach this condition: sequential inductions with AHL-and-aTc and then Arabinose (, Left route) or Arabinose and then AHL-and-aTc (Right route). Even though the initial and final landscapes are the same, the dynamics for each route are quite different, which could lead to distinct outcomes. By comparing state barrier heights (), we hypothesize that cells walking through the left route would start transitioning from low-low state to GFP state upon induction of AHL and aTc. Following Arabinose induction would then make the mCherry state accessible. So some cells with GFP state would transition to high-high state while some low-low state cells transition to mCherry state, resulting in cells in all four states. Experimental testing indeed shows four stable populations (). At 6.5 hrs of AHL and aTc induction, about 12% cells were moving to GFP state while the rest of them still stay ‘undecided’ at low-low state (). This is consistent with the simulated landscape as these two states are more stable and accessible to each other (, Left). Arabinose induction promoted some cells to transition into mCherry state while some cells continued moving into GFP state, of which some further transitioned to high-high state. Interestingly, the right route is predicted to generate different results. When first induced with Arabinose, the mCherry valley is so deep that it would be difficult for cells to jump out to high-high state, and low-low state cells are also hardly transit to GFP state due to its low attractiveness, and thus most cells would stay at mCherry and low-low state even with AHL and aTc inductions (, Right). Experimental testing of the right route indeed only produces two populations with low-low and mCherry state (). With 5 hrs of Arabinose induction, most cells still stay at low-low state because of slow transition to the mCherry state (), but 84.6% cells transitioned to mCherry state with 15.3% cells at low-low state at 9.5 hr (). This is consistent with our model predictions. The high barrier between the mCherry state and high-high state blocks the transition from mCherry state to high-high state, while the low attractiveness and relatively high barrier of the GFP state also decreases the probability of cells transitioning from low-low to GFP state. Hence, when AHL and aTc are applied, cells are predominantly in the mCherry state with a small portion in low-low state with low probability of transitioning out, resulting in a bimodal distribution. Multistability and the resulting landscape has long been proposed as an underlying mechanism that cells use to maintain pluripotency and guide differentiation (; ; ; ; ; ; ). Theoretical frameworks have also been established to quantify the Waddington landscape and biological paths for cell development (, ; ). Experimental validation of this hypothesis and a full understanding of this mechanism will help reveal differentiation dynamics and routes for all cell types, which remains an outstanding problem in biology. In this study, we engineered the quadrastable MINPA circuit and show that it can guide cell fate choices, represented by fluorescence expression, through shaping the potential landscape. MINPA represents one of the most complicated two-node network topologies and includes four genes to implement a web of regulations. Biological complexity correlates with the number of regulatory connections (), not the number of genes. Hence, dense connectivity and complex dynamics of MINPA may provide a framework to understand similarly densely connected gene regulatory networks. Combining mathematical modeling and experimental investigation, this study serves as a proof-of-principle demonstration of the Waddington landscape. Furthermore, we used this circuit to demonstrate how different sequential inductions can change the landscape in a specific order and navigate cells to different final states. Such illustrations suggest mechanistic explanations of the need for fixed induction sequences for targeted differentiation to desired cell lineage. Overall, this study helps reveal fundamental mechanisms of cell-fate determination and provide a theoretical foundation for systematic understanding of the cell differentiation process, which will lead to development of new strategies to program cell fate. All the molecular cloning experiments were performed in  DH10B (Invitrogen, USA), and measurements of MINPA and sub-networks were conducted in  K-12 MG1655ΔΔ strain as previously described (from Dr. Collins Lab ). The sequential induction for the toggle circuit was conducted in  MG1655Δ strain as previously described (). Cells were grown at 37°C in liquid and/or solid Luria-Bertani broth medium with 100 µg/mL ampicillin or kanamycin. Chemicals AHL (3oxo-C6-HSL, Sigma-Aldrich), Arabinose (Sigma-Aldrich, USA), isopropyl β-D-1-thiogalactopyranoside (IPTG, Sigma-Aldrich), and anhydrotetracycline (aTc, Sigma-Aldrich) were dissolved in ddH2O and diluted into indicated working concentrations. Chemical aTc solution was stocked in brown vials, and experiments involving aTc were performed in cabinet without light, and cell cultures were grown in darken incubator at 37°C. Cultures were shaken in 5 mL and/or 15 mL tubes at 220 rotations per minute (r.p.m). CGGAATTCGCTTCTAGAGAATTGTGAGCGGATAAC CGCTGCAGGCACTAGTTTGTGTGAAATTGTTATCCG Components from the Registry of standard biological parts http://dx.doi.org/10.7554/eLife.23702.014 AraC arabinose operon regulatory protein from Tetracycline repressor from transposon Tn10 Hybrid promoter with LuxR/HSL- and TetR-binding sites Transcriptional terminator (double) High copy BioBrick assembly plasmid with kanamycin resistance High copy BioBrick assembly plasmid with ampicillin resistance All the plasmids (MINPA and its nine sub-networks) in this study were constructed using standard molecular cloning protocols and assembled by standardized BioBricks methods based on primary modules () from the iGEM Registry (). Hybrid promoter  was from Dr. Collins lab and amplified using forward primer: ; and reverse primer: . PCR product was purified using GenElute PCR Clean-Up Kit (Sigma-Aldrich), and then cut by restriction enzymes  and . The purified product was inserted into pSB1K3 backbone, and finally verified by DNA sequencing. The MINPA circuit was constructed from promoter  and nine other Biobrick standard biological parts: BBa_B0034 (ribosome binding site, RBS), BBa_C0080 ( gene), BBa_C0040 ( gene), BBa_K176000 ( hybrid promoter), BBa_C0062 ( gene), BBa_C0012 ( gene), BBa_B0015 (transcriptional terminator), BBa_E0240 (GFP generator), and BBa_J06702 (mCherry generator). The fragment and vector were separated by gel electrophoresis (1% TAE agarose) and purified using GenElute Gel Extraction Kit (Sigma-Aldrich). Then, fragment and vector were ligated together using T4 DNA ligase, and the ligation products were transformed into  DH10B and clones were screened by plating on 100 μg/ml ampicillin LB agar plates. Finally, their plasmids were extracted and verified by double digestion ( and ). The detailed procedures of assembling DNA constructs were described in our previous study (). Restriction enzymes (, , , and ) and T4 DNA ligase were purchased from New England Biolabs. All the constructs were inserted into high copy number plasmid pSB1A3 and pSB1K3. All the constructs were verified by DNA sequencing (Biodesign sequencing lab in ASU) step by step. All the samples were analyzed at the indicated time points on an Accuri C6 flow cytometer (Becton Dickinson, USA) with excitation/emission filters (488/530 nm for GFP, and 610 LP for mCherry). The data were collected in a linear scale and non-cellular low-scatter noise was removed by thresholding. All measurements of gene expression were obtained from at least three independent experiments. For each culture, 100,000 events were collected at a slow flow rate. Data files were analyzed using MATLAB (MathWorks). Sequential induction and hysteresis For sequential induction, initially uninduced overnight cell culture was diluted into fresh media without or with inducer I, grown at 37°C and 220 r.p.m till OD is 0.15 ~ 0.25 (the time usually takes 5 ~ 6.5 hr, depends on the inducers and concentrations). For samples induced individually by Ara, or AHL, or IPTG, it is ~5 hr; for samples induced with aTc, it takes ~6.5 hr. According to our experience, gene (GFP) is starting to be partially expressed while steady states are not yet stable. Then inducer II was added into the culture, and grown for another 24 hr. Flow cytometry was performed at 0 hr, 12 hr, and 24 hr after the second inducer was added into the culture. For each set of sequential induction, the first scenario: add inducer I first, then add inducer II; the second scenario: add inducer II first, then add inducer I; the third scenario: add inducers I and II at the same time. As a control, cells without any inducer were also prepared and measured. Inducer I and II were the two of four commercial chemicals: AHL, Arabinose, IPTG, and aTc. All the experiments were repeated for at least three times and only representative results were showed. For hysteresis experiments, initially uninduced cells were diluted into fresh media and distributed into new 5 ml tubes. Various amounts of Arabinose and AHL (3oxo-C6-HSL) were added into the media, and cells were then grown at 37°C shaker. The initially high-high state cells induced with 2.5 *10 m/v Arabinose and 1*10 M AHL were collected with low-speed centrifugation, washed twice, resuspended with fresh medium, and at last inoculated into fresh medium at a 1:100 ratio with the same series of inducer (Arabinose and AHL) concentrations. C1, C2, C3, and C4 () are four increasing concentrations of Arabinose and AHL used for experimental probing, but the ratio of Arabinose and AHL is fixed. Specifically, cells were induced with the Arabinose and AHL at the same time (the third scenario), at concentrations from C1 to C4. C1: no inducers; C2: 2.5*10m/v Arabinose and 1*10 M AHL; C3: 2.5*10m/v Arabinose and 1*10 M AHL; C4: 2.5*10m/v Arabinose and 1*10 M AHL. Flow cytometry analyses were performed at 12 hr and 24 hr to monitor the fluorescence levels. Experiments were repeated two times with three replicates. Cells with MINPA circuit were grown overnight, which was then re-diluted into 5 mL fresh LB medium with Kanamycin the next day. When OD of the cells reached about 0.2, cells were spun down with low speed and resuspended in 5 ml of fresh medium and loaded into the device. Detailed description of chip design and device setup could be found from Hasty Lab (). Two media were prepared: one with inducers and the other without. Cells in the trap were first supplied by the medium without inducer for 6 hr, and then switched to medium with inducers for anther 18 hr, which was controlled by adjusting the heights of the medium syringes relative to one another. Images were taken by using Nikon Eclipse Ti inverted microscope (Nikon, Japan) equipped with an LED-based Lumencor SOLA SE. Phase and fluorescence images were taken every 5 min for 24 hr in total under the magnification 40x. Perfect focus was maintained automatically using Nikon Elements software. Experimental detail can also be found in Appendix. Ordinary differential equation models were developed to describe and analyze the MINPA system. Details are provided in the Appendix..